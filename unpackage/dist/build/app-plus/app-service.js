if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e,t){"use strict";const n=(e,t)=>{const n=e.__vccOpts||e;for(const[r,a]of t)n[r]=a;return n};const r=n({name:"homeHead",data:()=>({})},[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("div",{class:"phone-container"},[e.createElementVNode("div",{class:"header"},[e.createElementVNode("div",{class:"avatar"}),e.createElementVNode("div",{class:"user-name"}," 张三 ")])])])}],["__scopeId","data-v-403698ae"]]);function a(e,t,...n){uni.__log__?uni.__log__(e,t,...n):console[e].apply(console,[...n,t])}function s(e,n){return t.isString(e)?n:e}const i=n({name:"homeFoot",data:()=>({}),methods:{TestPage(){uni.navigateTo({url:"/pages/test/test"})}}},[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("footer",{class:"footer-container"},[e.createElementVNode("div",{class:"footer-parter"},[e.createElementVNode("img",{src:"https://img-insight.oss-cn-chengdu.aliyuncs.com/home-icon.png",class:"icon-footer",id:"icon home-icon"}),e.createElementVNode("div",{class:"footer-words",style:{color:"#08DF86"}}," 首页 ")]),e.createElementVNode("div",{class:"footer-parter-center"},[e.createElementVNode("img",{src:"https://img-insight.oss-cn-chengdu.aliyuncs.com/segment.png",class:"icon-footer-center",onClick:n[0]||(n[0]=e=>i.TestPage())}),e.createElementVNode("div",{class:"footer-words-center"}," 测试音频 ")]),e.createElementVNode("div",{class:"footer-parter"},[e.createElementVNode("img",{src:"https://img-insight.oss-cn-chengdu.aliyuncs.com/user.png",class:"icon-footer",id:"icon user-icon"}),e.createElementVNode("div",{class:"footer-words"}," 个人 ")])])])}],["__scopeId","data-v-45275792"]]);const o=n({},[["render",function(t,n,a,o,l,c){const u=s(e.resolveDynamicComponent("home-head"),r),p=s(e.resolveDynamicComponent("home-foot"),i);return e.openBlock(),e.createElementBlock("view",{class:"main-container"},[e.createVNode(u),e.createElementVNode("div",{class:"content"},[e.createElementVNode("div",{class:"content-first-row"},[e.createElementVNode("navigator",{id:"link-to-smart-travel",url:"/pages/smart-travel/smart-travel"}," 智能出行 "),e.createElementVNode("a",{id:"link-to-snap-recognize"},[e.createElementVNode("img",{src:"https://img-insight.oss-cn-chengdu.aliyuncs.com/snap-icon.png"}),e.createTextVNode(" 拍照识图 ")])]),e.createElementVNode("div",{class:"content-second-row"},[e.createElementVNode("a",{id:"link-to-health-assistant"},[e.createElementVNode("img",{src:"https://img-insight.oss-cn-chengdu.aliyuncs.com/poe.png"}),e.createTextVNode(" 智能健康助手 ")])])]),e.createVNode(p)])}]]);const l=n({data:()=>({pathList:[{path:"/pages/recTest/my_test",lebal:"测试音频"},{path:"/pages/test-camera/test_nvue",lebal:"测试摄像头"},{path:"/pages/test_api/test_api",lebal:"测试API"}]}),methods:{TestPage(e){uni.navigateTo({url:e})}}},[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("div",{class:"container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.pathList,((t,n)=>(e.openBlock(),e.createElementBlock("button",{key:n,onClick:e=>i.TestPage(t.path)},e.toDisplayString(t.lebal),9,["onClick"])))),128))])])}]]);var c,u;const p={data(){return{...this.getTexts(),show:!1,statusMsg:"",Class:("a"+Math.random()).replace(".",""),showControlUI:!1,useNvuePlayer:!1,playing:!1,player_position:0,player_currentTime:"00:00",player_duration:"00:00",player_durationNum:0}},methods:{shareFile(){this.saveFileFn()},playStart(){this.playFn()},playStop(){this.stopFn&&this.stopFn()},setPlayerPosition(e){this.setPosFn(e)},getPage(){for(var e=this.$parent;e&&!e.reclog;)e=e.$parent;return e},reclog(){this.getPage().reclog.apply(this.$parent,arguments)},getTexts:()=>({T_pause:u?u("oozQ::暂停播放",":Pause"):"",T_play:u?u("PPxS::播放",":Play"):"",T_download:u?u("jtJH::下载保存",":Download and save"):""}),status(e){e=e?u("w7J2::播放器创建中：",":Player is being created: ")+e:"",this.statusMsg=e,e&&c.CLog(e)},formatTime(e,t){var n=e%1e3,r=(e=(e-n)/1e3)%60,a=(e=(e-r)/60)%60,s=(e=(e-a)/60,"");return e>0&&(s+=(e<10?"0":"")+e+":"),s+=(a<10?"0":"")+a+":",s+=(r<10?"0":"")+r,t&&(s+="″"+("00"+n).substr(-3)),s},createAudio(e,t,n,r,a,s){this.show=!1,this.status(""),this.playing=!1,this.player_durationNum=a,this.player_duration=this.formatTime(a),this.player_currentTime="00:00",this.player_position=0;var i="recordapp-"+Date.now()+"."+e,o=()=>{this.show=!0,this.status(""),c.CLog(u("GXCV::播放器创建完成，可以播放了",":The player is created and can be played"))};if(this.useNvuePlayer){this.showControlUI=!0;var l=(e,t,n,r)=>{c.UniSaveLocalFile(t,n,(t=>{this.reclog(e+u("FtgC::文件已保存在：",":File has been saved at: ")+t),r(t)}),(t=>{this.status(e+u("9AGy::保存文件失败，将无法播放：",":Failed to save the file and will not be able to play it: ")+t)}))};this.status(u("4xcp::正在将数据保存成本地文件以供播放...",":Saving data to local file for playback..."));var p="",d="",f=()=>{this.playUrl=p,this.playUrl_wav=d,o()};return l("",i,t,(e=>{p=e,r!=t?l(u("fU7N::[转码成wav播放]",":[Transcode to wav for playback]"),i+".wav",r,(e=>{d=e,f()})):f()})),this.setPosFn=e=>{var t=e.detail.value;this.audio||this.playFn();var n=Math.round(this.player_durationNum*t/100);this.audio.seek(n/1e3),this.audio.play()},this.playFn=()=>{var e=this.playSid;if(this.audio){if(this.audio.sid==e)return void(this.audio.paused?this.audio.play():this.audio.pause());this.stopFn()}this.audio=uni.createInnerAudioContext(),this.audio.src=this.playUrl_wav||this.playUrl,this.audio.sid=e,this.audio.onError((e=>{this.reclog(u("JRu4::onError 播放错误：",":onError Playback error: ")+e.errMsg,1)})),this.audio.timer=setInterval((()=>{if(this.playSid==e&&this.audio.duration){var t=Math.round(1e3*this.audio.duration),n=Math.round(1e3*this.audio.currentTime),r=t?Math.min(100,Math.round(n/t*100)):0;this.playing=!this.audio.paused,this.player_durationNum=t,this.player_duration=this.formatTime(t),this.player_currentTime=this.formatTime(n),this.player_position=r}}),100),this.audio.seek(0),this.audio.play(),this.playUrl_wav&&this.status(u("7ity::使用转码的wav播放",":Play using transcoded wav"))},this.stopFn=()=>{if(this.audio){clearInterval(this.audio.timer);try{this.audio.stop()}catch(e){}this.audio.destroy()}},void(this.saveFileFn=()=>{this.reclog(u("OAiD::{1}字节文件已保存在：",":The {1} byte file has been saved at: ",0,t.byteLength)+p,2)})}c.UniWebViewVueCall(this.getPage(),`\n\t\t\t\tif(this.playUrl)URL.revokeObjectURL(this.playUrl);\n\t\t\t\tthis.playUrl=URL.createObjectURL(new Blob([this.player_buffer],{type:"${s}"}));\n\t\t\t\tdocument.querySelector(".${this.Class} .h5Audio").innerHTML='<audio style="width:100%" />';\n\t\t\t\tthis.playEl=document.querySelector(".${this.Class} .h5Audio audio");\n\t\t\t\tthis.playEl.controls=true;\n\t\t\t\tthis.playEl.src=this.playUrl;\n\t\t\t\tthis.playEl.onerror=function(e){ This.$ownerInstance.callMethod("status","${u("8NWB::播放发生错误：",":An error occurred during playback: ")}"+e.message); }\n\t\t\t\tthis.playEl.onpause=function(){ This.$ownerInstance.callMethod("player_stopFn",""); }\n\t\t\t`),o(),this.playFn=()=>{this.playing=!0,c.UniWebViewVueCall(this.getPage(),"\n\t\t\t\t\tif(this.playEl.paused){\n\t\t\t\t\t\tthis.playEl.play();\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.playEl.onpause();\n\t\t\t\t\t}\n\t\t\t\t")},this.stopFn=()=>{this.playing=!1,c.UniWebViewVueCall(this.getPage(),"this.playEl.pause();")},this.getPage().player_stopFn=this.stopFn,this.saveFileFn=()=>{this.reclog(u("2Hr1::正在保存文件...",":Saving file...")),c.UniSaveLocalFile(i,t,(e=>{this.reclog(u("GW1Q::{1}字节文件已保存在：",":The {1} byte file has been saved at: ",0,t.byteLength)+e,2)}),(e=>{this.reclog(e)}))}},setPlayBytes(e,t,n,r,a,s){this.show=!1,this.playStop(),this.playSid=(this.playSid||0)+1,this.status("");var i=e,o=r;if(e){c=s.RecordApp,u=s.i18n.$T;var l=this.getTexts();for(var p in l)this[p]=l[p];var d=()=>{this.createAudio(a.type,i,o,e,n,r)};if(!c.UniIsApp()||c.UniWithoutAppRenderjs){var f=s[a.type+"2wav"],h=Date.now();if(!f)return d();var _=e;"pcm"==a.type&&(_={sampleRate:a.sampleRate,bitRate:a.bitRate,blob:e}),this.status(u("bHhO::正在转码成wav...",":Converting to wav...")),f(_,((t,a,s)=>{e=t,n=a,r=s,this.reclog(u("MhM5::已转码成wav以供播放，耗时{1}ms",":Transcoded to wav for playback, takes {1}ms",0,Date.now()-h)),d()}),(e=>{this.reclog(u("oSeh::转码成wav失败：",":Transcoding to wav failed: ")+e,1),d()}))}else{var m=c.UniMainCallBack((t=>{if(t.errMsg)return this.reclog(u("LU2T::转码成wav失败：",":Transcoding to wav failed: ")+t.errMsg,1),void d();2!=t.ok?(this.reclog(u("65fk::已转码成wav以供播放，耗时{1}ms",":Transcoded to wav for playback, takes {1}ms",0,Date.now()-b)),e=c.UniMainTakeBigBytes(t.dataId),n=t.dur,r=t.mie,d()):d()})),v=null,g=0,b=Date.now();t||(v=i,g=Date.now(),t="BigBytes",c.CLog("[播放器]正在将"+i.byteLength+"字节音频数据发送到renderjs，因为可能需要转码成wav，可能会比较慢")),this.status(u("XkoT::正在调用renderjs处理音频数据，此格式如果提供了{1}2wav，将会转码成wav，会比较耗时...",":Renderjs is being called to process audio data. If {1}2wav is provided in this format, it will be transcoded into wav, which will be more time-consuming...",0,a.type)),c.UniWebViewVueCall(this.getPage(),`\n\t\t\t\t\tif(${g})RecordApp.CLog("[播放器]完成传输${i.byteLength}字节的数据到renderjs，耗时"+(Date.now()-${g})+"ms");\n\t\t\t\t\tvar recSet=${JSON.stringify(a)}, aBuf0=${t}, aBuf=aBuf0, duration, mime;\n\t\t\t\t\tvar end=function(err){\n\t\t\t\t\t\tThis.player_buffer=aBuf,t1=Date.now();\n\t\t\t\t\t\tif(err) return RecordApp.UniWebViewSendToMain({action:"${m}",errMsg:err});\n\t\t\t\t\t\tif(aBuf==aBuf0) return RecordApp.UniWebViewSendToMain({action:"${m}",ok:2});\n\t\t\t\t\t\tRecordApp.CLog("[播放器]开始传输"+aBuf.byteLength+"字节的数据回逻辑层，可能会比较慢");\n\t\t\t\t\t\tRecordApp.UniWebViewSendBigBytesToMain(aBuf,function(dataId){//数据可能很大\n\t\t\t\t\t\t\tRecordApp.CLog("[播放器]完成传输"+aBuf.byteLength+"字节的数据回逻辑层，耗时"+(Date.now()-t1)+"ms");\n\t\t\t\t\t\t\tRecordApp.UniWebViewSendToMain({action:"${m}",ok:1,dataId:dataId,dur:duration,mie:mime});\n\t\t\t\t\t\t},end);\n\t\t\t\t\t};\n\t\t\t\t\tvar wav=Recorder[recSet.type+"2wav"];\n\t\t\t\t\tif(!wav) return end();\n\t\t\t\t\tvar wavData=aBuf;\n\t\t\t\t\tif(recSet.type=="pcm") wavData={ sampleRate:recSet.sampleRate,bitRate:recSet.bitRate,blob:aBuf };\n\t\t\t\t\twav(wavData,function(wavBuf,dur,mie){\n\t\t\t\t\t\taBuf=wavBuf; duration=dur; mime=mie;\n\t\t\t\t\t\tend();\n\t\t\t\t\t},function(msg){\n\t\t\t\t\t\tend("${u("mzxq::转码成wav失败：",":Transcoding to wav failed: ")}"+msg);\n\t\t\t\t\t});\n\t\t\t\t`,v)}}}}};const d=n(p,[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{class:e.normalizeClass(s.Class),style:e.normalizeStyle({display:s.show?"":"none"})},[s.show?(e.openBlock(),e.createElementBlock("view",{key:0,style:{padding:"0 10px",display:"flex","flex-direction":"row"}},[e.createElementVNode("view",null,[e.createElementVNode("button",{size:"mini",onClick:n[0]||(n[0]=(...e)=>i.playStart&&i.playStart(...e))},e.toDisplayString(s.playing?t.T_pause:t.T_play),1)]),e.createElementVNode("view",{style:{flex:"1"}}),e.createElementVNode("view",null,[e.createElementVNode("button",{size:"mini",onClick:n[1]||(n[1]=(...e)=>i.shareFile&&i.shareFile(...e))},e.toDisplayString(t.T_download),1)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"shareFileMsg"}),s.show&&s.showControlUI?(e.openBlock(),e.createElementBlock("view",{key:1},[e.createElementVNode("view",{style:{"padding-top":"10px"}},[e.createElementVNode("slider",{value:s.player_position,onChange:n[2]||(n[2]=(...e)=>i.setPlayerPosition&&i.setPlayerPosition(...e)),step:"1",max:"100",min:"0"},null,40,["value"])]),e.createElementVNode("view",{style:{padding:"0 10px",display:"flex","flex-direction":"row"}},[e.createElementVNode("view",{style:{flex:"1"}},e.toDisplayString(s.player_currentTime),1),e.createElementVNode("view",{style:{flex:"1","text-align":"right"}},e.toDisplayString(s.player_duration),1)])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"h5Audio"})],6),e.createElementVNode("view",{style:{color:"#f60"}},e.toDisplayString(s.statusMsg),1)])}]]);var f,h,_,m={};f={get exports(){return m},set exports(e){m=e}},h="object"==typeof window&&!!window.document,function(e,t){var n=function(){},r=function(e){return"number"==typeof e},s=function(e){return new I(e)},i=s.LM="2023-12-24 18:09",o="https://github.com/xiangyuecn/Recorder",l="Recorder",c="getUserMedia",u="srcSampleRate",p="sampleRate",d="bitRate",f="catch",h=e[l];if(h&&h.LM==i)h.CLog(h.i18n.$T("K8zP::重复导入{1}",0,l),3);else{s.IsOpen=function(){var e=s.Stream;if(e){var t=(e.getTracks&&e.getTracks()||e.audioTracks||[])[0];if(t){var n=t.readyState;return"live"==n||n==t.LIVE}}return!1},s.BufferSize=4096,s.Destroy=function(){for(var e in A(l+" Destroy"),R(),_)_[e]()};var _={};s.BindDestroy=function(e,t){_[e]=t},s.Support=function(){if(!t)return!1;var e=navigator.mediaDevices||{};return e[c]||(e=navigator)[c]||(e[c]=e.webkitGetUserMedia||e.mozGetUserMedia||e.msGetUserMedia),!!e[c]&&(s.Scope=e,!!s.GetContext())},s.GetContext=function(e){if(!t)return null;var n=window.AudioContext;if(n||(n=window.webkitAudioContext),!n)return null;var r=s.Ctx;if(r&&"closed"!=r.state||(r=s.Ctx=new n,s.NewCtxs=s.NewCtxs||[],s.BindDestroy("Ctx",(function(){var e=s.Ctx;e&&e.close&&(e.close(),s.Ctx=0);var t=s.NewCtxs;s.NewCtxs=[];for(var n=0;n<t.length;n++)t[n].close()}))),e&&r.close)try{r=new n,s.NewCtxs.push(r)}catch(a){A("GetContext tryNew Error",1,a)}return r},s.CloseNewCtx=function(e){if(e&&e!=s.Ctx){e.close&&e.close();for(var t=s.NewCtxs||[],n=t.length,r=0;r<t.length;r++)if(t[r]==e){t.splice(r,1);break}A(P("mSxV::剩{1}个GetContext未close",0,n+"-1="+t.length),t.length?3:0)}};var m=function(e){var t=e.state,n="ctx.state="+t;return"suspended"==t&&(n+=P("nMIy::（注意：ctx不是running状态，rec.open和start至少要有一个在用户操作(触摸、点击等)时进行调用，否则将在rec.start时尝试进行ctx.resume，可能会产生兼容性问题(仅iOS)，请参阅文档中runningContext配置）")),n},v="ConnectEnableWebM";s[v]=!0;var g="ConnectEnableWorklet";s[g]=!1;var b=function(e,t){var n=e.BufferSize||s.BufferSize,r=e.Stream,a=r._RC||r._c||s.GetContext(!0);r._c=a;var i,o,c,u=function(e){var t=r._m=a.createMediaStreamSource(r),n=a.destination,s="createMediaStreamDestination";a[s]&&(n=r._d=a[s]()),t.connect(e),e.connect(n)},d="",h=r._call,_=function(e){for(var t in h){for(var n=e.length,r=new Int16Array(n),a=0,s=0;s<n;s++){var i=Math.max(-1,Math.min(1,e[s]));i=i<0?32768*i:32767*i,r[s]=i,a+=Math.abs(i)}for(var o in h)h[o](r,a);return}},m="ScriptProcessor",b="audioWorklet",w=l+" "+b,R="RecProc",k="MediaRecorder",T=k+".WebM.PCM",x=a.createScriptProcessor||a.createJavaScriptNode,E=P("ZGlf::。由于{1}内部1秒375次回调，在移动端可能会有性能问题导致回调丢失录音变短，PC端无影响，暂不建议开启{1}。",0,b),M=function(){o=r.isWorklet=!1,y(r),A(P("7TU0::Connect采用老的{1}，",0,m)+N.get(s[g]?P("JwCL::但已设置{1}尝试启用{2}",2):P("VGjB::可设置{1}尝试启用{2}",2),[l+"."+g+"=true",b])+d+E,3);var e=r._p=x.call(a,n,1,1);u(e),e.onaudioprocess=function(e){var t=e.inputBuffer.getChannelData(0);_(t)}},B=function(){i=r.isWebM=!1,S(r),o=r.isWorklet=!x||s[g];var e=window.AudioWorkletNode;if(o&&a[b]&&e){var t=function(){var e=function(e){return e.toString().replace(/^function|DEL_/g,"").replace(/\$RA/g,w)},t="class "+R+" extends AudioWorkletProcessor{";return t+="constructor "+e((function(e){DEL_super(e);var t=this,n=e.processorOptions.bufferSize;t.bufferSize=n,t.buffer=new Float32Array(2*n),t.pos=0,t.port.onmessage=function(e){e.data.kill&&(t.kill=!0,$C.log("$RA kill call"))},$C.log("$RA .ctor call",e)})),t+="process "+e((function(e,t,n){var r=this,a=r.bufferSize,s=r.buffer,i=r.pos;if((e=(e[0]||[])[0]||[]).length){s.set(e,i);var o=~~((i+=e.length)/a)*a;if(o){this.port.postMessage({val:s.slice(0,o)});var l=s.subarray(o,i);(s=new Float32Array(2*a)).set(l),i=l.length,r.buffer=s}r.pos=i}return!r.kill})),t=(t+='}try{registerProcessor("'+R+'", '+R+')}catch(e){$C.error("'+w+' Reg Error",e)}').replace(/\$C\./g,"console."),"data:text/javascript;base64,"+btoa(unescape(encodeURIComponent(t)))},p=function(){return o&&r._na},v=r._na=function(){""!==c&&(clearTimeout(c),c=setTimeout((function(){c=0,p()&&(A(P("MxX1::{1}未返回任何音频，恢复使用{2}",0,b,m),3),x&&M())}),500))},y=function(){if(p()){var t=r._n=new e(a,R,{processorOptions:{bufferSize:n}});u(t),t.port.onmessage=function(e){c&&(clearTimeout(c),c=""),p()?_(e.data.val):o||A(P("XUap::{1}多余回调",0,b),3)},A(P("yOta::Connect采用{1}，设置{2}可恢复老式{3}",0,b,l+"."+g+"=false",m)+d+E,3)}};a.resume()[h&&"finally"]((function(){if(p())if(a[R])y();else{var e=t();a[b].addModule(e).then((function(e){p()&&(a[R]=1,y(),c&&v())}))[f]((function(e){A(b+".addModule Error",1,e),p()&&M()}))}}))}else M()};!function(){var e=window[k],o="ondataavailable",u="audio/webm; codecs=pcm";i=r.isWebM=s[v];var f=e&&o in e.prototype&&e.isTypeSupported(u);if(d=f?"":P("VwPd::（此浏览器不支持{1}）",0,T),t&&i&&f){var h=function(){return i&&r._ra};r._ra=function(){""!==c&&(clearTimeout(c),c=setTimeout((function(){h()&&(A(P("vHnb::{1}未返回任何音频，降级使用{2}",0,k,b),3),B())}),500))};var g=Object.assign({mimeType:u},s.ConnectWebMOptions),w=r._r=new e(r,g),y=r._rd={sampleRate:a[p]};w[o]=function(e){var t=new FileReader;t.onloadend=function(){if(h()){var e=C(new Uint8Array(t.result),y);if(!e)return;if(-1==e)return void B();c&&(clearTimeout(c),c=""),_(e)}else i||A(P("O9P7::{1}多余回调",0,k),3)},t.readAsArrayBuffer(e.data)},w.start(~~(n/48)),A(P("LMEm::Connect采用{1}，设置{2}可恢复使用{3}或老式{4}",0,T,l+"."+v+"=false",b,m))}else B()}()},w=function(e){e._na&&e._na(),e._ra&&e._ra()},y=function(e){e._na=null,e._n&&(e._n.port.postMessage({kill:!0}),e._n.disconnect(),e._n=null)},S=function(e){e._ra=null,e._r&&(e._r.stop(),e._r=null)},R=function(e){var t=(e=e||s)==s,n=e.Stream;n&&(n._m&&(n._m.disconnect(),n._m=null),!n._RC&&n._c&&s.CloseNewCtx(n._c),n._RC=null,n._c=null,n._d&&(k(n._d.stream),n._d=null),n._p&&(n._p.disconnect(),n._p.onaudioprocess=n._p=null),y(n),S(n),t&&k(n)),e.Stream=0},k=s.StopS_=function(e){for(var t=e.getTracks&&e.getTracks()||e.audioTracks||[],n=0;n<t.length;n++){var r=t[n];r.stop&&r.stop()}e.stop&&e.stop()};s.SampleData=function(e,t,n,r,a){var i="SampleData";r||(r={});var o=r.index||0,l=r.offset||0,c=r.filter;if(c&&c.fn&&c.sr!=t&&(c=null,A(P("d48C::{1}的filter采样率变了，重设滤波",0,i),3)),!c){var u=n>3*t/4?0:n/2*3/4;c={fn:u?s.IIRFilter(!0,t,u):0}}c.sr=t;var p=c.fn,d=r.frameNext||[];a||(a={});var f=a.frameSize||1;a.frameType&&(f="mp3"==a.frameType?1152:1);var h=e.length;o>h+1&&A(P("tlbC::{1}似乎传入了未重置chunk {2}",0,i,o+">"+h),3);for(var _=0,m=o;m<h;m++)_+=e[m].length;_=Math.max(0,_-Math.floor(l));var v=t/n;v>1?_=Math.floor(_/v):(v=1,n=t),_+=d.length;var g=new Int16Array(_),b=0;for(m=0;m<d.length;m++)g[b]=d[m],b++;for(;o<h;o++){for(var w=e[o],y=(m=l,w.length),S=p&&p.Embed,R=0,k=0,T=0,x=0,C=0,E=0;C<y;C++,E++)if(E<y&&(S?(T=w[E],x=S.b0*T+S.b1*S.x1+S.b0*S.x2-S.a1*S.y1-S.a2*S.y2,S.x2=S.x1,S.x1=T,S.y2=S.y1,S.y1=x):x=p?p(w[E]):w[E]),R=k,k=x,0!=E){var M=Math.floor(m);if(C==M){var B=R+((Math.ceil(m)<y?k:R)-R)*(m-M);B>32767?B=32767:B<-32768&&(B=-32768),g[b]=B,b++,m+=v}}else C--;l=Math.max(0,m-y)}d=null;var V=g.length%f;if(V>0){var N=2*(g.length-V);d=new Int16Array(g.buffer.slice(N)),g=new Int16Array(g.buffer.slice(0,N))}return{index:o,offset:l,filter:c,frameNext:d,sampleRate:n,data:g}},s.IIRFilter=function(e,t,n){var r=2*Math.PI*n/t,a=Math.sin(r),s=Math.cos(r),i=a/2,o=1+i,l=-2*s/o,c=(1-i)/o;if(e)var u=(1-s)/2/o,p=(1-s)/o;else u=(1+s)/2/o,p=-(1+s)/o;var d=0,f=0,h=0,_=0,m=0,v=function(e){return h=u*e+p*d+u*f-l*_-c*m,f=d,d=e,m=_,_=h,h};return v.Embed={x1:0,x2:0,y1:0,y2:0,b0:u,b1:p,a1:l,a2:c},v},s.PowerLevel=function(e,t){var n=e/t||0;return n<1251?Math.round(n/1250*10):Math.round(Math.min(100,Math.max(0,100*(1+Math.log(n/1e4)/Math.log(10)))))},s.PowerDBFS=function(e){var t=Math.max(.1,e||0),n=32767;return t=Math.min(t,n),t=20*Math.log(t/n)/Math.log(10),Math.max(-100,Math.round(t))},s.CLog=function(e,t){if("object"==typeof console){var n=new Date,a=("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2)+"."+("00"+n.getMilliseconds()).substr(-3),i=this&&this.envIn&&this.envCheck&&this.id,o=["["+a+" "+l+(i?":"+i:"")+"]"+e],c=arguments,u=s.CLog,p=2,d=u.log||console.log;for(r(t)?d=1==t?u.error||console.error:3==t?u.warn||console.warn:d:p=1;p<c.length;p++)o.push(c[p]);T?d&&d("[IsLoser]"+o[0],o.length>1?o:""):d.apply(console,o)}};var A=function(){s.CLog.apply(this,arguments)},T=!0;try{T=!console.log.apply}catch(U){}var x=0;s.Sync={O:9,C:9},s.prototype=I.prototype={CLog:A,_streamStore:function(){return this.set.sourceStream?this:s},_streamCtx:function(){var e=this._streamStore().Stream;return e&&e._c},open:function(e,r){var a=this,l=a.set,u=a._streamStore(),d=0;e=e||n;var h=function(e,t){t=!!t,a.CLog(P("5tWi::录音open失败：")+e+",isUserNotAllow:"+t,1),d&&s.CloseNewCtx(d),r&&r(e,t)};a._streamTag=c;var _=function(){a.CLog("open ok, id:"+a.id+" stream:"+a._streamTag),e(),a._SO=0},v=u.Sync,g=++v.O,w=v.C;a._O=a._O_=g,a._SO=a._S;var y=function(){if(w!=v.C||!a._O){var e=P("dFm8::open被取消");return g==v.O?a.close():e=P("VtJO::open被中断"),h(e),!0}};if(t){var S=a.envCheck({envName:"H5",canProcess:!0});if(S)h(P("A5bm::不能录音：")+S);else if(l.sourceStream){if(a._streamTag="set.sourceStream",!s.GetContext())return void h(P("1iU7::不支持此浏览器从流中获取录音"));R(u);var k=a.Stream=l.sourceStream;k._RC=l.runningContext,k._call={};try{b(u)}catch(U){return R(u),void h(P("BTW2::从流中打开录音失败：")+U.message)}_()}else{var A=function(e,t){try{window.top.a}catch(U){return void h(P("Nclz::无权录音(跨域，请尝试给iframe添加麦克风访问策略，如{1})",0,'allow="camera;microphone"'))}/Permission|Allow/i.test(e)?h(P("gyO5::用户拒绝了录音权限"),!0):!1===window.isSecureContext?h(P("oWNo::浏览器禁止不安全页面录音，可开启https解决")):/Found/i.test(e)?h(t+P("jBa9::，无可用麦克风")):h(t)};if(s.IsOpen())_();else if(s.Support()){var T=l.runningContext;T||(T=d=s.GetContext(!0));var x=function(e){setTimeout((function(){e._call={};var t=s.Stream;t&&(R(),e._call=t._call),s.Stream=e,e._c=T,e._RC=l.runningContext,y()||(s.IsOpen()?(t&&a.CLog(P("upb8::发现同时多次调用open"),1),b(u,1),_()):h(P("Q1GA::录音功能无效：无音频流")))}),100)},C=function(e){var t=e.name||e.message||e.code+":"+e;a.CLog(P("xEQR::请求录音权限错误"),1,e),A(t,P("bDOG::无法录音：")+t)},E=l.audioTrackSet||{};E[p]=T[p];var M={audio:E};try{var B=s.Scope[c](M,x,C)}catch(U){a.CLog(c,3,U),M={audio:!0},B=s.Scope[c](M,x,C)}a.CLog(c+"("+JSON.stringify(M)+") "+m(T)+P("RiWe::，未配置noiseSuppression和echoCancellation时浏览器可能会自动打开降噪和回声消除，移动端可能会降低系统播放音量（关闭录音后可恢复），请参阅文档中audioTrackSet配置")+"("+o+") LM:"+i+" UA:"+navigator.userAgent),B&&B.then&&B.then(x)[f](C)}else A("",P("COxc::此浏览器不支持录音"))}}else h(P.G("NonBrowser-1",["open"])+P("EMJq::，可尝试使用RecordApp解决方案")+"("+o+"/tree/master/app-support-sample)")},close:function(e){e=e||n;var t=this,r=t._streamStore();t._stop();var a=" stream:"+t._streamTag,s=r.Sync;if(t._O=0,t._O_!=s.O)return t.CLog(P("hWVz::close被忽略（因为同时open了多个rec，只有最后一个会真正close）")+a,3),void e();s.C++,R(r),t.CLog("close,"+a),e()},mock:function(e,t){var n=this;return n._stop(),n.isMock=1,n.mockEnvInfo=null,n.buffers=[e],n.recSize=e.length,n._setSrcSR(t),n._streamTag="mock",n},_setSrcSR:function(e){var t=this,n=t.set,r=n[p];r>e?n[p]=e:r=0,t[u]=e,t.CLog(u+": "+e+" set."+p+": "+n[p]+(r?" "+P("UHvm::忽略")+": "+r:""),r?3:0)},envCheck:function(e){var t,n=this,r=n.set,a="CPU_BE";if(t||s[a]||"function"!=typeof Int8Array||new Int8Array(new Int32Array([1]).buffer)[0]||(j(a),t=P("Essp::不支持{1}架构",0,a)),!t){var i=r.type,o=n[i+"_envCheck"];r.takeoffEncodeChunk&&(o?e.canProcess||(t=P("7uMV::{1}环境不支持实时处理",0,e.envName)):t=P("2XBl::{1}类型不支持设置takeoffEncodeChunk",0,i)+(n[i]?"":P("LG7e::(未加载编码器)"))),!t&&o&&(t=n[i+"_envCheck"](e,r))}return t||""},envStart:function(e,t){var n=this,r=n.set;if(n.isMock=e?1:0,n.mockEnvInfo=e,n.buffers=[],n.recSize=0,e&&(n._streamTag="env$"+e.envName),n.state=1,n.envInLast=0,n.envInFirst=0,n.envInFix=0,n.envInFixTs=[],n._setSrcSR(t),n.engineCtx=0,n[r.type+"_start"]){var a=n.engineCtx=n[r.type+"_start"](r);a&&(a.pcmDatas=[],a.pcmSize=0)}},envResume:function(){this.envInFixTs=[]},envIn:function(e,t){var n=this,r=n.set,i=n.engineCtx;if(1==n.state){var o=n[u],l=e.length,c=s.PowerLevel(t,l),d=n.buffers,f=d.length;d.push(e);var h=d,_=f,m=Date.now(),v=Math.round(l/o*1e3);n.envInLast=m,1==n.buffers.length&&(n.envInFirst=m-v);var g=n.envInFixTs;g.splice(0,0,{t:m,d:v});for(var b=m,w=0,y=0;y<g.length;y++){var S=g[y];if(m-S.t>3e3){g.length=y;break}b=S.t,w+=S.d}var R=g[1],k=m-b;if(k-w>k/3&&(R&&k>1e3||g.length>=6)){var A=m-R.t-v;if(A>v/5){var T=!r.disableEnvInFix;if(n.CLog("["+m+"]"+N.get(P(T?"4Kfd::补偿{1}ms":"bM5i::未补偿{1}ms",1),[A]),3),n.envInFix+=A,T){var x=new Int16Array(A*o/1e3);l+=x.length,d.push(x)}}}var C=n.recSize,E=l,M=C+E;if(n.recSize=M,i){var B=s.SampleData(d,o,r[p],i.chunkInfo);i.chunkInfo=B,M=(C=i.pcmSize)+(E=B.data.length),i.pcmSize=M,d=i.pcmDatas,f=d.length,d.push(B.data),o=B[p]}var V=Math.round(M/o*1e3),j=d.length,I=h.length,L=function(){for(var e=O?0:-E,t=null==d[0],a=f;a<j;a++){var s=d[a];null==s?t=1:(e+=s.length,i&&s.length&&n[r.type+"_encode"](i,s))}if(t&&i)for(a=_,h[0]&&(a=0);a<I;a++)h[a]=null;t&&(e=O?E:0,d[0]=null),i?i.pcmSize+=e:n.recSize+=e},O=0,D="rec.set.onProcess";try{O=r.onProcess(d,c,V,o,f,L)}catch(U){a("error","at node_modules/recorder-core/src/recorder-core.js:1197",D+P("gFUF::回调出错是不允许的，需保证不会抛异常"),U)}var H=Date.now()-m;if(H>10&&n.envInFirst-m>1e3&&n.CLog(D+P("2ghS::低性能，耗时{1}ms",0,H),3),!0===O){var W=0;for(y=f;y<j;y++)null==d[y]?W=1:d[y]=new Int16Array(0);W?n.CLog(P("ufqH::未进入异步前不能清除buffers"),3):i?i.pcmSize-=E:n.recSize-=E}else L()}else n.state||n.CLog("envIn at state=0",3)},start:function(){var e=this,t=1;if(e.set.sourceStream?e.Stream||(t=0):s.IsOpen()||(t=0),t){var n=e._streamCtx();if(e.CLog(P("kLDN::start 开始录音，")+m(n)+" stream:"+e._streamTag),e._stop(),e.envStart(null,n[p]),e.state=3,e._SO&&e._SO+1!=e._S)e.CLog(P("Bp2y::start被中断"),3);else{e._SO=0;var r=function(){3==e.state&&(e.state=1,e.resume())};if("suspended"==n.state){var a="AudioContext resume: ";e.CLog(a+"wait..."),n.resume().then((function(){e.CLog(a+n.state),r()}))[f]((function(t){e.CLog(a+n.state+P("upkE::，可能无法录音：")+t.message,1,t),r()}))}else r()}}else e.CLog(P("6WmN::start失败：未open"),1)},pause:function(){var e=this,t=e._streamStore().Stream;e.state&&(e.state=2,e.CLog("pause"),t&&delete t._call[e.id])},resume:function(){var e=this,t=e._streamStore().Stream;e.state&&(e.state=1,e.CLog("resume"),e.envResume(),t&&(t._call[e.id]=function(t,n){1==e.state&&e.envIn(t,n)},w(t)))},_stop:function(e){var t=this,n=t.set;t.isMock||t._S++,t.state&&(t.pause(),t.state=0),!e&&t[n.type+"_stop"]&&(t[n.type+"_stop"](t.engineCtx),t.engineCtx=0)},stop:function(e,t,n){var r,a=this,c=a.set,d=a.envInLast-a.envInFirst,f=d&&a.buffers.length;a.CLog(P("Xq4s::stop 和start时差:")+(d?d+"ms "+P("3CQP::补偿:")+a.envInFix+"ms envIn:"+f+" fps:"+(f/d*1e3).toFixed(1):"-")+" stream:"+a._streamTag+" ("+o+") LM:"+i);var h=function(){a._stop(),n&&a.close()},_=function(e){a.CLog(P("u8JG::结束录音失败：")+e,1),t&&t(e),h()},m=function(t,n,i){var o="blob",u="arraybuffer",p="dataType",d="DefaultDataType",f=a[p]||s[d]||o,m=p+"="+f,v=t instanceof ArrayBuffer,g=0,b=v?t.byteLength:t.size;if(f==u?v||(g=1):f==o?"function"!=typeof Blob?g=P.G("NonBrowser-1",[m])+P("1skY::，请设置{1}",0,l+"."+d+'="'+u+'"'):(v&&(t=new Blob([t],{type:n})),t instanceof Blob||(g=1),n=t.type||n):g=P.G("NotSupport-1",[m]),a.CLog(P("Wv7l::结束录音 编码花{1}ms 音频时长{2}ms 文件大小{3}b",0,Date.now()-r,i,b)+" "+m+","+n),g)_(1!=g?g:P("Vkbd::{1}编码器返回的不是{2}",0,c.type,f)+", "+m);else{if(c.takeoffEncodeChunk)a.CLog(P("QWnr::启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据"),3);else if(b<Math.max(50,i/5))return void _(P("Sz2H::生成的{1}无效",0,c.type));e&&e(t,i,n),h()}};if(!a.isMock){var v=3==a.state;if(!a.state||v)return void _(P("wf9t::未开始录音")+(v?P("Dl2c::，开始录音前无用户交互导致AudioContext未运行"):""))}a._stop(!0);var g=a.recSize;if(g)if(a[c.type]){if(a.isMock){var b=a.envCheck(a.mockEnvInfo||{envName:"mock",canProcess:!1});if(b)return void _(P("AxOH::录音错误：")+b)}var w=a.engineCtx;if(a[c.type+"_complete"]&&w){var y=Math.round(w.pcmSize/c[p]*1e3);return r=Date.now(),void a[c.type+"_complete"](w,(function(e,t){m(e,t,y)}),_)}if(r=Date.now(),a.buffers[0]){var S=s.SampleData(a.buffers,a[u],c[p]);c[p]=S[p];var R=S.data;y=Math.round(R.length/c[p]*1e3),a.CLog(P("CxeT::采样:{1} 花:{2}ms",0,g+"->"+R.length,Date.now()-r)),setTimeout((function(){r=Date.now(),a[c.type](R,(function(e,t){m(e,t,y)}),(function(e){_(e)}))}))}else _(P("xkKd::音频buffers被释放"))}else _(P("xGuI::未加载{1}编码器，请尝试到{2}的src/engine内找到{1}的编码器并加载",0,c.type,l));else _(P("Ltz3::未采集到录音"))}};var C=function(e,t){t.pos||(t.pos=[0],t.tracks={},t.bytes=[]);var n=t.tracks,r=[t.pos[0]],a=function(){t.pos[0]=r[0]},s=t.bytes.length,i=new Uint8Array(s+e.length);if(i.set(t.bytes),i.set(e,s),t.bytes=i,!t._ht){if(B(i,r),V(i,r),!E(B(i,r),[24,83,128,103]))return;for(B(i,r);r[0]<i.length;){var o=B(i,r),l=V(i,r),c=[0],u=0;if(!l)return;if(E(o,[22,84,174,107])){for(;c[0]<l.length;){var d=B(l,c),f=V(l,c),h=[0],_={channels:0,sampleRate:0};if(E(d,[174]))for(;h[0]<f.length;){var m=B(f,h),v=V(f,h),g=[0];if(E(m,[215])){var b=M(v);_.number=b,n[b]=_}else if(E(m,[131]))1==(b=M(v))?_.type="video":2==b?(_.type="audio",u||(t.track0=_),_.idx=u++):_.type="Type-"+b;else if(E(m,[134])){for(var w="",y=0;y<v.length;y++)w+=String.fromCharCode(v[y]);_.codec=w}else if(E(m,[225]))for(;g[0]<v.length;){var S=B(v,g),R=V(v,g);if(E(S,[181])){b=0;var k=new Uint8Array(R.reverse()).buffer;4==R.length?b=new Float32Array(k)[0]:8==R.length?b=new Float64Array(k)[0]:A("WebM Track !Float",1,R),_[p]=Math.round(b)}else E(S,[98,100])?_.bitDepth=M(R):E(S,[159])&&(_.channels=M(R))}}}t._ht=1,A("WebM Tracks",n),a();break}}}var T=t.track0;if(T){if(16==T.bitDepth&&/FLOAT/i.test(T.codec)&&(T.bitDepth=32,A("WebM 16->32 bit",3)),T[p]!=t[p]||32!=T.bitDepth||T.channels<1||!/(\b|_)PCM\b/i.test(T.codec))return t.bytes=[],t.bad||A("WebM Track Unexpected",3,t),t.bad=1,-1;for(var x=[],C=0;r[0]<i.length&&(d=B(i,r),f=V(i,r));){if(E(d,[163])){var N=15&f[0];if(_=n[N]){if(0===_.idx){var P=new Uint8Array(f.length-4);for(y=4;y<f.length;y++)P[y-4]=f[y];x.push(P),C+=P.length}}else A("WebM !Track"+N,1,n)}a()}if(C){var j=new Uint8Array(i.length-t.pos[0]);j.set(i.subarray(t.pos[0])),t.bytes=j,t.pos[0]=0,P=new Uint8Array(C),y=0;for(var I=0;y<x.length;y++)P.set(x[y],I),I+=x[y].length;if(k=new Float32Array(P.buffer),T.channels>1){var U=[];for(y=0;y<k.length;)U.push(k[y]),y+=T.channels;k=new Float32Array(U)}return k}}},E=function(e,t){if(!e||e.length!=t.length)return!1;if(1==e.length)return e[0]==t[0];for(var n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0},M=function(e){for(var t="",n=0;n<e.length;n++){var r=e[n];t+=(r<16?"0":"")+r.toString(16)}return parseInt(t,16)||0},B=function(e,t,n){var r=t[0];if(!(r>=e.length)){var a=("0000000"+e[r].toString(2)).substr(-8),s=/^(0*1)(\d*)$/.exec(a);if(s){var i=s[1].length,o=[];if(!(r+i>e.length)){for(var l=0;l<i;l++)o[l]=e[r],r++;return n&&(o[0]=parseInt(s[2]||"0",2)),t[0]=r,o}}}},V=function(e,t){var n=B(e,t,1);if(n){var r=M(n),a=t[0],s=[];if(r<2147483647){if(a+r>e.length)return;for(var i=0;i<r;i++)s[i]=e[a],a++}return t[0]=a,s}},N=s.i18n={lang:"zh-CN",alias:{"zh-CN":"zh","en-US":"en"},locales:{},data:{},put:function(e,t){var n=l+".i18n.put: ",r=e.overwrite;r=null==r||r;var a=e.lang;if(!(a=N.alias[a]||a))throw new Error(n+"set.lang?");var s=N.locales[a];s||(s={},N.locales[a]=s);for(var i,o=/^([\w\-]+):/,c=0;c<t.length;c++){var u=t[c];if(i=o.exec(u)){var p=i[1];u=u.substr(p.length+1),!r&&s[p]||(s[p]=u)}else A(n+"'key:'? "+u,3,e)}},get:function(){return N.v_G.apply(null,arguments)},v_G:function(e,t,n){t=t||[],n=n||N.lang,n=N.alias[n]||n;var r=N.locales[n],a=r&&r[e]||"";return a||"zh"==n?(N.lastLang=n,"=Empty"==a?"":a.replace(/\{(\d+)(\!?)\}/g,(function(n,r,s){return n=t[(r=+r||0)-1],(r<1||r>t.length)&&(n="{?}",A("i18n["+e+"] no {"+r+"}: "+a,3)),s?"":n}))):"en"==n?N.v_G(e,t,"zh"):N.v_G(e,t,"en")},$T:function(){return N.v_T.apply(null,arguments)},v_T:function(){for(var e,t=arguments,n="",a=[],s=0,i=l+".i18n.$T:",o=/^([\w\-]*):/,c=0;c<t.length;c++){var u=t[c];if(0==c){if(!(n=(e=o.exec(u))&&e[1]))throw new Error(i+"0 'key:'?");u=u.substr(n.length+1)}if(-1===s)a.push(u);else{if(s)throw new Error(i+" bad args");if(0===u)s=-1;else if(r(u)){if(u<1)throw new Error(i+" bad args");s=u}else{var p=1==c?"en":c?"":"zh";if((e=o.exec(u))&&(p=e[1]||p,u=u.substr(e[1].length+1)),!e||!p)throw new Error(i+c+" 'lang:'?");N.put({lang:p,overwrite:!1},[n+":"+u])}}}return n?s>0?n:N.v_G(n,a):""}},P=N.$T;P.G=N.get,P("NonBrowser-1::非浏览器环境，不支持{1}",1),P("IllegalArgs-1::参数错误：{1}",1),P("NeedImport-2::调用{1}需要先导入{2}",2),P("NotSupport-1::不支持：{1}",1),s.TrafficImgUrl="//ia.51.la/go1?id=20469973&pvFlag=1";var j=s.Traffic=function(e){if(t){e=e?"/"+l+"/Report/"+e:"";var n=s.TrafficImgUrl;if(n){var r=s.Traffic,a=/^(https?:..[^\/#]*\/?)[^#]*/i.exec(location.href)||[],i=a[1]||"http://file/",o=(a[0]||i)+e;0==n.indexOf("//")&&(n=/^https:/i.test(o)?"https:"+n:"http:"+n),e&&(n=n+"&cu="+encodeURIComponent(i+e)),r[o]||(r[o]=1,(new Image).src=n,A("Traffic Analysis Image: "+(e||l+".TrafficImgUrl="+s.TrafficImgUrl)))}}};h&&(A(P("8HO5::覆盖导入{1}",0,l),1),h.Destroy()),e[l]=s}function I(e){var t=this;t.id=++x,j();var a={type:"mp3",onProcess:n};for(var s in e)a[s]=e[s];t.set=a;var i=a[d],o=a[p];(i&&!r(i)||o&&!r(o))&&t.CLog(P.G("IllegalArgs-1",[P("VtS4::{1}和{2}必须是数值",0,p,d)]),1,e),a[d]=+i||16,a[p]=+o||16e3,t.state=0,t._S=9,t.Sync={O:9,C:9}}}(_=h?window:Object,h),f.exports&&(f.exports=_.Recorder);const v=m;var g={};!function(e){!function(t){var n="object"==typeof window&&!!window.document,r=n?window:Object,a=r.Recorder,s=a.i18n;!function(e,t,n,r,a){var s={LM:"2023-12-01 20:18",Current:0,Platforms:{}},i=s.Platforms,o="RecordApp",l="RequestPermission",c="RegisterPlatform",u=e[o];if(u&&u.LM==s.LM)return void u.CLog(r("uXtA::重复导入{1}",0,o),3);e[o]=s,t[o]=s,s.__SID_=0;var p=s.__SID=function(){return++s.__SID_},d=s.__Sync=function(e,t,n){return s.__SID_==e||(t&&f(r("kIBu::同时多次调用：{1}，旧的回调被丢弃",0,t)+(n?", error: "+n:""),3),!1)},f=function(){var e=arguments;e[0]="["+(f.Tag||o)+"]["+(s.Current&&s.Current.Key||"?")+"]"+e[0],t.CLog.apply(null,e)};s.CLog=f,s[c]=function(e,t){t.Key=e,i[e]&&f(r("ha2K::重复注册{1}",0,e),3),i[e]=t},s.__StopOnlyClearMsg=function(){return r("wpTL::仅清理资源")};var h="Default-H5";_={Support:function(e){e(!0)},CanProcess:function(){return!0}},s[c](h,_),_[l]=function(e,n,r){var a=s.__Rec;a&&(a.close(),s.__Rec=null),t().open((function(){n()}),r)},_.Start=function(e,n,r,a){var i=s.__Rec;null!=i&&i.stop(),s.__Rec=i=t(n),i.appSet=n,i.dataType="arraybuffer",i.open((function(){d(e)&&i.start(),r()}),a)},_.Stop=function(e,n,a){var i=s.__Rec,o=n?"":s.__StopOnlyClearMsg();if(!i)return t.IsOpen()&&((i=t()).open(),i.close()),void a(r("bpvP::未开始录音")+(o?" ("+o+")":""));var l=function(){if(d(e))for(var t in i.close(),i.set)i.appSet[t]=i.set[t]},c=function(e){l(),a(e)};n?i.stop((function(e,t,r){l(),n(e,t,r)}),c):c(o)},s.GetCurrentRecOrNull=function(){return s.__Rec||null},s.Pause=function(){var e=s.Current,t="Pause";if(!e||!e[t]||!1===e[t]()){var n=s.__Rec;n&&m(t)&&n.pause()}},s.Resume=function(){var e=s.Current,t="Resume";if(!e||!e[t]||!1===e[t]()){var n=s.__Rec;n&&m(t)&&n.resume()}};var _;var m=function(e){var t=s.Current;if(t&&t.CanProcess())return 1;f(r("fLJD::当前环境不支持实时回调，无法进行{1}",0,e),3)};s.Install=function(e,t){var n=s.Current;if(n)e&&e();else{var r=s.__reqs||(s.__reqs=[]);r.push({s:e,f:t}),e=function(){a("s",arguments)},t=function(){a("f",arguments)};var a=function(e,t){var n=[].concat(r);r.length=0;for(var a=0;a<n.length;a++){var s=n[a][e];s&&s.apply(null,t)}};if(!(r.length>1)){var o,l=[h];for(var c in i)c!=h&&l.push(c);l.reverse();var u=function(e){o=l[e],(n=i[o]).Support((function(r){if(!r)return u(e+1);n.Install?n.Install(p,t):p()}))},p=function(){s.Current=n,f("Install platform: "+o),e()};u(0)}}},s[l]=function(e,t){var n=p(),a=o+"."+l,i=function(e,s){var i=e+", isUserNotAllow:"+(s=!!s);d(n,a,i)&&(f(r("YnzX::录音权限请求失败：")+i,1),t&&t(e,s))};f(l+"..."),s.Install((function(){if(d(n,a)){var t=g();t?i(t):s.Current[l](n,(function(){d(n,a)&&(f(l+" Success"),e&&e())}),i)}}),i)};var v=function(){return r("nwKR::需先调用{1}",0,l)},g=function(){var e="";return s.Current.Key!=h||a||(e=r("citA::当前不是浏览器环境，需引入针对此平台的支持文件（{1}），或调用{2}自行实现接入",0,"src/app-support/app-xxx-support.js",o+"."+c)),e};s.Start=function(e,n,a){var l=p(),c=o+".Start",u=function(e){d(l,c,e)&&(f(r("ecp9::开始录音失败：")+e,1),a&&a(e))};f("Start...");var h=s.Current;if(h){e||(e={});var _={type:"mp3",sampleRate:16e3,bitRate:16,onProcess:function(){}};for(var m in _)e[m]||(e[m]=_[m]);for(var m in i){var b=i[m];b.AllStart_Clean&&b.AllStart_Clean(e)}var w=!1;if(h.Start_Check&&(w=h.Start_Check(e)),!1===w)(w=t(e).envCheck({envName:h.Key,canProcess:h.CanProcess()}))||(w=g());w?u(r("EKmS::不能录音：")+w):(s._SRec=0,h.Start(l,e,(function(){d(l,c)&&(f(r("k7Qo::已开始录音"),e),s._STime=Date.now(),n&&n())}),u))}else u(v())},s.Stop=function(e,n){var a=p(),i=o+".Stop",l=function(t){if(d(a,i,t)){f(r("Douz::结束录音失败：")+t,e?1:0);try{n&&n(t)}finally{c()}}},c=function(){s._SRec=s.__Rec,s.__Rec=null};f("Stop... "+r("wqSH::和Start时差：{1}ms",0,s._STime?Date.now()-s._STime:-1)+" Recorder.LM:"+t.LM+" "+o+".LM:"+s.LM);var u=Date.now(),h=s.Current;h?h.Stop(a,e?function(t,n,s){if(d(a,i)){f(r("g3VX::结束录音 耗时{1}ms 音频时长{2}ms 文件大小{3}b {4}",0,Date.now()-u,n,t.byteLength,s));try{e(t,n,s)}finally{c()}}}:null,l):l(v())}}(r,a,0,s.$T,n),e.exports&&(e.exports=r.RecordApp)}()}({get exports(){return g},set exports(e){g=e}});const b=g;!function(e){var t="object"==typeof window&&!!window.document,n=t?window:Object,r="https://github.com/xiangyuecn/Recorder/tree/master/app-support-sample/demo_UniApp";if(n.RecordApp){var s=n.Recorder;!function(e,t,n,r,a){var s=t.RecordApp,i=s.CLog,o=function(){};s.UniSupportLM="2023-12-08 20:55";var l="app-uni-support.js",c=!1,u=!1,p=!1;!function(){if(a){c=!0;var e=navigator.userAgent.replace(/[_\d]/g," ");u=!/\bandroid\b/i.test(e)&&/\bios\b|\biphone\b/i.test(e)}else"object"==typeof plus&&("Android"==plus.os.name?c=!0:"iOS"==plus.os.name&&(u=c=!0)),(p=c)||i("App !plus",1)}(),s.UniIsApp=function(){return c?u?2:1:0};var d=s.UniBtoa=function(e){if("object"==typeof uni&&uni.arrayBufferToBase64)return uni.arrayBufferToBase64(e);for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)},f=s.UniAtob=function(e){if("object"==typeof uni&&uni.base64ToArrayBuffer)return uni.base64ToArrayBuffer(e);for(var t=atob(e),n=new Uint8Array(t.length),r=0,a=t.length;r<a;r++)n[r]=t.charCodeAt(r);return n.buffer};s.UniB64Enc=function(e){if("object"==typeof uni&&uni.arrayBufferToBase64){var t=s.UniStr2Buf(e);return uni.arrayBufferToBase64(t)}return btoa(unescape(encodeURIComponent(e)))},s.UniB64Dec=function(e){if("object"==typeof uni&&uni.base64ToArrayBuffer){var t=uni.base64ToArrayBuffer(e);return s.UniBuf2Str(t)}return decodeURIComponent(escape(atob(e)))},s.UniStr2Buf=function(e){for(var t=unescape(encodeURIComponent(e)),n=new Uint8Array(t.length),r=0,a=t.length;r<a;r++)n[r]=t.charCodeAt(r);return n.buffer},s.UniBuf2Str=function(e){for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return decodeURIComponent(escape(n))};var h,_=s.UniJsSource={IsSource:!1,pcm_sum:function(e){for(var t=0,n=0;n<e.length;n++)t+=Math.abs(e[n]);return t}};h=["UniNativeRecordReceivePCM"," WvCid=wv_","H753::未配置RecordApp.UniNativeUtsPlugin原生录音插件","   jsCode="," set:","CjMb::无效的BigBytes回传数据","join","stringify","4ATo::Recorder-UniCore目前只支持：H5、APP(Android iOS)、MP-WEIXIN，其他平台环境需要自行编写适配文件实现接入","441rSzzgB","wvID",';\n\t\tset.onProcess=function(buffers,power,duration,sampleRate,newIdx){\n\t\t\tvar newBuffers=[],recSet=RecordApp.__Rec.set;\n\t\t\tfor(var i=newIdx;i<buffers.length;i++)newBuffers.push(RecordApp.UniBtoa(buffers[i].buffer));//@@Fast\n\t\t\tRecordApp.UniWebViewSendToMain({action:"recProcess",recSet_sr:recSet.sampleRate,recSet_bit:recSet.bitRate,sampleRate:sampleRate,newBuffers:newBuffers});\n\t\t\tprocFn&&procFn.apply(This,arguments);\n\t\t};',"AN0e::需在renderjs中import {1}","apply","width","random","__callWvActivate","onLog","tag","mOffset",'"));\n\t\t\tcur.memory.set(buf,cur.mOffset);\n\t\t\tcur.mOffset+=buf.byteLength;\n\t\t\tRecordApp.UniWebViewSendToMain({action:"',"1f2V:: | RecordApp的uni-app支持文档和示例：{1} "," srcSR:","UniApp-Renderjs","\n\t\t\t})()","4jKV::RecordApp.UniRenderjsRegister 需在renderjs中调用并且传入当前模块的this","$vm","onRecord","l6sY::renderjs中不支持设置RecordApp.UniNativeUtsPlugin",'(function(){\n\t\tvar fn=RecordApp.__UniData["',"root","__0hyi","当前未获得授权许可。文件","querySelectorAll","Tag","parse","rec encode: pcm:","Mvl7::调用plus的权限请求出错：","e71S::已购买uts插件，获得授权许可","fqhr::当前已配置RecordApp.UniWithoutAppRenderjs，必须提供原生录音插件或uts插件才能录音，请参考RecordApp.UniNativeUtsPlugin配置","_cid_","substr","set","UniWebViewVueCall","pcmDataBase64","Install","publishHandler","message","DisableIOSPlusReqPermission","7Noe::正在调用plus.android.requestPermissions请求Android原生录音权限","recordStop","param","iKhe::plus.ios请求录音权限，状态值: ","recordAlive","PkQ2::需先调用RecordApp.UniWebViewActivate，然后才可以调用RequestPermission","@req","Jk72::不应当出现的非H5权限请求","uid",';\n\t\t\tset.takeoffEncodeChunk=function(bytes){\n\t\t\t\tRecordApp.UniWebViewSendToMain({action:"recEncodeChunk",bytes:RecordApp.UniBtoa(bytes.buffer)});\n\t\t\t\ttakeFn&&takeFn.apply(This,arguments);\n\t\t\t};',"byteLength","getStorageSync","__nnM6","我已获得UniAppID=","RegisterPlatform","request","__wvCid","requestFileSystem","setAttribute","100%",';\n\t\t\t}\n\t\t\tif(!err && !RecordApp.Platforms["UniApp-Renderjs"]){\n\t\t\t\terr=',"6246736XWmZWR",";\n\t\t\t\t","UniPageOnShow","takeoffEncodeChunk_renderjs","aPoj::UniAppUseLicense填写无效，如果已获取到了商用授权，请填写：{1}，否则请使用空字符串","RecordApp.Stop()"," wvCid=","duration","MiniProgramWx_onShow","Default_Android_AudioSource","var takeFn=","envStart","bigBytes_","RequestPermission","$ownerInstance","SWsy::检测到有其他页面或组件调用了RecordApp.UniPageOnShow（WvCid={1}），但未调用过RecordApp.UniWebViewActivate（当前WvCid={2}），部分功能会继续使用之前Activate的WebView和组件，请确保这是符合你的业务逻辑，不是因为忘记了调用UniWebViewActivate","__uniAppReqWebViewId","我知道啦","var procFn=","w37G::已购买原生录音插件，获得授权许可","bitRate","kxOd::非App环境，不支持保存本地文件","isError",'"});\n\t\t})()','",errMsg:errMsg,isUserNotAllow:isUserNotAllow});\n\t\t\t});\n\t\t})()',"push","__uniNupErr","dl4f::{1}回传了未知内容，","Bgls::已获得Android原生录音权限：","UniRenderjsRegister","UniWebViewSendBigBytesToMain","__uniAppMainReceiveBind","envIn","1152655uPwqVo","TSmQ::需要在页面中提供一个renderjs，在里面import导入RecordApp、录音格式编码器、可视化插件等","canvas","vEgr::不应该出现的MainReceiveBind重复绑定","mrBind","mime","mzKj::RecordApp.UniRenderjsRegister 重复注册当前页面renderjs模块，一个组件内只允许一个renderjs模块进行注册","import 'recorder-core/src/app-support/app-miniProgram-wx-support.js'","Start_Check","UniAppUseLicense","FabE::【在App内使用{1}的授权许可】"," WvCid=","qDo1::未找到此页面renderjs所在的WebView","replace","nativePluginName","appId","wv_","__WebVieW_Id__",'"];\n\t\tif(fn)fn(',"mainCb_",'",ok:1});\n\t\t\t},function(errMsg,isUserNotAllow){\n\t\t\t\tRecordApp.UniWebViewSendToMain({action:"','",val);\n\t\t})()',"recSize","nnM6::当前录音由uts插件提供支持","rec_wv_cid_key","k7im::未找到Canvas：{1}，请确保此DOM已挂载（可尝试用$nextTick等待DOM更新）","errMsg",".memory.buffer; delete window.","ios","(function(){\n\t\t\tvar cur=window.","UniNativeUtsPlugin","pP4O::未开始录音","未获得商用授权时，App上仅供测试哈","bytes","dataType"," canvas","' ，就不会弹提示框了；或者购买了配套的原生录音插件或uts插件，设置RecordApp.UniNativeUtsPlugin参数后，也不会弹提示框。【获取授权方式一】联系作者加入VIP支持QQ群，入群后即获得授权，在群文件中可下载此js文件最新源码；【获取授权方式二】联系作者或到DCloud插件市场购买配套的原生录音插件或uts插件，购买后即获得授权（其中uts插件还在开发中不可购买）；购买后可联系作者拉你进入VIP支持QQ群。客服联系方式：QQ 1251654593 ，或者直接联系作者QQ 753610399 （回复可能没有客服及时）。详细请参考文档: ","TfJX::当前不是App逻辑层",'(function(){\n\t\tif(!window.RecordApp){ window["console"].error("renderjs中未import导入RecordApp"); return; }\n\t\tvar wvCid="',"newBuffers","=window.","undefined","RecordApp.","xYRb::当前RecordApp运行在逻辑层中（性能会略低一些，可视化等插件不可用）","RecorderNativePlugin",'RecordApp.Start(set,function(){\n\t\t\tstartFn&&startFn.call(This);\n\t\t\tRecordApp.UniWebViewSendToMain({action:"',"kE91::renderjs中的mounted内需要调用RecordApp.UniRenderjsRegister才能调用RecordApp.UniWebViewSendBigBytesToMain","9183050kYRtQd","MTdp::未开始录音，但收到renderjs回传的onRecEncodeChunk","__StopOnlyClearMsg",'(function(){\n\t\t\tvar err="",val={action:"',"j15C::已获得iOS原生录音权限","__FabE","UniWebViewEval","pageShow","fullPath","value","Platforms","status","6276tIOEaT","android",'\n\t\t\t\tvar cls="',"sWvCid",';\n\t\t\tvar errFn=function(errMsg){\n\t\t\t\tRecordApp.UniWebViewSendToMain({action:"',"onerror","indexOf","android.permission.RECORD_AUDIO","H6cq::无法调用Stop：","nativeSampleRateTarget","b64","UniMainTakeBigBytes",';\r\n\t\t\tRecordApp.Current=null; //需先重置，不然native变化后install不一致\n\t\t\tRecordApp.RequestPermission(function(){\n\t\t\t\tRecordApp.UniWebViewSendToMain({action:"',"CanProcess","2060fqGwsm",'",errMsg:errMsg});\n\t\t});',"fields","bigBytes_chunk","||{memory:new Uint8Array(","action","0JQw::plus.android请求录音权限出错：","nativeSampleRateRecSet","disableEnvInFix","__uniAppWebViewId","RecordApp__uniAppMainReceive","WpKg::RecordApp.UniWebViewActivate 已切换当前页面或组件的renderjs所在的WebView","(function(){\n\t\t\t\tvar BigBytes=window.","RecApp Main","XSYY::当前录音由原生录音插件提供支持","_appStart","__xYRb","__UniMainReceiveBigBytes","onProcess_renderjs","PUBLIC_DOWNLOADS","__uniAppReqComponentId","onwrite","arraybuffer","UniMainCallBack","start_renderjs","buffer","getWebviewById","TGMm::提供的RecordApp.UniNativeUtsPlugin值不是RecordApp的uts原生录音插件","$scope",'"@/uni_modules/Recorder-UniCore/',"parentNode","UniFindCanvas","AllStart_Clean","Bjx9::无法调用Start：","setStorageSync","$root","appendChild","height","__uniNP","style","miniProgram-wx","getSystemInfoSync","(function(){\n\t\t\tvar stopFn=","var set=","RecorderUtsPlugin","nativePlugin","GwCz::RecordApp.UniWebViewActivate 需要传入当前页面或组件的this对象作为参数","byzO::未开始录音，但收到UniNativeUtsPlugin PCM数据",'),mOffset:0};\n\t\t\tvar buf=new Uint8Array(RecordApp.UniAtob("',"select","recordStart","AVAudioSession","subarray",");\n\t})()","requireNativePlugin","recEncodeChunk","__Rec","UniWebViewActivate","el2","lU1W::当前不是App逻辑层","srcSampleRate","jsCall","getAttribute","exec","subscribe","BjGP::未开始录音，但收到Uni Native PCM数据","createSelectorQuery","stop_renderjs","的商用授权","bigBytes_start","AGd7::需要先调用RecordApp.UniWebViewActivate方法","TPhg::不应当出现的非H5录音Stop","recSet_bit",";\n\t\tvar startFn=","0FGq::未开始录音，不可以调用{1}","118731lqCFoi","takeoffEncodeChunk",'RecordApp.UniNativeRecordReceivePCM("',"dataId","UniApp-Main","11RvLazV","unknown","Ruxl::plus.android请求录音权限：无权限","mainID","denied ","node",'",ok:1};\n\t\t\tif(!err && !window.RecordApp){\n\t\t\t\terr=',"UniSaveLocalFile","2079459LTrVAx","ownerId","Uc9E::RecordApp.UniRenderjsRegister 发生不应该出现的错误（可能需要升级插件代码）：","_X3Ij_alive","ipB3::RecordApp.UniWebViewActivate 发生不应该出现的错误（可能需要升级插件代码）：","deleteObject","ksoA::无法调用RequestPermission：","Rec_WvCid","show","wvCid","$page","rec","__UniData","在uni-app中编译到App平台时仅供测试用，不可用于正式发布或商用，正式发布或商用需先联系作者获得授权许可（编译到其他平台时无此授权限制，比如：H5、小程序，均为免费授权）。本对话框仅在第一次请求录音权限时会弹出一次，如何去除本弹框、如何获取商用授权、更多信息请看控制台日志","=el2;\n\t\t\t","max","requestRecordPermission","@act",";\n\t\t\tvar clear=","__UniWvCid","gomD::不应该出现的renderjs发回的文件数据丢失",';\n\t\t\t}\n\t\t\tif(err){\n\t\t\t\tval.ok=0; val.errMsg=err;\n\t\t\t}\n\t\t\tUniViewJSBridge.publishHandler("',"sampleRate",'",ok:1,recSet_sr:recSet.sampleRate,recSet_bit:recSet.bitRate,dataId:dataId,duration:duration,mime:mime});\n\t\t\t\t},errFn);\n\t\t\t},errFn);\n\t\t})()',"__Sync","VsdN::需重新调用RecordApp.RequestPermission方法","XCMU::需先调用RecordApp.UniWebViewActivate，然后才可以调用Start","276ZePydw","l7WP::用户拒绝了录音权限","test","requestPermissions","Pause","Start","MujG::只允许在renderjs中调用RecordApp.UniWebViewSendBigBytesToMain","uts","nativeToRjs","sharedInstance","2nlUyJq","granted","slice",'",vm=RecordApp.__uniWvCallVm;\n\t\tif(!vm || RecordApp.__uniWvCallWvCid!=wvCid){\n\t\t\tif(!RecordApp.__UniData[wvCid]){ RecordApp.CLog("renderjs中的mounted内需要调用RecordApp.UniRenderjsRegister",1); return; }\n\t\t\tvar el=document.querySelector("[rec_wv_cid_key=\'"+wvCid+"\']");\n\t\t\tvm=el&&el.__rModule;\n\t\t\tif(!vm){ RecordApp.CLog("没有找到组件的renderjs模块 WvCid="+wvCid,1); return; }\n\t\t\tRecordApp.__uniWvCallVm=vm;\n\t\t\tRecordApp.__uniWvCallWvCid=wvCid;\n\t\t}; (function(){ var This=this;\n\t\t\t',"RecApp Renderjs","memory","7ot0::需先调用RecordApp.RequestPermission方法","showModal","UniAppUseNative","unsubscribe","__hasWvActivate","pcm_sum","Y3rC::正在调用plus.ios@AVAudioSession请求iOS原生录音权限","length","action=","$getAppWebview","recSet_sr","writeAsBinary","UniWithoutAppRenderjs","stop","$el","_$id",'",errMsg:errMsg});\n\t\t\t};\n\t\t\tRecordApp.Stop(clear?null:function(arrBuf,duration,mime){\n\t\t\t\tstopFn&&stopFn.apply(This,arguments);\n\t\t\t\tvar recSet=RecordApp.__Rec.set,t1=Date.now();\n\t\t\t\tRecordApp.CLog("开始传输"+arrBuf.byteLength+"字节的数据回逻辑层，可能会比较慢，推荐使用takeoffEncodeChunk实时获取音频文件数据可避免Stop时产生超大数据回传");\n\t\t\t\tRecordApp.UniWebViewSendBigBytesToMain(arrBuf,function(dataId){//数据可能很大\n\t\t\t\t\tRecordApp.CLog("完成传输"+arrBuf.byteLength+"字节的数据回逻辑层，耗时"+(Date.now()-t1)+"ms");\n\t\t\t\t\tRecordApp.UniWebViewSendToMain({action:"',"createWriter","recProcess","UqfI::保存文件{1}失败：","importClass","isUserNotAllow","UniWebViewSendToMain","recordPermission","__uniAppWebView","Resume","peIm::当前还未调用过RecordApp.UniWebViewActivate","evalJS","S3eF::未找到当前页面renderjs所在的WebView，如果确实没有renderjs，请设置RecordApp.UniWithoutAppRenderjs=true","TtoS::，不可以调用RecordApp.UniWebViewVueCall","0hyi::当前RecordApp运行在renderjs所在的WebView中（逻辑层中只能做有限的实时处理，可视化等插件均需要在renderjs中进行调用）","0caE::用户拒绝了录音权限","YP4V::未开始录音","(function(){\n\t\t\tRecordApp.UniAppUseNative=","__uniAppComponentId","Incorrect sync status","在uni-app中编译到App平台时仅供测试用（App平台包括：Android App、iOS App），不可用于正式发布或商用，正式发布或商用需先联系作者获取到商用授权许可（编译到其他平台时无此授权限制，比如：H5、小程序，均为免费授权）。未获得授权时，在App打开后第一次调用RecordApp.RequestPermission请求录音权限时，会先弹出商用授权提示框；获取到授权许可后，请在调用RequestPermission前设置 RecordApp.UniAppUseLicense='","webview","6Iql::未找到此页面renderjs所在的WebView Cid","yI24::RecordApp.UniFindCanvas未适配当前环境","RXs7::微信小程序中需要：{1}","!id || !cid","rSLO::不应当出现的非H5录音Start","android_audioSource","mSbR::当前还未调用过RecordApp.UniWebViewActivate","Key","ZHwv::[MainReceive]从renderjs发回未知数据：","none","getFile","type","igw2::，不可以调用RecordApp.UniWebViewEval","7kJS::RecordApp.UniRenderjsRegister 已注册当前页面renderjs模块","\n\t\t}).call(vm);\n\t})()","Stop",'",ok:1});\n\t\t},function(errMsg){\n\t\t\tRecordApp.UniWebViewSendToMain({action:"',"display","SCW9::配置了RecordApp.UniNativeUtsPlugin，但当前App未打包进原生录音插件[{1}]","__rModule","success",'";\n\t\t\t\tvar els=this.$ownerInstance.$el.querySelectorAll(cls+" canvas"),el=els[0],el2=els[1];\n\t\t\t\tif(!el){\n\t\t\t\t\tRecordApp.CLog(Recorder.i18n.$T("dzX0::未找到Canvas：{1}，请确保此DOM已挂载（可尝试用$nextTick等待DOM更新）",0,cls),1);\n\t\t\t\t}else if(!el2){\n\t\t\t\t\tel.style.display="none";\n\t\t\t\t\tel2=document.createElement("canvas");\n\t\t\t\t\tel2.setAttribute("el2","1"); el2.style.width=el2.style.height="100%";\n\t\t\t\t\tel.parentNode.appendChild(el2);\n\t\t\t\t}else if(!el2.getAttribute("el2")){\n\t\t\t\t\tel2=el;\n\t\t\t\t}\n\t\t\t\tvar canvas',"createElement"],function(){var n=g;!function(e,t){for(var n=g,r=T();;)try{if(440219==parseInt(n(649))/1*(parseInt(n(699))/2)+-parseInt(n(407))/3*(parseInt(n(560))/4)+parseInt(n(574))/5*(parseInt(n(689))/6)+parseInt(n(501))/7+-parseInt(n(468))/8+parseInt(n(662))/9+-parseInt(n(548))/10*(-parseInt(n(654))/11))break;r.push(r.shift())}catch(a){r.push(r.shift())}}();var m={Support:function(e){var t=g;return c?void(!a||s[t(339)]?e(!0):e(!1)):(i(r(t(406)),3),void e(!1))},CanProcess:function(){return!0}};s[n(461)](n(a?421:653),m),c&&(i[n(432)]=n(a?335:587)),s[n(674)]||(s[n(674)]={id:0,pageShow:{}});var v=function(){return c&&!a&&!s[n(349)]};function g(e,t){var n=T();return(g=function(e,t){return n[e-=335]})(e,t)}s[n(470)]=function(e){var t=n,r=s[t(674)][t(555)]={};if(v()){r[t(563)]=b(e);var a=s[t(583)];if(a){for(var i=getCurrentPages(),o=!0,l=0,c=i[t(344)];l<c;l++)if(i[l][t(672)].id==a){o=!1;break}o&&(s[t(371)]=null,s[t(583)]=null,s[t(361)]=null)}}},s[n(631)]=function(e){var t=n;if(v()){s[t(341)]=!0,s[t(414)]=1,setTimeout((function(){s[t(414)]=0}));var a=e[t(609)];if(a&&a[t(602)]&&a[t(602)][t(346)]){var o=e[t(352)]||e.$&&e.$[t(455)],l=y(e);l&&o?(o==s[t(371)]&&l==s[t(583)]||i(r(t(585))+t(399)+l+t(438)+o),s[t(371)]=o,s[t(583)]!=l&&(s[t(583)]=l,s[t(361)]=a[t(602)][t(346)]())):i(r(t(666))+t(378),1)}else i(r(t(620)),1)}},s[n(497)]=function(e){var t=n;if(c&&a){if(e[t(482)])var o=window[t(518)],l=e[t(352)]||e[t(482)][t(424)][t(663)],u=e[t(482)][t(351)];if(u)if(u[t(394)]=e,o&&l){var p=t(517)+o+t(438)+l;s[t(681)]=p,u[t(465)](t(525),p),s[t(674)][p]?i(r(t(507))+t(474)+p,3):(s[t(674)][p]=1,i(r(t(388))+t(512)+p))}else i(r(t(664))+t(378),1);else i(r(t(423)),1)}};var b=function(e,t,r){var a=n;if(e){if(e[a(669)])return e[a(669)];var i=y(e),o=e[a(352)]||e.$&&e.$[a(455)]}return t&&(r||S(),a(453)==t?(i=s[a(484)],o=s[a(594)]):(i=s[a(583)],o=s[a(371)])),i&&o?a(517)+i+a(438)+o:""},w=function(e){var t=n;return t(679)===e||t(453)===e?{Rec_WvCid:b(null,e)}:{Rec_WvCid:e||"?"}},y=function(e){var t=n,r=e[t(609)];return(r=r&&r[t(672)])&&r.id||0},S=function(e){var t=n;if(!s[t(361)])return r(t(644));var a=b(null,1,1),o=s[t(674)][t(555)][t(563)];if(e){if(!s[t(484)])return r(t(337));if(b(null,t(453),1)!=a)return r(t(687))}return o&&o!=a&&i(r(t(483),0,o,a),3),""};s[n(554)]=function(e,t,a){var o=n,l="";l||p||(l=r(o(538)));var c=!l&&function(e,t){var n=o;if(e&&e[n(669)])var r=/^wv_(\d+)_/[n(637)](e[n(669)]),a=r&&r[1];else{var i=e&&e[n(609)],l=i&&i[n(602)];a=(i=i&&i[n(672)])&&i.id}if(a){if(a==s[n(583)])return s[n(361)];if(l)return l[n(346)]();var c=plus[n(374)][n(600)](a);if(c)return c}return t?(S(),s[n(361)]):null}(e,null==e);if(l||c||(l=r(o(null==e?363:513))),l)return l+=r(o(387)),i(l+o(401)+t[o(439)](0,200),1),l;var u=s[o(674)][o(555)];if(u[o(505)]||(u[o(505)]=1,k()),a){var f=("a"+Math[o(413)]())[o(514)](".",""),h=0,_=function(){var e=o;if(0!=h&&h>=a[e(457)])c[e(364)](e(586)+f+e(528)+f+e(469)+t+e(422));else{var n=s[e(597)](_),r=h;h+=524288;var i=a[e(701)](r,h);c[e(364)](e(530)+f+e(541)+f+e(578)+a[e(457)]+e(622)+d(i)+e(418)+n+e(491))}};_()}else c[o(364)](t)},s[n(441)]=function(e,t,a){var o=n,l="";l||p||(l=r(o(633)));var c=!l&&b(e,null==e);if(l||c||(l=r(o(null==e?381:375))),l)return l+=r(o(366)),i(l+o(401)+t[o(439)](0,200),1),l;s[o(554)](e,o(539)+c+o(702)+t+o(389),a)};var R=n(584),k=function(){var e=n;if(p&&e(542)!=typeof UniServiceJSBridge){var t=s[e(499)];if(t){var a="";try{a=uni[e(458)](R)}catch(o){}if(t==a)return;i(r(e(504)),3)}t="r"+Math[e(413)]();try{uni[e(608)](R,t)}catch(o){}s[e(499)]=t,UniServiceJSBridge[e(340)](R),UniServiceJSBridge[e(638)](R,(function(t){var n=e,a=t[n(579)]||"";if(n(355)!=a)if(n(629)!=a)if(-1==a[n(566)](n(520)))-1==a[n(566)](n(480))?i(r(n(383))+JSON[n(405)](t),1):s[n(591)](t);else{var o=s[n(674)][a];o&&o(t)}else P(t);else N(t)}))}};s[n(597)]=function(e){var t=n,r=s[t(674)],a=++r.id,i=t(520)+a;return r[i]=function(t){delete r[i],e(t)},i},s[n(359)]=function(e){UniViewJSBridge[n(444)](R,e)},s[n(498)]=function(e,t,i){var o=n;if(a&&c){var l=s[o(681)];if(l){var u=s[o(674)],p=0,f=++u.id;u[o(480)+f]=function(e){p=e,_()};var h=0,_=function(){var n=o;if(0!=h&&h>=e[n(457)])return delete u[n(480)+f],void t(p);var r=h;h+=524288;var a=e[n(701)](r,h);s[n(359)]({action:n(r?577:643),wvCid:l,wvID:f,mainID:p,b64:d(a)})};_()}else i(r(o(547)))}else i(r(o(695)))},s[n(591)]=function(e){var t=n,a=e[t(657)],o=s[t(674)],l=t(480);t(643)==e[t(579)]&&(a=++o.id,o[l+a]={memory:new Uint8Array(2097152),mOffset:0});var c=o[l+a];if(c){var u=new Uint8Array(f(e[t(570)])),p=u[t(344)];if(c[t(417)]+p>c[t(336)][t(344)]){var d=new Uint8Array(c[t(336)][t(344)]+Math[t(677)](2097152,p));d[t(440)](c[t(336)][t(626)](0,c[t(417)])),c[t(336)]=d}c[t(336)][t(440)](u,c[t(417)]),c[t(417)]+=p,s[t(554)](w(e[t(671)]),t(427)+l+e[t(408)]+t(519)+a+t(627))}else i(r(t(403)),3)},s[n(571)]=function(e){var t=n;if(!p)return null;var r=s[t(674)],a=r[t(480)+e];return delete r[t(480)+e],a?a[t(336)][t(599)][t(701)](0,a[t(417)]):null},s[n(661)]=function(e,t,a,s){var i=n;if(a=a||o,s=s||o,c){var l=function(t){var n=g;s(r(n(356),0,e)+t[n(445)])};plus.io[i(464)](plus.io[i(593)],(function(n){var r=i;n[r(428)][r(385)](e,{create:!0},(function(e){var n=r;e[n(354)]((function(r){var s=n;r[s(595)]=function(){a(e[s(556)])},r[s(565)]=l;try{r[s(348)](d(t))}catch(i){l(i)}}),l)}),l)}),l)}else s(r(i(489)))};var A=function(t){var o=n;if(s[o(531)]){var l="";!l&&a&&(l=r(o(426))),!l&&s[o(531)][o(619)]?(x(),s[o(612)]||(l=r(o(393),0,C))):l||s[o(531)][o(462)]||(l=r(o(601))),l&&(s[o(531)]=null,i(l,1)),s[o(494)]=l}if(p){var c=r(o(419),0,e),u=s[o(531)];u&&(!t&&s[o(459)]||(s[o(459)]=1,u[o(619)]?i(r(o(588))+c):i(r(o(524))+c))),s[o(349)]?u?!t&&s[o(590)]||(s[o(590)]=1,i(r(o(544))+c)):i(r(o(437))+c,1):s[o(341)]&&(s[o(361)]?!t&&s[o(429)]||(s[o(429)]=1,i(r(o(367))+c)):i(r(o(365))+c,1))}};function T(){var e=h;return(T=function(){return e})()}s[n(605)]=function(e,t,a,o){var l,c,u=n;if(p){var d=[];for(l=0,c=t[u(344)];l<c;l++)d[u(493)](u(562)+t[l]+u(396)+(l+1)+u(676));return d[u(493)](a),void s[u(441)](e,d[u(404)]("\n"))}i(r(u(376)),1)};var x=function(){var e=n;if(!s[e(612)]){C=s[e(531)][e(515)]||e(545);try{s[e(612)]=uni[e(628)](C)}catch(t){}}},C="*",E=function(){var e=n,t=s[e(531)],a=t&&t[e(619)]?C:e(618);M(e(635),{},null,null,(function(t){var n=e;n(415)==t[n(579)]?t[n(490)]?i("["+a+"]["+t[n(416)]+"]"+t[n(445)],1):i("["+a+"]["+t[n(416)]+"]"+t[n(445)]):n(425)==t[n(579)]?s[n(398)](t[n(442)],t[n(684)]):i(r(n(495),0,a)+n(345)+t[n(579)],3)}))},M=function(e,t,a,i,o){var l=n,c=s[l(531)];if(c){var u={action:e,args:t||{}};o||(o=function(e){var t=l;t(395)==e[t(559)]?a&&a(e[t(557)],e):i&&i(e[t(445)])}),c[l(619)]?s[l(612)][l(462)](u,o):c[l(462)](u,o)}else{var p=s[l(494)]||r(l(400));i&&i(p)}};m[n(443)]=function(e,t){A(),e()},m[n(693)]=function(){return B(n(693))},m[n(362)]=function(){return B(n(362))};var B=function(e){var t=n;if(!v())return!1;var a=j[t(673)];if(a){var o=S(1);o?i(o,1):s[t(554)](w(a[t(463)]),t(543)+e+"()")}else i(r(t(648),0,e),3)};m[n(481)]=function(t,a,o){var c=n,u=j[c(673)];j[c(673)]=null,u&&v()&&s[c(554)](w(u[c(463)]),c(473)),!v()||s[c(414)]?(s[c(484)]=s[c(583)],s[c(594)]=s[c(371)],A(!0),function(t){var n=c;if(!p)return t();var a=s[n(553)]=s[n(553)]||{},o=function(e,a,s){i(r(n(511),0,l)+e,a||0),s||t()},u=s[n(531)];if(u||a[n(696)])return a[n(696)]=a[n(696)]||(u[n(619)]?2:1),2==a[n(696)]?o(r(n(487))):o(r(n(436)));var d=n(460)+(a[n(516)]=a[n(516)]||uni[n(615)]()[n(516)]||"0")+n(642);if(s[n(510)]){if(s[n(510)]==d)return o(d);i(r(n(472),0,d),3)}var f=function(t){var r=n;o(r(430)+l+r(373)+d+r(537)+e+" ",3,t)};if(a[n(670)])return f();f(1),a[n(670)]=1,uni[n(338)]({title:n(533),content:"文件"+l+n(675),showCancel:!1,confirmText:n(485),complete:function(){t()}})}((function(){V(t,a,o)}))):o(r(c(452)))};var V=function(e,t,o){var c=n;if(a)return s[c(339)]?void t():void o(r(c(454)));var p=function(e){var t=c;if(u){i(r(t(343)));var n=function(){var a=t;if(s[a(446)])e();else{var l=plus[a(529)][a(357)](a(625))[a(698)](),c=l[a(360)]();1970168948==c?l[a(678)](n):1735552628==c?(i(r(a(552))),e()):(i(r(a(450))+a(658)+c,1),o(r(a(368)),!0)),plus[a(529)][a(667)](l)}};n()}else i(r(t(447))),plus[t(561)][t(692)]([t(567)],(function(n){var a=t;0<n[a(700)][a(344)]?(i(r(a(496))+JSON[a(405)](n)),e()):(i(r(a(656)),1,n),o(r(a(690)),!0))}),(function(e){var n=t;i(r(n(580))+e[n(445)],1,e),o(r(n(435))+e[n(445)])}))},d=function(e){var t=c;E(),M(t(360),{},e,o)};if(s[c(349)])p((function(){d(t)}));else{var f=w(c(453)),h=function(e){var t=c,n=S(1);if(n)o(r(t(668))+n);else{var a=s[t(597)]((function(n){var r=t;n.ok?e():o(n[r(527)])}));s[t(554)](f,t(551)+a+t(660)+JSON[t(405)](r(t(502)))+t(467)+JSON[t(405)](r(t(410),0,t(603)+l+'"'))+t(683)+R+t(522))}},_=function(n){var r=c;if(s[r(686)](e)){var a=s[r(597)]((function(e){var n=r;e.ok?t():o(e[n(527)],e[n(358)])}));s[r(554)](f,r(370)+!!n+r(572)+a+r(521)+a+r(492))}else o(r(372))};s[c(531)]?h((function(){p((function(){d((function(){_(!0)}))}))})):h((function(){p((function(){_()}))}))}};m[n(694)]=function(e,i,o,l){var c=n,p=j[c(673)];if(j[c(673)]=null,p&&v()&&s[c(554)](w(p[c(463)]),c(473)),!v()||s[c(414)]){j[c(449)]=i;var d=t(i);if(d[c(440)][c(582)]=!0,d[c(535)]=c(596),j[c(697)]=!1,j[c(673)]=d,s[c(630)]=d,a)return s[c(339)]?void o():void l(r(c(379)));var f=function(e){var t=c,n=JSON[t(433)](JSON[t(405)](h));n[t(569)]=n[t(569)]||48e3,n[t(581)]=n[t(684)],n[t(684)]=n[t(569)],u||null!=n[t(380)]||(n[t(380)]=s[t(477)]||"1"),E(),M(t(624),n,(function(){var n=t;s[n(665)]=setInterval((function(){M(n(451),{},(function(){}))}),5e3),e()}),l)};clearInterval(s[c(665)]);var h={};for(var _ in i)/_renderjs$/[c(691)](_)||(h[_]=i[_]);if(h=JSON[c(433)](JSON[c(405)](h)),s[c(349)])f(o);else{d[c(440)][c(386)]=c(655);var m=function(e,t){var n=c,a=S(1);if(a)l(r(n(607))+a);else{d[n(463)]=b(null,n(453)),j[n(697)]=t;var o=[n(617)+JSON[n(405)](h)+";"];o[n(493)](n(486)+(i[n(592)]||0)+n(647)+(i[n(598)]||0)+n(409)),(i[n(650)]||i[n(471)])&&o[n(493)](n(478)+(i[n(471)]||0)+n(456));var u=s[n(597)]((function(t){var r=n;t.ok?e():l(t[r(527)])}));o[n(493)](n(546)+u+n(391)+u+n(575)),s[n(441)](w(d[n(463)]),o[n(404)]("\n"))}};s[c(531)]?m((function(){var t=c;s[t(686)](e)?f(o):l(t(372))}),!0):m(o)}}else l(r(c(688)))},m[n(509)]=function(e){return!!v()&&""},m[n(606)]=function(e){var t=n;if(!v())for(var r in e)/_renderjs$/[t(691)](r)&&delete e[r]};var N=function(e){var t=n,r=j[t(673)];r&&(r[t(440)][t(684)]=e[t(347)],r[t(440)][t(488)]=e[t(646)]);for(var a=e[t(540)],s=0,i=a[t(344)];s<i;s++)j(a[s],e[t(684)])},P=function(e){var t=n,a=j[t(673)];if(a){var s=new Uint8Array(f(e[t(534)]));a[t(440)][t(650)]&&a[t(440)][t(650)](s)}else i(r(t(549)),3)},j=function(e,t){var a=n,s=j[a(673)];if(s){if(s[a(589)]||s[a(479)]({envName:m[a(382)],canProcess:m[a(573)]()},t),s[a(589)]=1,e instanceof Int16Array)var o=new Int16Array(e);else o=new Int16Array(f(e));var l=_[a(342)](o);s[a(500)](o,l)}else i(r(a(639)),3)};s[n(398)]=function(e,t){var a=n;if(j[a(697)]){var o=j[a(673)];return o?void s[a(554)](w(o[a(463)]),a(651)+e+'",'+t+")"):void i(r(a(621)),3)}j(e,t)},m[n(390)]=function(e,t,o){var l=n,c=function(t){var n=g;s[n(686)](e)&&(j[n(673)]=null,u&&p&&v()&&s[n(554)](w(u[n(463)]),n(473))),o(t)},u=j[l(673)],p=!0,d=t?"":s[l(550)](),f=function(){var n=l;if(s[n(686)](e))if(j[n(673)]=null,u){if(i(n(434)+u[n(523)]+n(420)+u[n(634)]+n(402)+JSON[n(405)](j[n(449)])),!t)return h(),void c(d);u[n(350)]((function(e,n,r){h(),t(e,n,r)}),(function(e){h(),c(e)}))}else c(r(n(369))+(d?" ("+d+")":""));else c(n(372))},h=function(){var t=l;if(s[t(686)](e))for(var n in j[t(673)]=null,u[t(440)])j[t(449)][n]=u[t(440)][n]};if(a)return s[l(339)]?void f():void c(r(l(645)));var _=function(e){M(l(448),{},e,c)};if(clearInterval(s[l(665)]),s[l(349)])_(f);else{var m=function(e){var n=l;if(u){var a=S(1);if(a)c(r(n(568))+a);else{var i=s[n(597)]((function(e){var a=n;if(p=!1,e.ok){u[a(440)][a(386)]=j[a(449)][a(386)],u[a(440)][a(684)]=e[a(347)],u[a(440)][a(488)]=e[a(646)],h();var i=s[a(571)](e[a(652)]);i?t(i,e[a(475)],e[a(506)]):c(r(a(682)))}else c(e[a(527)])})),o=n(616)+(t&&j[n(449)][n(641)]||0)+n(680)+!t+n(564)+i+n(353)+i+n(685);s[n(441)](w(u[n(463)]),o)}}else c(r(n(532))+(d?" ("+d+")":""))};s[l(531)]?_((function(){var t=l;s[t(686)](e)?m():c(t(372))})):m()}}}()}(r,s,0,s.i18n.$T,t)}else a("error","at uni_modules/Recorder-UniCore/app-uni-support.js:36","需要先引入RecordApp，请按下面代码引入：\n1. 项目根目录 npm install recorder-core\n2. 页面中按顺序import\nimport Recorder from 'recorder-core'\nimport RecordApp from 'recorder-core/src/app-support/app.js'\nimport 你需要的音频格式编码器、可视化插件\n参考文档："+r)}();const w=e=>{(e.$renderjs||(e.$renderjs=[])).push("testMainVue"),(e.$renderjsModules||(e.$renderjsModules={})).testMainVue="3bcf15e4"};const y={components:{TestPlayer:d},data:()=>({recType:"mp3",recSampleRate:16e3,recBitRate:16,takeoffEncodeChunkSet:!1,takeoffEncodeChunkMsg:"",appUseH5Rec:!1,recwaveChoiceKey:"WaveView",recpowerx:0,recpowert:"",pageDeep:0,pageNewPath:"main_recTest",disableOgg:false,evalExecCode:"",reclogs:[]}),mounted(){var e=[],t="undefined"!=typeof Vue&&Vue&&Vue.version;t&&e.push("Vue.version:"+t);var n=(((this.$||{}).appContext||{}).app||{}).version;n&&e.push("appContext.app.version:"+n);var r=(((this.$root||{}).constructor||{}).super||{}).version;r&&e.push("constructor.super:"+r),this.reclog("页面mounted("+getCurrentPages().length+"层)，Vue="+e.join("/")+"，WebViewId="+(this.$root.$page&&this.$root.$page.id||"?")+"，ComponentId=_$id:"+(this._$id||"?")+"/$.uid:"+(this.$&&this.$.uid||"?")+"，Recorder.LM="+v.LM+"，RecordApp.LM="+b.LM+"，UniSupportLM="+b.UniSupportLM+"，UniJsSource="+b.UniJsSource.IsSource),this.pageDeep=getCurrentPages().length,this.pageNewPath=/main_recTest/.test(this.getRouteStr())?"page_index2":"main_recTest",this.isMounted=!0,this.uniPage__onShow(),this.reclog("正在执行Install，请勿操作...","#f60"),b.UniNativeUtsPlugin=null,b.Install((()=>{this.reclog("Install成功，环境："+this.currentKeyTag(),2),this.reclog("请先请求录音权限，然后再开始录音")}),(e=>{this.reclog("RecordApp.Install出错："+e,1)}))},unmounted(){b.Stop()},onShow(){this.isMounted&&this.uniPage__onShow()},methods:{uniPage__onShow(){b.UniPageOnShow(this)},currentKeyTag(){if(!b.Current)return"[?]";var e="Renderjs+H5";return b.UniNativeUtsPlugin&&(e=b.UniNativeUtsPlugin.nativePlugin?"NativePlugin":"UtsPlugin"),b.Current.Key+"("+e+")"},recReq(){b.UniNativeUtsPlugin=null,this.appUseH5Rec&&(b.UniNativeUtsPlugin=null),b.UniIsApp()&&!b.UniNativeUtsPlugin&&this.reclog("当前是在App的renderjs中使用H5进行录音，iOS上只支持14.3以上版本，且iOS上每次进入页面后第一次请求录音权限时、或长时间无操作再请求录音权限时WebView均会弹出录音权限对话框，不同旧iOS版本（低于iOS17）下H5录音可能存在的问题在App中同样会存在；使用配套的原生录音插件或uts插件时无以上问题和版本限制，Android也无以上问题","#f60"),this.reclog("正在请求录音权限..."),b.UniWebViewActivate(this),b.RequestPermission((()=>{this.reclog(this.currentKeyTag()+" 已获得录音权限，可以开始录音了",2)}),((e,t)=>{this.reclog(this.currentKeyTag()+" "+(t?"isUserNotAllow,":"")+"请求录音权限失败："+e,1)}))},recStart(){this.$refs.player.setPlayBytes(null),this.takeoffEncodeChunkMsg="";var e=0,t=0;this.takeEcChunks=this.takeoffEncodeChunkSet?[]:null,this.reclog(this.currentKeyTag()+" 正在打开..."),b.UniWebViewActivate(this),b.Start({type:this.recType,sampleRate:this.recSampleRate,bitRate:this.recBitRate,onProcess:(e,t,n,r,a,s)=>{this.recpowerx=t,this.recpowert=this.formatTime(n,1)+" / "+t},onProcess_renderjs:"function(buffers,powerLevel,duration,sampleRate,newBufferIdx,asyncEnd){\n\t\t\t\t\t//App中在这里修改buffers才会改变生成的音频文件\n\t\t\t\t\t//App中是在renderjs中进行的可视化图形绘制，因此需要写在这里，this是renderjs模块的this（也可以用This变量）；如果代码比较复杂，请直接在renderjs的methods里面放个方法xxxFunc，这里直接使用this.xxxFunc(args)进行调用\n\t\t\t\t\tvar wave=this.waveStore&&this.waveStore[this.recwaveChoiceKey];\n\t\t\t\t\tif(wave){\n\t\t\t\t\t\twave.input(buffers[buffers.length-1],powerLevel,sampleRate);\n\t\t\t\t\t}\n\t\t\t\t}",takeoffEncodeChunk:this.takeoffEncodeChunkSet?n=>{e++,t+=n.byteLength,this.takeoffEncodeChunkMsg="已接收到"+e+"块，共"+t+"字节",this.takeEcChunks.push(n)}:null,takeoffEncodeChunk_renderjs:this.takeoffEncodeChunkSet?"function(chunkBytes){\n\t\t\t\t\t//App中这里可以做一些仅在renderjs中才生效的事情，不提供也行，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t}":null,start_renderjs:"function(){\n\t\t\t\t\t//App中可以放一个函数，在Start成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t\t//放一些仅在renderjs中才生效的事情，比如初始化，不提供也行\n\t\t\t\t}",stop_renderjs:"function(aBuf,duration,mime){\n\t\t\t\t\t//App中可以放一个函数，在Stop成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t\tthis.audioData=aBuf; //留着给Stop时进行转码成wav播放\n\t\t\t\t}"},(()=>{this.reclog(this.currentKeyTag()+" 录制中："+this.recType+" "+this.recSampleRate+" "+this.recBitRate+"kbps"+(this.takeoffEncodeChunkSet?" takeoffEncodeChunk":"")+(this.appUseH5Rec?" appUseH5Rec":""),2),this.initWaveStore()}),(e=>{this.reclog(this.currentKeyTag()+" 开始录音失败："+e,1)}))},recPause(){b.GetCurrentRecOrNull()&&(b.Pause(),this.reclog("已暂停"))},recResume(){b.GetCurrentRecOrNull()&&(b.Resume(),this.reclog("继续录音中..."))},recStopX(){b.Stop(null,(e=>{this.reclog("已清理，错误信息："+e)}))},recStop(){this.reclog("正在结束录音..."),b.Stop(((e,t,n)=>{var r=(b.GetCurrentRecOrNull()||{set:{type:this.recType}}).set;this.reclog("已录制["+n+"]："+this.formatTime(t,1)+" "+e.byteLength+"字节 "+r.sampleRate+"hz "+r.bitRate+"kbps",2);var a="this.audioData";if(this.takeEcChunks){a="",this.reclog("启用takeoffEncodeChunk后Stop返回的blob长度为0不提供音频数据");for(var s=0,i=0;i<this.takeEcChunks.length;i++)s+=this.takeEcChunks[i].length;for(var o=new Uint8Array(s),l=(i=0,0);i<this.takeEcChunks.length;i++){var c=this.takeEcChunks[i];o.set(c,l),l+=c.length}e=o.buffer,this.reclog("takeoffEncodeChunk接收到的音频片段，已合并成一个音频文件 "+e.byteLength+"字节")}this.$refs.player.setPlayBytes(e,a,t,n,r,v)}),(e=>{this.reclog("结束录音失败："+e,1)}))},reclog(e,t){var n=new Date,r="["+(("0"+n.getHours()).substr(-2)+":"+("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2))+"]"+e;a("log","at pages/recTest/main_recTest.vue:471",r),this.reclogs.splice(0,0,{txt:r,color:t})},recTypeClick(e){var t=e.target.dataset.type;t&&(this.recType=t)},appUseH5RecClick(){this.appUseH5Rec=!this.appUseH5Rec,b.Current=null,this.reclog("切换了appUseH5Rec="+this.appUseH5Rec+"，重新请求录音权限后生效","#f60")},initWaveStore(){if(!this.waveStore){var e=this.waveStore=this.waveStore||{},t="var store=this.waveStore=this.waveStore||{};";t+=`this.recwaveChoiceKey="${this.recwaveChoiceKey}";`,b.UniFindCanvas(this,[".recwave-WaveView"],`${t}\n\t\t\t\tstore.WaveView=Recorder.WaveView({compatibleCanvas:canvas1, width:300, height:100});\n\t\t\t`,(t=>{e.WaveView=v.WaveView({compatibleCanvas:t,width:300,height:100})})),b.UniFindCanvas(this,[".recwave-SurferView",".recwave-SurferView-2x"],`${t}\n\t\t\t\tstore.SurferView=Recorder.WaveSurferView({compatibleCanvas:canvas1,compatibleCanvas_2x:canvas2, width:300, height:100});\n\t\t\t`,((t,n)=>{e.SurferView=v.WaveSurferView({compatibleCanvas:t,compatibleCanvas_2x:n,width:300,height:100})})),b.UniFindCanvas(this,[".recwave-Histogram1"],`${t}\n\t\t\t\tstore.Histogram1=Recorder.FrequencyHistogramView({compatibleCanvas:canvas1, width:300, height:100});\n\t\t\t`,(t=>{e.Histogram1=v.FrequencyHistogramView({compatibleCanvas:t,width:300,height:100})})),b.UniFindCanvas(this,[".recwave-Histogram2"],`${t}\n\t\t\t\tstore.Histogram2=Recorder.FrequencyHistogramView({compatibleCanvas:canvas1, width:300, height:100\n\t\t\t\t\t,lineCount:200,widthRatio:1,position:0,minHeight:1\n\t\t\t\t\t,fallDuration:600,stripeEnable:false,mirrorEnable:true});\n\t\t\t`,(t=>{e.Histogram2=v.FrequencyHistogramView({compatibleCanvas:t,width:300,height:100,lineCount:200,widthRatio:1,position:0,minHeight:1,fallDuration:600,stripeEnable:!1,mirrorEnable:!0})})),b.UniFindCanvas(this,[".recwave-Histogram3"],`${t}\n\t\t\t\tstore.Histogram3=Recorder.FrequencyHistogramView({compatibleCanvas:canvas1, width:300, height:100\n\t\t\t\t\t,lineCount:20,position:0,minHeight:1,fallDuration:400,stripeEnable:false,mirrorEnable:true\n\t\t\t\t\t,linear:[0,"#0ac",1,"#0ac"]});\n\t\t\t`,(t=>{e.Histogram3=v.FrequencyHistogramView({compatibleCanvas:t,width:300,height:100,lineCount:20,position:0,minHeight:1,fallDuration:400,stripeEnable:!1,mirrorEnable:!0,linear:[0,"#0ac",1,"#0ac"]})}))}},recwaveChoice(e){var t=e.target.dataset.key;t&&(t!=this.recwaveChoiceKey&&this.reclog("已切换波形显示为："+t),this.recwaveChoiceKey=t,b.UniIsApp()&&b.UniWebViewVueCall(this,'this.recwaveChoiceKey="'+t+'"'))},recEnvIn60(){var e=b.GetCurrentRecOrNull();if(e)if(b.UniIsApp())b.UniWebViewVueCall(this,'\n\t\t\t\t\tvar rec=RecordApp.GetCurrentRecOrNull();\n\t\t\t\t\tvar sampleRate=rec.srcSampleRate,t1=Date.now();\n\t\t\t\t\tvar canon=Recorder.NMN2PCM.GetExamples().Canon.get(sampleRate).pcm;\n\t\t\t\t\tvar len=sampleRate*60,offset=0;\n\t\t\t\t\twhile(offset<len){\n\t\t\t\t\t\trec.envIn(canon.subarray(0,Math.min(canon.length,len-offset)),0);\n\t\t\t\t\t\toffset+=canon.length;\n\t\t\t\t\t}\n\t\t\t\t\tthis.$ownerInstance.callMethod("reclog","已注入60秒Canon简谱生成的音乐，耗时"+(Date.now()-t1)+"ms");\n\t\t\t\t');else{for(var t=e.srcSampleRate,n=Date.now(),r=v.NMN2PCM.GetExamples().Canon.get(t).pcm,a=60*t,s=0;s<a;)e.envIn(r.subarray(0,Math.min(r.length,a-s)),0),s+=r.length;this.reclog("已注入60秒Canon简谱生成的音乐，耗时"+(Date.now()-n)+"ms")}else this.reclog("未开始录音，无法注入",1)},formatTime(e,t){var n=e%1e3,r=(e=(e-n)/1e3)%60,a=(e=(e-r)/60)%60,s=(e=(e-a)/60,"");return e>0&&(s+=(e<10?"0":"")+e+":"),s+=(a<10?"0":"")+a+":",s+=(r<10?"0":"")+r,t&&(s+="″"+("00"+n).substr(-3)),s},getRouteStr(){var e=this.$page&&this.$page.route||this.$root.route;return!e&&this.$root.$scope&&(e=this.$root.$scope.route),"/"+e},reloadPage(){var e=this.getRouteStr();a("log","at pages/recTest/main_recTest.vue:602","刷新页面 url="+e),1==getCurrentPages().length?uni.reLaunch({url:e}):uni.navigateBack({animationDuration:0,success:()=>{setTimeout((()=>{uni.navigateTo({url:e})}),300)}})},evalExecClick(){if(this.evalExecCode)try{new Function("Recorder,RecordApp",this.evalExecCode).call(this,v,b),this.reclog("代码已执行",2)}catch(e){this.reclog("代码执行异常："+e.message,1)}else this.reclog("请填写要执行的代码",1)},loadVConsole(){this.reclog("正在renderjs中加载vConsole..."),b.UniWebViewVueCall(this,'(function(){\n\t\t\t\tvar isApp=true, isH5=false;\n\t\t\t\tvar ok=function(){\n\t\t\t\t\tif(isApp){\n\t\t\t\t\t\tThis.$ownerInstance.callMethod("reclog","vConsole已加载");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tThis.reclog("vConsole已加载");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(window.VConsole)return ok();\n\t\t\t\tvar elem=document.createElement("script");\n\t\t\t\telem.setAttribute("type","text/javascript");\n\t\t\t\telem.setAttribute("src","https://xiangyuecn.gitee.io/recorder/assets/ztest-vconsole.js");\n\t\t\t\tdocument.body.appendChild(elem);\n\t\t\t\telem.onload=function(){\n\t\t\t\t\tnew VConsole(); ok()\n\t\t\t\t};\n\t\t\t})()')}}};w(y);const S=n(y,[["render",function(t,n,r,a,s,i){const o=e.resolveComponent("TestPlayer");return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{style:{padding:"5px 10px 0"}},[e.createElementVNode("text",{style:{"vertical-align":"top"}}),e.createElementVNode("navigator",{url:s.pageNewPath,style:{display:"inline"}},[e.createElementVNode("button",{size:"mini",type:"default"},"新开页面("+e.toDisplayString(s.pageDeep)+")",1)],8,["url"]),e.createElementVNode("navigator",{url:"page_i18n",style:{display:"inline"}},[e.createElementVNode("button",{size:"mini",type:"default"},"国际化多语言")]),e.createElementVNode("navigator",{url:"page_asr",style:{display:"inline"}},[e.createElementVNode("button",{size:"mini",type:"default"},"asr语音识别")]),e.createElementVNode("navigator",{url:"page_nvue",style:{display:"inline"}},[e.createElementVNode("button",{size:"mini",type:"default"},"nvue原生页面")]),e.createElementVNode("navigator",{url:"page_renderjsOnly",style:{display:"inline"}},[e.createElementVNode("button",{size:"mini",type:"default"},"纯renderjs调用")]),e.createElementVNode("button",{size:"mini",type:"default",onClick:n[0]||(n[0]=(...e)=>i.reloadPage&&i.reloadPage(...e))},"刷新当前页")]),e.createElementVNode("view",{style:{"margin-top":"5px",height:"10px",background:"#eee"}}),e.createElementVNode("view",{style:{padding:"10px 10px 0"}},[e.createTextVNode(" 类型： "),e.createElementVNode("checkbox",{onClick:n[1]||(n[1]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"mp3"==s.recType,"data-type":"mp3"},"mp3",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[2]||(n[2]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"wav"==s.recType,"data-type":"wav"},"wav",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[3]||(n[3]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"pcm"==s.recType,"data-type":"pcm"},"pcm",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[4]||(n[4]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"amr"==s.recType,"data-type":"amr"},"amr",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[5]||(n[5]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"g711a"==s.recType,"data-type":"g711a"},"g711a",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[6]||(n[6]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"g711u"==s.recType,"data-type":"g711u"},"g711u",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[7]||(n[7]=(...e)=>i.recTypeClick&&i.recTypeClick(...e)),checked:"ogg"==s.recType,"data-type":"ogg",disabled:s.disableOgg},"ogg"+e.toDisplayString(s.disableOgg?"(js太大)":""),9,["checked","disabled"])]),e.createElementVNode("view",{style:{padding:"10px 10px 0"}},[e.createTextVNode(" 采样率："),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":n[8]||(n[8]=e=>s.recSampleRate=e),style:{width:"60px",display:"inline-block",border:"1px solid #ddd"}},null,512),[[e.vModelText,s.recSampleRate,void 0,{number:!0}]]),e.createTextVNode("hz 比特率："),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":n[9]||(n[9]=e=>s.recBitRate=e),style:{width:"60px",display:"inline-block",border:"1px solid #ddd"}},null,512),[[e.vModelText,s.recBitRate,void 0,{number:!0}]]),e.createTextVNode("kbps ")]),e.createElementVNode("view",{style:{display:"flex","padding-top":"10px"}},[e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{type:"warn",onClick:n[10]||(n[10]=(...e)=>i.recReq&&i.recReq(...e)),style:{"font-size":"16px",padding:"0"}},"请求录音权限")]),e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{type:"primary",onClick:n[11]||(n[11]=(...e)=>i.recStart&&i.recStart(...e)),style:{"font-size":"16px",padding:"0"}},"开始录音")]),e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{onClick:n[12]||(n[12]=(...e)=>i.recStop&&i.recStop(...e)),style:{"font-size":"16px",padding:"0"}},"停止录音")]),e.createElementVNode("view",{style:{width:"10px"}})]),e.createElementVNode("view",{style:{padding:"10px 10px 0"}},[e.createElementVNode("button",{size:"mini",type:"default",onClick:n[13]||(n[13]=(...e)=>i.recPause&&i.recPause(...e))},"暂停"),e.createElementVNode("button",{size:"mini",type:"default",onClick:n[14]||(n[14]=(...e)=>i.recResume&&i.recResume(...e))},"继续"),e.createElementVNode("button",{size:"mini",type:"default",onClick:n[15]||(n[15]=(...e)=>i.recStopX&&i.recStopX(...e)),style:{padding:"0 5px","margin-left":"10px"}},"停止(仅清理)"),e.createElementVNode("button",{size:"mini",type:"default",onClick:n[16]||(n[16]=(...e)=>i.recEnvIn60&&i.recEnvIn60(...e)),style:{padding:"0 5px"}},"注入60秒数据")]),e.createElementVNode("view",{style:{padding:"5px 0 0 10px"}},[e.createElementVNode("view",{style:{height:"40px",width:"300px",background:"#999",position:"relative"}},[e.createElementVNode("view",{style:e.normalizeStyle([{height:"40px",background:"#0B1",position:"absolute"},{width:s.recpowerx+"%"}])},null,4),e.createElementVNode("view",{style:{"padding-left":"50px","line-height":"40px",position:"relative"}},e.toDisplayString(s.recpowert),1)]),e.createElementVNode("view",{style:{"padding-top":"5px"}}),e.createElementVNode("view",null,[e.createElementVNode("view",{class:"recwave",style:e.normalizeStyle({display:"WaveView"!=s.recwaveChoiceKey?"none":""})},[e.createElementVNode("canvas",{type:"2d",class:"recwave-WaveView"})],4),e.createElementVNode("view",{class:"recwave",style:e.normalizeStyle({display:"SurferView"!=s.recwaveChoiceKey?"none":""})},[e.createElementVNode("canvas",{type:"2d",class:"recwave-SurferView"}),e.createElementVNode("canvas",{type:"2d",class:"recwave-SurferView-2x",style:{width:"600px",display:"none"}})],4),e.createElementVNode("view",{class:"recwave",style:e.normalizeStyle({display:"Histogram1"!=s.recwaveChoiceKey?"none":""})},[e.createElementVNode("canvas",{type:"2d",class:"recwave-Histogram1"})],4),e.createElementVNode("view",{class:"recwave",style:e.normalizeStyle({display:"Histogram2"!=s.recwaveChoiceKey?"none":""})},[e.createElementVNode("canvas",{type:"2d",class:"recwave-Histogram2"})],4),e.createElementVNode("view",{class:"recwave",style:e.normalizeStyle({display:"Histogram3"!=s.recwaveChoiceKey?"none":""})},[e.createElementVNode("canvas",{type:"2d",class:"recwave-Histogram3"})],4)]),e.createElementVNode("view",{style:{"padding-top":"5px"},onClick:n[17]||(n[17]=(...e)=>i.recwaveChoice&&i.recwaveChoice(...e))},[e.createElementVNode("view",{class:e.normalizeClass(["recwaveChoice","WaveView"==s.recwaveChoiceKey?"slc":""]),"data-key":"WaveView"},"WaveView",2),e.createElementVNode("view",{class:e.normalizeClass(["recwaveChoice","SurferView"==s.recwaveChoiceKey?"slc":""]),"data-key":"SurferView"},"SurferView",2),e.createElementVNode("view",{class:e.normalizeClass(["recwaveChoice","Histogram1"==s.recwaveChoiceKey?"slc":""]),"data-key":"Histogram1"},"Histogram1",2),e.createElementVNode("view",{class:e.normalizeClass(["recwaveChoice","Histogram2"==s.recwaveChoiceKey?"slc":""]),"data-key":"Histogram2"},"H...2",2),e.createElementVNode("view",{class:e.normalizeClass(["recwaveChoice","Histogram3"==s.recwaveChoiceKey?"slc":""]),"data-key":"Histogram3"},"H...3",2)])]),e.createElementVNode("view",{style:{padding:"5px 10px 0"}},[e.createElementVNode("view",null,[e.createElementVNode("checkbox",{checked:s.takeoffEncodeChunkSet,onClick:n[18]||(n[18]=e=>s.takeoffEncodeChunkSet=!s.takeoffEncodeChunkSet)},"接管编码器输出（takeoffEncodeChunk，App端推荐开启）",8,["checked"]),e.createTextVNode(" "+e.toDisplayString(s.takeoffEncodeChunkMsg),1)]),e.createElementVNode("view",null,[e.createElementVNode("checkbox",{checked:s.appUseH5Rec,onClick:n[19]||(n[19]=(...e)=>i.appUseH5RecClick&&i.appUseH5RecClick(...e))},"App里面总是使用Recorder H5录音（勾选后不启用原生录音插件和uts插件）",8,["checked"])])]),e.createElementVNode("view",{style:{"padding-top":"10px"}},[e.createVNode(o,{ref:"player"},null,512)]),e.createElementVNode("view",{style:{"padding-top":"10px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.reclogs,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.idx,style:{"border-bottom":"1px dashed #666",padding:"5px 0"}},[e.createElementVNode("view",{style:e.normalizeStyle({color:1==t.color?"red":2==t.color?"green":t.color})},e.toDisplayString(t.txt),5)])))),128))]),e.createElementVNode("view",{style:{"padding-top":"80px"}}),e.createElementVNode("view",{style:{padding:"10px 10px"}},[e.createElementVNode("button",{size:"mini",type:"default",onClick:n[20]||(n[20]=(...e)=>i.loadVConsole&&i.loadVConsole(...e))},"显示vConsole")]),e.createElementVNode("view",{style:{height:"10px",background:"#eee"}}),e.createElementVNode("view",{style:{padding:"10px 10px"}},[e.createElementVNode("view",{style:{"padding-bottom":"10px",color:"#02a2ff","word-break":"break-all"}},[e.createElementVNode("view",{style:{"padding-bottom":"10px"}},"DCloud 插件市场下载本组件: https://ext.dcloud.net.cn/plugin?name=Recorder-UniCore"),e.createElementVNode("view",null,"RecordApp的uni-app支持文档和示例: https://github.com/xiangyuecn/Recorder/tree/master/app-support-sample/demo_UniApp (github可以换成gitee)")]),e.createElementVNode("view",{style:{color:"#0ab","font-size":"22px","font-weight":"bold"}}," 如需录音功能定制开发，网站、App、小程序、前端后端开发等需求，请加QQ群：①群 781036591、②群 748359095，口令recorder，联系群主（即作者），谢谢~ ")]),e.createElementVNode("view",{style:{"margin-bottom":"5px",height:"10px",background:"#eee"}}),e.createElementVNode("view",{style:{padding:"0 10px"}},[e.createElementVNode("view",{style:{"font-size":"17px","font-weight":"bold",color:"#f60"}},"关于Recorder-UniCore组件中的 app-uni-support.js 支持文件"),e.createElementVNode("view",{style:{"font-size":"14px","padding-top":"10px"}},[e.createElementVNode("view",null,"Recorder-UniCore组件中给RecordApp提供uni-app适配的代码在app-uni-support.js文件内，此文件为压缩版（功能和源码版一致），如果已获得商用授权、或者付费购买了配套的原生录音插件或uts插件后，可在VIP支持QQ群的群文件中下载到此js文件最新源码。"),e.createElementVNode("view",{style:{color:"#f60"}},[e.createTextVNode("app-uni-support.js文件在uni-app中编译到App平台时仅供测试用（App平台包括：Android App、iOS App），"),e.createElementVNode("text",{style:{"font-weight":"bold"}},"不可用于正式发布或商用，正式发布或商用需先联系作者获得授权许可"),e.createTextVNode("（如何获取授权请阅读Recorder-UniCore组件文档）。")]),e.createElementVNode("view",{style:{color:"#0b0"}},"编译到其他平台时无此授权限制，比如：H5、小程序，均为免费授权。")])]),e.createElementVNode("view",{style:{"padding-top":"80px"}}),e.createElementVNode("view",{style:{height:"10px",background:"#eee"}}),e.createElementVNode("view",{style:{padding:"10px 10px"}},[e.createElementVNode("view",null,[e.createElementVNode("text",{style:{"font-size":"17px","font-weight":"bold",color:"#f60"}},"在逻辑层中执行代码"),e.createElementVNode("button",{size:"mini",type:"default",onClick:n[21]||(n[21]=(...e)=>i.evalExecClick&&i.evalExecClick(...e))},"执行")]),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[22]||(n[22]=e=>s.evalExecCode=e),maxlength:"-1",style:{display:"block",border:"1px solid #ddd","box-sizing":"border-box",width:"100%"},placeholder:"this为当前页面或组件的this"},null,512),[[e.vModelText,s.evalExecCode]])])])}]]),R=e=>{(e.$renderjs||(e.$renderjs=[])).push("testPerfRJs"),(e.$renderjsModules||(e.$renderjsModules={})).testPerfRJs="876c306c"},k={data:()=>({canTest:A,dataSizeKB:10,clickCount:0,evalRJs0:"",evalRJs1:"",evalRJs2:"",evalRJs3:"",evalRJs4:"",evalRJs5:"",evalRJs6:"",evalRJs7:"",evalRJs8:"",evalRJs9:""}),mounted(){A&&(x('testPerfRJsLog("逻辑层btoa: '+("QULOpkNE"==btoa("ABÎ¦CD")?"OK":"Fail")+'")'),this.callVue("callTestVue(-1,"+Date.now()+',"")'),x("callTestWebView(-1,"+Date.now()+',"")'))},methods:{setDataSize10KB(){this.dataSizeKB=10},setDataSize1MB(){this.dataSizeKB=1024},setDataSize5MB(){this.dataSizeKB=5120},clickXXX(){this.clickCount++},traceThis(){var e=["逻辑层可用：<pre style='white-space:pre-wrap'>"],t=e=>{/func/i.test(typeof e)&&(e="[Func]");try{e=""+e}catch(t){e="[?"+typeof e+"]"}return'<span style="color:#bbb">='+e.substr(0,50)+"</span>"};for(var n in globalThis);for(var n in this)e.push("this."+n+t(this[n]));for(var n in this.$)e.push("this.$."+n+t(this.$[n]));for(var n in this.$root)e.push("this.$root."+n+t(this.$root[n]));for(var n in this.$root.$vm)e.push("this.$root.$vm."+n+t(this.$root.$vm[n]));if(this.$root.$scope){for(var n in this.$root.$scope)e.push("this.$root.$scope."+n+t(this.$root.$scope[n]));for(var n in this.$root.$scope.$page)e.push("this.$root.$scope.$page."+n+t(this.$root.$scope.$page[n]))}for(var n in this.$root.$page)e.push("this.$root.$page."+n+t(this.$root.$page[n]));e.push("</pre>"),x("renderjsTraceThis(); testPerfRJsLog(`"+e.join("\n\t")+"`)")},callVue(e){this.evalRJsIdx=(this.evalRJsIdx||0)+1,this["evalRJs"+this.evalRJsIdx%10]=e},testRenderJSOnMsg(e){T(e)},testRenderJS_Descriptor(){this.clickCount++,this.testStopRenderJS_Descriptor(),x("testRenderJSStart(false,"+this.dataSizeKB+")"),this.testStart("testRenderJS_Descriptor")},testStopRenderJS_Descriptor(){this.clickCount++,clearInterval(this.testRenderJS_DescriptorInt)},testRenderJS_Bridge(){this.clickCount++,this.testStopRenderJS_Bridge(),x("testRenderJSStart(true,"+this.dataSizeKB+")"),this.testStart("testRenderJS_Bridge")},testStopRenderJS_Bridge(){this.clickCount++,clearInterval(this.testRenderJS_BridgeInt)},testVue(){this.clickCount++,this.testStopVue(),this.testStart("callTestVue")},testStopVue(){this.clickCount++,clearInterval(this.callTestVueInt)},testWebView(){this.clickCount++,this.testStopWebView(),this.testStart("callTestWebView")},testStopWebView(){this.clickCount++,clearInterval(this.callTestWebViewInt)},testStart(e){for(var t=new Array(1025).join("*");t.length<1024*this.dataSizeKB;)t+=t;t=t.substr(0,1024*this.dataSizeKB);var n=0,r=0;this[e+"Int"]=setInterval((()=>{Date.now()-r<19||(r=Date.now(),n++,e.indexOf("testRenderJS")+1?x(e+"__setInterval()"):"callTestVue"==e?this.callVue(e+"("+n+","+Date.now()+',"'+t+'")'):x(e+"("+n+","+Date.now()+',"'+t+'")'))}),1)}}};var A=true;if(A){var T=function(e){x("testRenderJSOnMsgOK("+e.useBridge+","+e.sid+","+e.t1+","+Date.now()+","+e.txt.length+")")};UniServiceJSBridge.subscribe("testRenderJSOnMsg",(function(e){T(e)})),UniServiceJSBridge.subscribe("testMainOnMsg",(function(e){x("testPerfRJsLog('UniServiceJSBridge.subscribe: "+JSON.stringify(e)+"')")}))}var x=function(e){var t=C();if(!t)throw new Error("不是App环境不可调用Webview执行js");t.evalJS(e)},C=function(){var e=getCurrentPages();return e[e.length-1].$getAppWebview()};R(k);const E=n(k,[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",{style:{padding:"0 5px"}},[e.createElementVNode("view",{evalrjs0:e.wp(s.evalRJs0),"change:evalrjs0":t.testPerfRJs.evalRJs},null,8,["evalrjs0","change:evalrjs0"]),e.createElementVNode("view",{evalrjs1:e.wp(s.evalRJs1),"change:evalrjs1":t.testPerfRJs.evalRJs},null,8,["evalrjs1","change:evalrjs1"]),e.createElementVNode("view",{evalrjs2:e.wp(s.evalRJs2),"change:evalrjs2":t.testPerfRJs.evalRJs},null,8,["evalrjs2","change:evalrjs2"]),e.createElementVNode("view",{evalrjs3:e.wp(s.evalRJs3),"change:evalrjs3":t.testPerfRJs.evalRJs},null,8,["evalrjs3","change:evalrjs3"]),e.createElementVNode("view",{evalrjs4:e.wp(s.evalRJs4),"change:evalrjs4":t.testPerfRJs.evalRJs},null,8,["evalrjs4","change:evalrjs4"]),e.createElementVNode("view",{evalrjs5:e.wp(s.evalRJs5),"change:evalrjs5":t.testPerfRJs.evalRJs},null,8,["evalrjs5","change:evalrjs5"]),e.createElementVNode("view",{evalrjs6:e.wp(s.evalRJs6),"change:evalrjs6":t.testPerfRJs.evalRJs},null,8,["evalrjs6","change:evalrjs6"]),e.createElementVNode("view",{evalrjs7:e.wp(s.evalRJs7),"change:evalrjs7":t.testPerfRJs.evalRJs},null,8,["evalrjs7","change:evalrjs7"]),e.createElementVNode("view",{evalrjs8:e.wp(s.evalRJs8),"change:evalrjs8":t.testPerfRJs.evalRJs},null,8,["evalrjs8","change:evalrjs8"]),e.createElementVNode("view",{evalrjs9:e.wp(s.evalRJs9),"change:evalrjs9":t.testPerfRJs.evalRJs},null,8,["evalrjs9","change:evalrjs9"]),e.createElementVNode("view",{style:{"padding-top":"5px","font-size":"17px","font-weight":"bold",color:"#f60"}},"App逻辑层与renderjs数据交互性能测试"),e.createElementVNode("view",{style:{"padding-bottom":"5px","font-size":"12px"}},"多种情况下不停测试：静止不动、胡乱操作、退到后台、锁屏"),e.createElementVNode("view",null,[e.createTextVNode(" 点击:"+e.toDisplayString(s.clickCount)+" ",1),e.createElementVNode("button",{size:"mini",onClick:n[0]||(n[0]=(...e)=>i.clickXXX&&i.clickXXX(...e))},"随便点击"),e.createElementVNode("button",{size:"mini",onClick:n[1]||(n[1]=(...e)=>i.traceThis&&i.traceThis(...e))},"显示this可用属性")]),e.createElementVNode("view",null,[e.createTextVNode(" 数据大小 "),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":n[2]||(n[2]=e=>s.dataSizeKB=e),style:{width:"60px",display:"inline-block",border:"1px solid #ddd"}},null,512),[[e.vModelText,s.dataSizeKB]]),e.createTextVNode("KB "),e.createElementVNode("button",{size:"mini",onClick:n[3]||(n[3]=(...e)=>i.setDataSize10KB&&i.setDataSize10KB(...e))},"10KB"),e.createElementVNode("button",{size:"mini",onClick:n[4]||(n[4]=(...e)=>i.setDataSize1MB&&i.setDataSize1MB(...e))},"1MB"),e.createElementVNode("button",{size:"mini",onClick:n[5]||(n[5]=(...e)=>i.setDataSize5MB&&i.setDataSize5MB(...e))},"5MB")]),s.canTest?(e.openBlock(),e.createElementBlock("view",{key:1},[e.createElementVNode("view",null,[e.createElementVNode("button",{size:"mini",onClick:n[6]||(n[6]=(...e)=>i.testVue&&i.testVue(...e))},"逻辑层默认vue方式发送(不可靠)"),e.createElementVNode("button",{size:"mini",onClick:n[7]||(n[7]=(...e)=>i.testStopVue&&i.testStopVue(...e))},"结束")]),e.createElementVNode("view",null,[e.createElementVNode("button",{size:"mini",onClick:n[8]||(n[8]=(...e)=>i.testWebView&&i.testWebView(...e))},"逻辑层给WebView直接发送"),e.createElementVNode("button",{size:"mini",onClick:n[9]||(n[9]=(...e)=>i.testStopWebView&&i.testStopWebView(...e))},"结束")]),e.createElementVNode("view",null,[e.createElementVNode("button",{size:"mini",onClick:n[10]||(n[10]=(...e)=>i.testRenderJS_Descriptor&&i.testRenderJS_Descriptor(...e))},"renderjs ComponentDescriptor发送给 逻辑层 "),e.createElementVNode("button",{size:"mini",onClick:n[11]||(n[11]=(...e)=>i.testStopRenderJS_Descriptor&&i.testStopRenderJS_Descriptor(...e))},"结束")]),e.createElementVNode("view",null,[e.createElementVNode("button",{size:"mini",onClick:n[12]||(n[12]=(...e)=>i.testRenderJS_Bridge&&i.testRenderJS_Bridge(...e))},"renderjs UniViewJSBridge发送给 逻辑层 "),e.createElementVNode("button",{size:"mini",onClick:n[13]||(n[13]=(...e)=>i.testStopRenderJS_Bridge&&i.testStopRenderJS_Bridge(...e))},"结束")]),e.createElementVNode("view",{class:"testPerfRJsLogs"})])):(e.openBlock(),e.createElementBlock("view",{key:0}," 非App或H5，不测试 "))])}]]);const M=n({components:{testMain:S,testPerfRenderjs:E},mounted(){this.$refs.testMain.uniPage__onShow()},onShow(){this.$refs.testMain&&this.$refs.testMain.uniPage__onShow()}},[["render",function(t,n,r,a,s,i){const o=e.resolveComponent("testMain"),l=e.resolveComponent("testPerfRenderjs");return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{style:{padding:"5px 10px 0"}},[e.createElementVNode("view",{style:{"font-size":"24px",color:"#f60"}},"Recorder App uni-app测试"),e.createElementVNode("view",{style:{"font-size":"13px"}},"本测试项目支持打包成：H5网页、Android App、iOS App、微信小程序，支持Vue2、Vue3")]),e.createVNode(o,{ref:"testMain"},null,512),e.createElementVNode("view",{style:{"margin-top":"80px",height:"10px",background:"#eee"}}),e.createVNode(l),e.createElementVNode("view",{style:{"padding-top":"80px"}})])}]]);const B=n({components:{testMain:S,testPerfRenderjs:E},mounted(){this.$refs.testMain.uniPage__onShow()},onShow(){this.$refs.testMain&&this.$refs.testMain.uniPage__onShow()}},[["render",function(t,n,r,a,s,i){const o=e.resolveComponent("testMain"),l=e.resolveComponent("testPerfRenderjs");return e.openBlock(),e.createElementBlock("view",null,[e.createVNode(o,{ref:"testMain"},null,512),e.createElementVNode("view",{style:{"margin-top":"80px",height:"10px",background:"#eee"}}),e.createVNode(l),e.createElementVNode("view",{style:{"padding-top":"80px"}})])}]]);!function(e){var t="object"==typeof window&&!!window.document,n=(t?window:Object).Recorder,r=n.i18n;!function(e,t,n,r){var a=function(e){return new i(e)},s="ASR_Aliyun_Short",i=function(e){var t=this,n={tokenApi:"",apiArgs:{action:"token",lang:"普通话"},apiRequest:null,compatibleWebSocket:null,log:c,fileSpeed:6};for(var r in e)n[r]=e[r];t.set=e=n,t.state=0,t.started=0,t.sampleRate=16e3,t.pcmBuffers=[],t.pcmTotal=0,t.pcmOffset=0,t.pcmSend=0,t.joinBuffers=[],t.joinSize=0,t.joinSend=0,t.joinOffset=-1,t.joinIsOpen=0,t.joinSendTotal=0,t.sendCurSize=0,t.sendTotal=0,t.resTxts=[],e.asrProcess||t.log("未绑定asrProcess回调无法感知到abort事件",3)},o=function(){var t=arguments;t[0]="["+s+"]"+t[0],e.CLog.apply(null,t)};function l(e,t,n,r){var a=new XMLHttpRequest;a.timeout=2e4,a.open("POST",e),a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status){try{var e=JSON.parse(a.responseText)}catch(t){}if(0!==e.c||!e.v)return void r(e.m||"接口返回非预定义json数据");n(e.v)}else r("请求失败["+a.status+"]")};var s=[];for(var i in t)s.push(i+"="+encodeURIComponent(t[i]));a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(s.join("&"))}function c(){}i.prototype=a.prototype={log:function(e,t){o(e,"number"==typeof t?t:0),this.set.log("["+s+"]"+e,3==t?"#f60":t)},inputDuration:function(){return Math.round(this.pcmTotal/this.sampleRate*1e3)},sendDuration:function(e){var t=this.sendTotal;return t+=e||0,Math.round(t/this.sampleRate*1e3)},asrDuration:function(){return this.sendDuration(-this.joinSendTotal)},audioToText:function(t,n,r){var a=this,s=function(e){a.log(e,1),r&&r(e)};if(e.GetContext()){var i=new FileReader;i.onloadend=function(){e.Ctx.decodeAudioData(i.result,(function(e){for(var t=e.getChannelData(0),s=e.sampleRate,i=new Int16Array(t.length),o=0;o<t.length;o++){var l=Math.max(-1,Math.min(1,t[o]));l=l<0?32768*l:32767*l,i[o]=l}a.pcmToText(i,s,n,r)}),(function(e){s("音频解码失败["+t.type+"]:"+e.message)}))},i.readAsArrayBuffer(t)}else s("浏览器不支持音频解码")},pcmToText:function(e,t,n,r){var a=this;a.start((function(){a.log("单个文件"+Math.round(e.length/t*1e3)+"ms转文字"),a.sendSpeed=a.set.fileSpeed,a.input([e],t),a.stop(n,r)}),r)},start:function(e,t){var n=this,a=n.set,s=function(e){n.sendAbortMsg=e,t&&t(e)};if(a.compatibleWebSocket||r)if(0==n.state){n.state=1;var i=function(){n.log("ASR start被stop中断",1),n._send()};n._token((function(){1!=n.state?i():(n.log("OK start",2),n.started=1,e&&e(),n._send())}),(function(e){e="语音识别token接口出错："+e,n.log(e,1),1!=n.state?i():(s(e),n._send())}))}else s("ASR对象不可重复start");else s("非浏览器环境，请提供compatibleWebSocket配置来返回一个兼容的WebSocket")},stop:function(e,t){e=e||c,t=t||c;var n=this,r=function(e){e="语音识别stop出错："+e,n.log(e,1),t(e)};2!=n.state?(n.state=2,n.stopWait=function(){if(n.stopWait=null,n.started){var r=n.getText();!r&&n.sendAbortMsg?t(n.sendAbortMsg):e(r,n.sendAbortMsg||"")}else t(n.sendAbortMsg||"未开始语音识别")},n._send()):r("ASR对象不可重复stop")},input:function(t,n,r){var a=this;if(2!=a.state){var s="input输入的采样率低于"+a.sampleRate;if(n<a.sampleRate)return o(s+"，数据已丢弃",3),a.pcmTotal||(a.sendAbortMsg=s),void a._send();if(a.sendAbortMsg==s&&(a.sendAbortMsg=""),r){for(var i=[],l=r;l<t.length;l++)i.push(t[l]);t=i}var c=e.SampleData(t,n,a.sampleRate).data;a.pcmTotal+=c.length,a.pcmBuffers.push(c),a._send()}else a._send()},_send:function(){var e=this,t=e.set;if(!e.sendWait){var n=function(){e.stopWait&&e.stopWait()};if(2!=e.state||e.started&&e.stopWait)if(e.sendAbort)n();else{var r=function(t){e.sendAbort||(e.sendAbort=1,e.sendAbortMsg=t||"-",a(0,1)),e._send()},a=function(n,r){if(!r&&e.sendAbort)return!1;if(n=n||0,!t.asrProcess)return e.sendTotal+n<=i;var a=t.asrProcess(e.getText(),e.sendDuration(n),e.sendAbort?e.sendAbortMsg:"");return e._prsw||"boolean"==typeof a||o("asrProcess返回值必须是boolean类型，true才能继续识别，否则立即超时",1),e._prsw=1,a},s=5*e.sampleRate,i=60*e.sampleRate,l=e.wsCur;if(l){if(!e.wsLock&&2==l._s&&!l.isStop)if(e.pcmSend>=e.pcmTotal){if(1==e.state)return;l.stopWs((function(){n()}),(function(e){r(e)}))}else{var c=e.sampleRate/1e3*50,u=e.sampleRate;if((l.bufferedAmount||0)/2>3*u)e.sendWait=setTimeout((function(){e.sendWait=0,e._send()}),100);else{if(e.sendSpeed){var p=(Date.now()-l.okTime)*e.sendSpeed,d=(e.sendCurSize+u/3)/e.sampleRate*1e3,f=Math.floor((d-p)/e.sendSpeed);if(f>0)return o("[ASR]延迟"+f+"ms发送"),void(e.sendWait=setTimeout((function(){e.sendWait=0,e._send()}),f))}var h=1,_=function(e,t,n){for(var r=n.length,a=0,s=0;s<r&&a<t.length;){var i=t[a];if(!(i.length-e<=r-s)){n.set(i.subarray(e,e+(r-s)),s),e+=r-s;break}n.set(0==e?i:i.subarray(e),s),s+=i.length-e,e=0,t.splice(a,1)}return e};if(e.joinIsOpen){if(-1==e.joinOffset){e.joinSend=0,e.joinOffset=0,e.log("发送上1分钟结尾5秒数据...");for(var m=0,v=e.joinBuffers.length-1;v>=0;v--)if((m+=e.joinBuffers[v].length)>=s){e.joinBuffers.splice(0,v),e.joinSize=m,e.joinOffset=m-s;break}}var g=e.joinSize-e.joinOffset;if((R=Math.min(u,g))<=0)return e.log("发送新1分钟数据(重叠"+Math.round(e.joinSend/e.sampleRate*1e3)+"ms)..."),e.joinBuffers=[],e.joinSize=0,e.joinOffset=-1,e.joinIsOpen=0,void e._send();var b=new Int16Array(R);e.joinSend+=R,e.joinSendTotal+=R,e.joinOffset=_(e.joinOffset,e.joinBuffers,b),e.joinSize=0;for(v=0;v<e.joinBuffers.length;v++)e.joinSize+=e.joinBuffers[v].length}else{g=e.pcmTotal-e.pcmSend;var w=Math.round(g/e.sampleRate*1e3),y=i-e.sendCurSize,S=Math.min(u,g),R=Math.min(S,y);if(1==e.state&&R<Math.min(c,y))return;var k=0;if(y<=0&&(2==e.state&&g<1.2*e.sampleRate?(R=g,e.log("丢弃结尾"+w+"ms数据","#999"),h=0):k=!0),h&&!a(S)){var A=Math.round(e.asrDuration()/1e3);return e.log("已主动超时，共识别"+A+"秒，丢弃缓冲"+w+"ms，正在终止..."),e.wsLock=1,void l.stopWs((function(){r("已主动超时，共识别"+A+"秒，终止识别")}),(function(e){r(e)}))}if(k)return o("[ASR]新1分钟接续，当前缓冲"+w+"ms..."),e.wsLock=1,void l.stopWs((function(){e._token((function(){e.log("新1分钟接续OK，当前缓冲"+w+"ms",2),e.wsLock=0,e.wsCur=0,e.sendCurSize=0,e.joinIsOpen=1,e.joinOffset=-1,e._send()}),(function(e){r("语音识别新1分钟token接口出错："+e)}))}),(function(e){r(e)}));b=new Int16Array(R);e.pcmOffset=_(e.pcmOffset,e.pcmBuffers,b),e.pcmSend+=R,e.joinBuffers.push(b),e.joinSize+=R}if(e.sendCurSize+=b.length,e.sendTotal+=b.length,h)try{l.send(b.buffer)}catch(x){o("ws.send",1,x)}e.sendWait=setTimeout((function(){e.sendWait=0,e._send()}))}}}else if(e.started){var T={};e.resTxts.push(T),l=e.wsCur=e._wsNew(e.tokenData,"ws:"+e.resTxts.length,T,(function(){a()}),(function(){e._send()}),(function(t){l==e.wsCur&&r(t)}))}}else n()}},getText:function(){for(var e=this.resTxts,t="",n=0;n<e.length;n++){var r=e[n];if(r.fullTxt)t=r.fullTxt;else{var a=r.tempTxt||"";if(r.okTxt&&(a=r.okTxt),t){for(var s=t.substr(-20),i=[],o=0,l=Math.min(17,a.length-3);o<=l;o++)for(var c=0;c<17;c++)if(s[c]==a[o]){for(var u=1;u<17&&s[c+u]==a[o+u];u++);u>=3&&i.push({x:o,i0:c,n:u})}i.sort((function(e,t){var n=t.n-e.n;return 0!=n?n:t.i0-e.i0}));var p=i[0];p?(t=t.substr(0,t.length-s.length+p.i0),t+=a.substr(p.x)):t+=a}else t=a;null!=r.okTxt&&a==r.okTxt&&(r.fullTxt=t)}}return t},_wsNew:function(e,t,n,r,a,s){var i=function(){for(var e,t=[],n=0;n<32;n++)e=Math.floor(16*Math.random()),t.push(String.fromCharCode(e<10?e+48:e-10+97));return t.join("")},l=this,c=l.set;o("[ASR "+t+"]正在连接...");var u="wss://nls-gateway.cn-shanghai.aliyuncs.com/ws/v1?token="+e.token;if(c.compatibleWebSocket)var p=c.compatibleWebSocket(u);else p=new WebSocket(u);return p.onclose=function(){var e=4!=p._s;p._s=-1,l.log("["+t+"]close"),e&&s(p._err||"连接"+t+"已关闭")},p.onopen=function(){p._s=1,o("[ASR "+t+"]open"),p._task=i(),p.send(JSON.stringify({header:{message_id:i(),task_id:p._task,appkey:e.appkey,namespace:"SpeechRecognizer",name:"StartRecognition"},payload:{format:"pcm",sample_rate:l.sampleRate,enable_intermediate_result:!0,enable_punctuation_prediction:!0,enable_inverse_text_normalization:!0},context:{}}))},p.onerror=function(e){l.log("["+t+"]连接出错",1)},p.onmessage=function(e){var s=e.data,i=!0;if("string"==typeof s&&"{"==s[0]){var c=(s=JSON.parse(s)).header||{},u=s.payload||{},d=c.name||"",f=c.status||0,h="TaskFailed"==d,_="";if(1!=p._s||"RecognitionStarted"!=d&&!h||(h?_="连接"+t+"失败["+f+"]"+c.status_text:(p._s=2,l.log("["+t+"]连接OK"),p.okTime=Date.now(),a())),2!=p._s||"RecognitionResultChanged"!=d&&!h||(h?_="识别出现错误["+f+"]"+c.status_text:(i=!p._clmsg,p._clmsg=1,n.tempTxt=u.result||"",r())),3==p._s&&("RecognitionCompleted"==d||h)){var m="";h?_="停止识别出现错误["+f+"]"+c.status_text:(m=u.result||"",l.log("["+t+"]最终识别结果："+m)),p.stopCall&&p.stopCall(m,_)}_&&(l.log("["+t+"]"+_,1),p._err||(p._err=_))}i&&o("[ASR "+t+"]msg",s)},p.stopWs=function(a,s){2==p._s?(p._s=3,p.isStop=1,p.stopCall=function(e,t){clearTimeout(p.stopInt),p.stopCall=0,p._s=4,p.close(),n.okTxt=e,r(),t?s(t):a()},p.stopInt=setTimeout((function(){p.stopCall&&p.stopCall("","停止识别返回结果超时")}),1e4),o("[ASR "+t+"]send stop"),p.send(JSON.stringify({header:{message_id:i(),task_id:p._task,appkey:e.appkey,namespace:"SpeechRecognizer",name:"StopRecognition"}}))):s(t+"状态不正确["+p._s+"]")},p.connect&&p.connect(),p},_token:function(e,t){var n=this,r=n.set;r.tokenApi?(r.apiRequest||l)(r.tokenApi,r.apiArgs||{},(function(r){r&&r.appkey&&r.token?(n.tokenData=r,e()):t("apiRequest回调的数据格式不正确")}),t):t("未配置tokenApi")}},e[s]=a}(n,0,r.$T,t)}();const V=e=>{(e.$renderjs||(e.$renderjs=[])).push("testMainVue"),(e.$renderjsModules||(e.$renderjsModules={})).testMainVue="14839750"},N={components:{TestPlayer:d},data:()=>({asrTokenApi:"",asrLang:"普通话",asrTime:"",asrTxt:"",SyncID:0,recpowerx:0,recpowert:"",reclogs:[]}),mounted(){this.isMounted=!0,b.UniPageOnShow(this),this.reclog("本测试页面只提供阿里云版的语音识别（Recorder插件：/src/extensions/asr.aliyun.short.js），如果需要腾讯云一句话语音识别（不支持实时特性），前端基本上没有什么需要做的，仅需让后端提供一个录音文件上传接口（很容易，H5也能用），前端将录制好1分钟内的语音文件直接上传给服务器，由后端调用腾讯云语一句话音识别接口，然后返回结果即可，或者App里面直接前端调用腾讯云语音识别接口。其他厂家的语音识别接口请自行参考对接，如需定制开发请联系作者。");this.asrTokenApi=uni.getStorageSync("page_asr_asrTokenApi")||"http://你电脑局域网ip:9527/token"},unmounted(){b.Stop()},onShow(){this.isMounted&&b.UniPageOnShow(this)},methods:{currentKeyTag(){if(!b.Current)return"[?]";var e="Renderjs+H5";return b.UniNativeUtsPlugin&&(e=b.UniNativeUtsPlugin.nativePlugin?"NativePlugin":"UtsPlugin"),b.Current.Key+"("+e+")"},recStart(){var e=++this.SyncID;this.asrTokenApi?this.asr?this.reclog("上次asr未关闭",1):(this.reclog("正在请求录音权限..."),b.UniWebViewActivate(this),b.RequestPermission((()=>{this.reclog(this.currentKeyTag()+" 已获得录音权限",2),this.recStart__asrStart(e)}),((e,t)=>{this.reclog(this.currentKeyTag()+" "+(t?"isUserNotAllow,":"")+"请求录音权限失败："+e,1)}))):this.reclog("需要提供TokenApi",1)},recStart__2(e){e==this.SyncID?(this.reclog(this.currentKeyTag()+" 正在打开录音..."),b.UniWebViewActivate(this),b.Start({type:"wav",bitRate:16,sampleRate:16e3,onProcess:(t,n,r,a,s,i)=>{e==this.SyncID&&(this.asr&&this.asr.input(t,a,s),this.recpowerx=n,this.recpowert=this.formatTime(r,1)+" / "+n)},onProcess_renderjs:"function(buffers,powerLevel,duration,sampleRate,newBufferIdx,asyncEnd){\n\t\t\t\t\t//App中是在renderjs中进行的可视化图形绘制\n\t\t\t\t\tif(this.waveView){\n\t\t\t\t\t\tthis.waveView.input(buffers[buffers.length-1],powerLevel,sampleRate);\n\t\t\t\t\t}\n\t\t\t\t}",stop_renderjs:"function(aBuf,duration,mime){\n\t\t\t\t\t//App中可以放一个函数，在Stop成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t\tthis.audioData=aBuf; //留着给Stop时进行转码成wav播放\n\t\t\t\t}"},(()=>{this.reclog(this.currentKeyTag()+" 已开始录音，请讲话（asrProcess中已限制最多识别60*2-5*(2-1)=115秒）...",2),b.UniFindCanvas(this,[".recwave-WaveView"],"\n\t\t\t\t\tthis.waveView=Recorder.WaveView({compatibleCanvas:canvas1, width:300, height:100});\n\t\t\t\t",(e=>{this.waveView=v.WaveView({compatibleCanvas:e,width:300,height:100})}))}),(e=>{this.reclog(this.currentKeyTag()+" 开始录音失败："+e,1),this.recCancel("开始录音失败")}))):this.reclog("sync cancel recStart__2","#f60")},recStart__asrStart(e){if(e==this.SyncID){var t=this.asr=v.ASR_Aliyun_Short({tokenApi:this.asrTokenApi,apiArgs:{lang:this.asrLang},apiRequest:P,compatibleWebSocket:j,asrProcess:(e,n,r)=>r?(this.reclog("[asrProcess回调]被终止："+r,1),this.recCancel("语音识别出错"),!1):(this.asrTxt=e,this.asrTime="识别时长: "+this.formatTime(t.asrDuration())+" 已发送数据时长: "+this.formatTime(t.sendDuration()),n<=12e4),log:(e,t)=>{this.reclog(e,1==t?"#faa":"#aaa")}});this.reclog("语言："+t.set.apiArgs.lang+"，tokenApi："+t.set.tokenApi+"，正在打开语音识别..."),t.start((()=>{this.reclog("已开始语音识别",2),this.recStart__2(e)}),(e=>{this.reclog("语音识别开始失败，请重试："+e,1),this.recCancel("语音识别开始失败")}))}else this.reclog("sync cancel recStart__asrStart","#f60")},recStop(){++this.SyncID,this.recCancel()},recCancel(e){this.reclog("正在停止...");var t=this.asr;this.asr=null,t?t.stop(((e,t)=>{t&&(t="发现识别中途被终止(一般无需特别处理)："+t),this.reclog("语音识别完成"+(t?"，"+t:""),t?"#f60":2),this.reclog("识别最终结果："+e,2)}),(t=>{this.reclog("语音识别"+(e?"被取消":"结束失败")+"："+t,1)})):this.reclog("未开始识别",1),b.Stop(((e,t,n)=>{var r=(b.GetCurrentRecOrNull()||{set:{type:"wav"}}).set;this.reclog("已录制["+n+"]："+this.formatTime(t,1)+" "+e.byteLength+"字节 "+r.sampleRate+"hz "+r.bitRate+"kbps",2);this.$refs.player.setPlayBytes(e,"this.audioData",t,n,r,v)}),(e=>{this.reclog("结束录音失败："+e,1)}))},reclog(e,t){var n=new Date,r="["+(("0"+n.getHours()).substr(-2)+":"+("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2))+"]"+e;a("log","at pages/recTest/page_asr.vue:314",r),this.reclogs.splice(0,0,{txt:r,color:t})},formatTime(e,t){var n=e%1e3,r=(e=(e-n)/1e3)%60,a=(e=(e-r)/60)%60,s=(e=(e-a)/60,"");return e>0&&(s+=(e<10?"0":"")+e+":"),s+=(a<10?"0":"")+a+":",s+=(r<10?"0":"")+r,t&&(s+="″"+("00"+n).substr(-3)),s}}};var P=function(e,t,n,r){uni.setStorageSync("page_asr_asrTokenApi",e),uni.request({url:e,data:t,method:"POST",dataType:"text",header:{"content-type":"application/x-www-form-urlencoded"},success:e=>{if(200==e.statusCode){try{var t=JSON.parse(e.data)}catch(a){return void r("请求结果不是json格式："+a.data)}0===t.c?(t=t.v,n({appkey:t.appkey,token:t.token})):r("接口调用错误："+t.m)}else r("请求出错["+e.statusCode+"]")},fail:e=>{r(e.errMsg||"请求出错")}})},j=function(e){var t={onopen:()=>{},onerror:e=>{},onclose:e=>{},onmessage:e=>{}},n=t.storeData={};return t.send=e=>{n.wsTask.send({data:e})},t.connect=()=>{var r=n.wsTask=uni.connectSocket({url:e,success:()=>{},fail:e=>{n.isError||(n.isError=1,t.onerror({message:"创建连接出现错误："+e.errMsg}))}});r.onOpen((()=>{n.isOpen||(n.isOpen=1,t.onopen())})),r.onClose((e=>{n.isClose||(n.isClose=1,t.onclose({code:e.code||-1,reason:e.reason||""}))})),r.onError((e=>{n.isError||(n.isError=1,t.onerror({message:e.errMsg||"未知错误"}))})),r.onMessage((e=>{t.onmessage({data:e.data})}))},t.close=(e,t)=>{var r={};null!=e&&(r.code=e),null!=t&&(r.reason=t),n.wsTask.close(r)},t};V(N);const I=n(N,[["render",function(t,n,r,a,s,i){const o=e.resolveComponent("TestPlayer");return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{style:{color:"#f60","font-weight":"bold",padding:"10px"}},"实时语音识别 [阿里云版] - /src/extensions/asr.aliyun.short.js"),e.createElementVNode("view",{style:{padding:"0 10px"}},[e.createElementVNode("text",null,"识别语言模型："),e.createElementVNode("checkbox",{onClick:n[0]||(n[0]=e=>s.asrLang="普通话"),checked:"普通话"==s.asrLang},"普通话",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[1]||(n[1]=e=>s.asrLang="粤语"),checked:"粤语"==s.asrLang},"粤语",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[2]||(n[2]=e=>s.asrLang="英语"),checked:"英语"==s.asrLang},"英语",8,["checked"]),e.createElementVNode("checkbox",{onClick:n[3]||(n[3]=e=>s.asrLang="日语"),checked:"日语"==s.asrLang},"日语",8,["checked"])]),e.createElementVNode("view",{style:{padding:"0px 10px 0"}},[e.createElementVNode("text",null,"Token Api："),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":n[4]||(n[4]=e=>s.asrTokenApi=e),style:{width:"200px",display:"inline-block",border:"1px solid #ddd"}},null,512),[[e.vModelText,s.asrTokenApi]]),e.createElementVNode("view",{style:{"font-size":"13px",color:"#999"}},"你可以在电脑上运行Recorder仓库/assets/demo-asr内的nodejs服务器端脚本，然后填写你电脑局域网ip即可测试（H5时用127.0.0.1）"),e.createElementVNode("view",{style:{"font-size":"13px",color:"#fa0"}},"如果你要在小程序中使用，需要将阿里云的ws地址也加入白名单")]),e.createElementVNode("view",{style:{display:"flex","padding-top":"10px"}},[e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{type:"primary",onClick:n[5]||(n[5]=(...e)=>i.recStart&&i.recStart(...e)),style:{"font-size":"16px",padding:"0"}},"开始录音+语音识别")]),e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{width:"120px"}},[e.createElementVNode("button",{type:"warn",onClick:n[6]||(n[6]=(...e)=>i.recStop&&i.recStop(...e)),style:{"font-size":"16px",padding:"0"}},"停止")]),e.createElementVNode("view",{style:{width:"10px"}})]),e.createElementVNode("view",{style:{padding:"5px 0 0 10px"}},[e.createElementVNode("view",{style:{height:"40px",width:"300px",background:"#999",position:"relative"}},[e.createElementVNode("view",{style:e.normalizeStyle([{height:"40px",background:"#0B1",position:"absolute"},{width:s.recpowerx+"%"}])},null,4),e.createElementVNode("view",{style:{"padding-left":"50px","line-height":"40px",position:"relative"}},e.toDisplayString(s.recpowert),1)]),e.createElementVNode("view",{style:{"padding-top":"5px"}}),e.createElementVNode("view",{class:"recwave"},[e.createElementVNode("canvas",{type:"2d",class:"recwave-WaveView"})])]),e.createElementVNode("view",{style:{padding:"10px"}},[e.createElementVNode("view",{style:{margin:"0 0 6px","font-size":"12px"}},"实时识别结果: "+e.toDisplayString(s.asrTime),1),e.createElementVNode("view",{style:{padding:"15px 10px","min-height":"50px",border:"3px dashed #a2a1a1"}},e.toDisplayString(s.asrTxt),1)]),e.createElementVNode("view",{style:{"padding-top":"10px"}},[e.createVNode(o,{ref:"player"},null,512)]),e.createElementVNode("view",{style:{"padding-top":"10px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.reclogs,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.idx,style:{"border-bottom":"1px dashed #666",padding:"5px 0"}},[e.createElementVNode("view",{style:e.normalizeStyle({color:1==t.color?"red":2==t.color?"green":t.color})},e.toDisplayString(t.txt),5)])))),128))])])}]]);!function(e){var t="object"==typeof window&&!!window.document;!function(e,t){var n=e.i18n;e.CLog('Import Recorder i18n lang="en-US"'),n.alias["en-US"]="en";var r={lang:"en"};n.data.rtl$en=!1,n.data.desc$en="English, 英语。This translation mainly comes from: google translation + Baidu translation, translated from Chinese to English. 此翻译主要来自：google翻译+百度翻译，由中文翻译成英文。",n.put(r,["K8zP:Duplicate import {1}","mSxV:There are {1} GetContext unclosed","nMIy: (Note: ctx is not in the running state. At least one of rec.open and start must be called during user operations (touch, click, etc.), otherwise ctx.resume will be attempted during rec.start, which may cause compatibility issues (iOS only), please refer to the runningContext configuration in the documentation) ","ZGlf:. Due to 375 callbacks in 1 second in {1}, there may be performance problems on the mobile side, which may cause the callback to be lost and the recording to be shortened, but it will not affect the PC side. It is not recommended to enable {1} for now.","7TU0:Connect uses the old {1}, ","JwCL:But {1} is set trying to enable {2}","VGjB:Can set {1} try to enable {2}","MxX1:{1} did not return any audio, reverting to {2}","XUap:{1} redundant callback","yOta:Connect uses {1}, set {2} to restore old-fashioned {3}","VwPd: (This browser does not support {1}) ","vHnb:{1} did not return any audio, downgrade to {2}","O9P7:{1} redundant callback","LMEm:Connect uses {1}, set {2} to restore to using {3} or old-fashioned {4}","d48C:The filter sampleRate of {1} has changed, reset the filter","tlbC:{1} seems to have passed in an unreset chunk {2}","VtS4:{1} and {2} must be number","5tWi:Recording open failed: ","dFm8:open cancelled","VtJO:open interrupted","EMJq:, you can try to use the RecordApp solution ","A5bm:Cannot record: ","1iU7:This browser does not support obtaining recordings from stream","BTW2:Failed to open recording from stream: ","Nclz:No permission to record (cross domain, please try adding microphone access policy to iframe, such as: {1})","gyO5:User denied recording permission","oWNo:Browser prohibits recording of unsafe pages, which can be resolved by enabling HTTPS","jBa9:, no microphone available","COxc:This browser does not support recording","upb8:It was found that open was called multiple times at the same time","Q1GA:Invalid recording: no audio stream","xEQR:Error requesting recording permission","bDOG:Unable to record: ","RiWe:, when noiseSuppression and echoCancellation are not configured, the browser may automatically enable noise suppression and echo cancellation, and the mobile terminal may reduce the system playback volume (recovery after the recording is closed), please refer to the audioTrackSet configuration in the document.","hWVz:close is ignored (because multiple recs are open at the same time, only the last one will actually close)","UHvm:ignore","Essp:{1} architecture not supported","2XBl:{1} type does not support setting takeoffEncodeChunk","LG7e:(Encoder not loaded)","7uMV:{1} environment does not support real-time processing","4Kfd:Compensation {1}ms","bM5i:Uncompensated {1}ms","gFUF:Callback error is not allowed, you need to ensure that no exception will be thrown","2ghS:Low performance, took {1}ms","ufqH:Buffers cannot be cleared before entering async","6WmN:start failed: not open","kLDN:start recording, ","Bp2y:start was interrupted","upkE:, may fail to record: ","Xq4s:Stop and start time difference: ","3CQP:compensate: ","u8JG:Failed to stop recording: ","1skY:, please set {1}","Wv7l:Stop recording, encoding takes {1}ms, audio duration {2}ms, file size {3}b","Vkbd:{1} encoder returned not {2}","QWnr:After enabling takeoffEncodeChunk, the length of the blob returned by stop is 0 and no audio data is provided","Sz2H:Invalid generated {1}","wf9t:Recording not started","Dl2c:, No user interaction before starting recording, resulting in AudioContext not running","Ltz3:Recording not captured","xGuI:The {1} encoder is not loaded. Please try to find the {1} encoder in the src/engine directory of the {2} and load it","AxOH:Recording error: ","xkKd:Audio buffers are released","CxeT:Sampled: {1}, took: {2}ms","NonBrowser-1:Non-browser environment, does not support {1}","IllegalArgs-1:Illegal argument: {1}","NeedImport-2:Calling {1} needs to import {2} first","NotSupport-1:Not support: {1}","8HO5:Override import {1}"]),n.put(r,["b2mN:AMR-NB (NarrowBand), sampleRate setting is invalid (only 8000hz is provided), bitRate range: {1} (default 12.2kbps), one frame 20ms, {2} bytes; browsers generally do not support playing amr format, available Recorder.amr2wav() transcoding into wav playback","tQBv:AMR Info: does not match the set {1}, has been updated to {2}","q12D:Data sampleRate lower than {1}","TxjV:The current browser version is too low to process in real time","Q7p7:takeoffEncodeChunk takes over the binary data output by the AMR encoder, and only the first callback data (the first frame) contains the AMR header; when merging into an AMR file, if the first frame data is not included, the AMR header must be added at the beginning of the file: Recorder.AMR.AMR_HEADER (converted to binary), otherwise it cannot be played","6o9Z:The current environment does not support Web Worker, and the amr real-time encoder runs in the main thread","yYWs:amr worker left {1} unstopped","jOi8:amr encoder not started"]),n.put(r,["O8Gn:Ogg Vorbis, bitRate 16-100kbps, sampleRate unlimited","5si6:The current browser version is too low to process in real time","R8yz:takeoffEncodeChunk takes over the binary data output by the OggVorbis encoder. Ogg is composed of data pages. One page contains multiple frames of audio data (including a few seconds of audio, and one page of data cannot be decoded and played alone). This encoder outputs a complete page of data each time, so the real-time performance will be relatively low; when merging into a complete ogg file, all the output data must be merged together, otherwise it may not be able to play, and it does not support intercepting the middle part to decode and play separately","hB9D:The current environment does not support Web Worker, and the OggVorbis real-time encoder runs in the main thread","oTiy:There are {1} unstopped ogg workers","dIpw:ogg encoder not started"]),n.put(r,["L49q:This browser does not support webm encoding, MediaRecorder is not implemented","tsTW:Only newer browsers support it, and the compression rate is similar to mp3. Since there is no way to quickly encode the existing pcm data, the data can only be imported into MediaRecorder in a similar manner while playing and listening, and it takes a few seconds to wait for a few seconds. Although the output audio can control the file size through the bitRate, the bitRate in the audio file is not the set bitRate. Since the sampleRate is sampled by ourselves, we can do whatever we want with this encoder.","aG4z:This browser does not support converting recordings to webm format","PIX0:Error encoding webm: {1}"]),n.put(r,["d8YX:{1}; {2} audio files cannot be played directly, and can be transcoded into wav by Recorder.{2}2wav(); the sampleRate bitRate setting is invalid, fixed at 8000hz sampleRate, 16 bits, each sample is compressed into 8 bits for storage, and the audio file size is 8000 bytes/second; if you need any sampleRate support, please use Recorder.{2}_encode() Method","29UK:Data sampleRate lower than {1}","quVJ:{1} encoder not started"]),n.put(r,["Zm7L:sampleRate range: {1}; bitRate range: {2} (the sampleRate range supported by different bitRate is different, when the bitRate is less than 32kbps, the sampleRate must be less than 32000)","eGB9:{1} is not in the value range supported by mp3: {2}","zLTa:sampleRate has been updated to {1}, because {2} is not in the value range supported by mp3: {3}","yhUs:The current browser version is too low to process in real time","k9PT:The current environment does not support Web Worker, and the mp3 real-time encoder runs in the main thread","fT6M:There are {1} unstopped mp3 workers left","mPxH:mp3 encoder not started","uY9i:Does not match the set {1}, has been updated to {2}","iMSm:Fix remove {1} frame","b9zm:Remove too many frames"]),n.put(r,["fWsN:pcm is unencapsulated original audio data, pcm audio files cannot be played directly, and can be transcoded into wav by Recorder.pcm2wav(); it supports 8-bit and 16-bit bits (fill in the bitRate), and the sampleRate is unlimited","uMUJ:PCM Info: {1} bit is not supported, has been updated to {2} bit","KmRz:pcm2wav must provide sampleRate and bitRate","sDkA:pcm encoder not started"]),n.put(r,["gPSE:Supports 8-bit and 16-bit bits (fill in the bitRate), and the sampleRate is unlimited; this encoder only adds a 44-byte wav header before the pcm data, and the encoded 16-bit wav file removes the beginning 44 bytes to get pcm (note: other wav encoders may not be 44 bytes)","wyw9:WAV Info: {1} bit is not supported, has been updated to {2} bit"]),n.put(r,["0XYC:The getAudioSrc method is obsolete: please use getMediaStream directly and then assign it to audio.srcObject, it is only allowed to call this method in browsers that do not support srcObject and assign it to audio.src for compatibility","I4h4:{1} repeat start","P6Gs:The browser does not support opening {1}","JwDm: (Note: ctx is not in the running state, start needs to be called when the user operates (touch, click, etc.), otherwise it will try to perform ctx.resume, which may cause compatibility issues (only iOS), please refer to the runningContext configuration in the document) ","6DDt:start is terminated by stop","qx6X:The AudioBuffer implementation of this browser does not support dynamic features, use compatibility mode","cdOx:Environment detection timeout","S2Bu:Could not play: {1}","ZfGG:input call failed: non-pcm[Int16,...] input must be decoded or converted using transform","N4ke:input call failed: sampleRate not provided","IHZd:input call failed: sampleRate={1} of data is different from previous={2}","TZPq:{1} did not call the start method","iCFC:Browser does not support audio decoding","wE2k:Audio decoding data must be ArrayBuffer","mOaT:Audio decoding failed: {1}"]),n.put(r,["3RBa:Invalid symbol [{1}]: {2}","U212:Invalid note [{1}]: {2}","7qAD:Multiple tones must be aligned, with a difference of {1}ms","QGsW:Happy Birthday to You","emJR:For Elise","GsYy:Canon - Right Hand Notation","bSFZ:Canon"]),n.put(r,["Ikdz:The current environment does not support Web Worker and does not support calling Sonic.Async","IC5Y:There are {1} unflushed sonic workers left"]),n.put(r,["WWoj:The {2} method in {1} is not implemented, please implement this method in the {3} file or configuration file","rCAM:Recording does not start, but Native PCM data is received","t2OF:A cross-domain iframe is detected. NativeRecordReceivePCM cannot be injected into the top layer. It has listened to postMessage to be compatible with data transmission. Please implement it by yourself to forward the data received by the top layer to this iframe (no limit on layer), otherwise the recording data cannot be received.","Z2y2:Recording not started"]),n.put(r,["uXtA:Duplicate import {1}","kIBu:Called multiple times at the same time: {1}, old callbacks are discarded","ha2K:Duplicate registration {1}","wpTL:Clean resources only","bpvP:Recording not started","fLJD:The current environment does not support real-time callback and cannot be performed {1}","YnzX:Recording permission request failed: ","nwKR:Need to call {1} first","citA:This is not a browser environment. You need to import support files for this platform ({1}), or call {2} to implement the access yourself.","ecp9:Failed to start recording: ","EKmS:Cannot record: ","k7Qo:Recording started","Douz:Failed to stop recording: ","wqSH:Time difference from Start: {1}ms","g3VX:Stop recording, takes {1}ms, audio duration {2}ms, file size {3}b, {4}"])}((t?window:Object).Recorder)}(),function(e){var t="object"==typeof window&&!!window.document;!function(e,t){var n=e.i18n;e.CLog('Import Page[Recorder_UniCore] lang="en-US"');var r={lang:"en"};n.data["desc-page-Recorder_UniCore$en"]="English, 英语。This translation mainly comes from: google translation + Baidu translation, translated from Chinese to English. 此翻译主要来自：google翻译+百度翻译，由中文翻译成英文。",n.put(r,["RXs7:WeChat miniProgram requires: {1}","4ATo:Recorder-UniCore currently only supports: H5, APP (Android iOS), MP-WEIXIN, other platform environments need to write their own adaptation files to achieve access","GwCz:RecordApp.UniWebViewActivate needs to pass in the this object of the current page or component as a parameter","ipB3:An error occurred in RecordApp.UniWebViewActivate that should not occur (the plug-in code may need to be upgraded): ","WpKg:RecordApp.UniWebViewActivate has switched the WebView where the renderjs of the current page or component is located","4jKV:RecordApp.UniRenderjsRegister needs to be called in renderjs and pass in this of the current module","Uc9E:An error occurred in RecordApp.UniRenderjsRegister that should not occur (the plugin code may need to be upgraded): ","mzKj:RecordApp.UniRenderjsRegister repeatedly registers the renderjs module of the current page. Only one renderjs module is allowed to be registered in a component","7kJS:RecordApp.UniRenderjsRegister has registered the renderjs module of the current page","AGd7:You need to call the RecordApp.UniWebViewActivate method first","7ot0:You need to call the RecordApp.RequestPermission method first","VsdN:The RecordApp.RequestPermission method needs to be called again","SWsy:It is detected that another page or component has called RecordApp.UniPageOnShow (WvCid={1}), but RecordApp.UniWebViewActivate (current WvCid={2}) has not been called. Some functions will continue to use the previously Activated WebView and components. Please make sure This is in line with your business logic, not because you forgot to call UniWebViewActivate","TfJX:Currently it is not the App logic layer","peIm:RecordApp.UniWebViewActivate has not been called yet","qDo1:The WebView where renderjs for this page is not found","igw2:, RecordApp.UniWebViewEval cannot be called","lU1W:Currently it is not the App logic layer","mSbR:RecordApp.UniWebViewActivate has not been called yet","6Iql:The WebView Cid where renderjs for this page is not found","TtoS:, RecordApp.UniWebViewVueCall cannot be called","vEgr:MainReceiveBind duplicate binding that should not occur","ZHwv:[MainReceive] Unknown data sent back from renderjs: ","MujG:Only allowed to call RecordApp.UniWebViewSendBigBytesToMain in renderjs","kE91:RecordApp.UniRenderjsRegister needs to be called in mounted in renderjs to call RecordApp.UniWebViewSendBigBytesToMain","CjMb:Invalid BigBytes return data","kxOd:Non-App environment does not support saving local files","UqfI:Failed to save file {1}: ","l6sY:Setting RecordApp.UniNativeUtsPlugin is not supported in renderjs","SCW9:RecordApp.UniNativeUtsPlugin is configured, but the current App is not packaged with the native recording plug-in [{1}]","TGMm:The provided RecordApp.UniNativeUtsPlugin value is not RecordApp’s uts native recording plug-in","1f2V: | RecordApp’s uni-app support documentation and examples: {1}","XSYY:Current recording is powered by native recording plug-in","nnM6:Current recording is powered by uts plugin","fqhr:RecordApp.UniWithoutAppRenderjs is currently configured. A native recording plug-in or uts plug-in must be provided to record. Please refer to the RecordApp.UniNativeUtsPlugin configuration","xYRb:Currently RecordApp runs in the logical layer (performance will be slightly lower, and plug-ins such as visualization are not available) ","S3eF:The WebView where the renderjs of the current page is located has not been found. If there is indeed no renderjs, please set RecordApp.UniWithoutAppRenderjs=true","0hyi:The current RecordApp runs in the WebView where renderjs is located (only limited real-time processing can be done in the logic layer, and visualization and other plug-ins need to be called in renderjs) ","FabE:[License for use of {1} within the App] ","w37G:Purchased the native recording plug-in and obtained the license","e71S:Purchased uts plug-in and obtained license","aPoj:UniAppUseLicense is invalid. If you have obtained a commercial license, please fill in: {1}, otherwise please use an empty string","k7im:Canvas not found: {1}, please make sure this DOM is mounted (try $nextTick to wait for DOM update) ","dzX0:Canvas not found: {1}, please make sure this DOM is mounted (try $nextTick to wait for DOM update) ","yI24:RecordApp.UniFindCanvas does not adapt to the current environment","dl4f:{1} returned unknown content, ","H753:RecordApp.UniNativeUtsPlugin native recording plug-in is not configured","0FGq:Recording has not started and {1} cannot be called","PkQ2:RecordApp.UniWebViewActivate needs to be called first, and then RequestPermission can be called","Jk72:Non-H5 permission requests that should not appear","Y3rC:Calling plus.ios@AVAudioSession to request iOS native recording permissions","j15C:Obtained iOS native recording permissions","iKhe:plus.ios requests recording permission, status value: ","0caE:User denied recording permission","7Noe:Calling plus.android.requestPermissions to request Android native recording permissions","Bgls:Obtained Android native recording permission: ","Ruxl:plus.android requests recording permission: No permission","l7WP:User denied recording permission","0JQw:plus.android error in requesting recording permission: ","Mvl7:An error occurred in the permission request to call plus: ","ksoA:Unable to call RequestPermission: ","TSmQ:You need to provide a renderjs in the page, and import RecordApp, recording format encoder, visualization plug-in, etc.","AN0e:Need to import {1} in renderjs","XCMU:RecordApp.UniWebViewActivate needs to be called first, and then Start can be called","rSLO:Start of non-H5 recordings that should not appear","Bjx9:Unable to call Start: ","MTdp:Recording did not start, but onRecEncodeChunk returned by renderjs was received","BjGP:Recording did not start, but Uni Native PCM data was received","byzO:Recording did not start, but UniNativeUtsPlugin PCM data was received","YP4V:Recording not started","TPhg:Stop non-H5 recordings that should not appear","pP4O:Recording not started","H6cq:Unable to call Stop: ","gomD:The file data sent back by renderjs should not be lost"])}((t?window:Object).Recorder)}();const U=e=>{(e.$renderjs||(e.$renderjs=[])).push("testMainVue"),(e.$renderjsModules||(e.$renderjsModules={})).testMainVue="698ca624"};var L=v.i18n.$T;const O={components:{TestPlayer:d},data(){return{...this.getTexts(),lang:"",recType:"mp3",recSampleRate:16e3,recBitRate:16,recpowerx:0,recpowert:"",reclogs:[]}},mounted(){try{var e=uni.getStorageSync("test_page_lang")}catch(t){}e=e||(/\b(zh|cn)\b/i.test(uni.getLocale().replace(/_/g," "))?"zh-CN":"en-US"),this.setLang(e),this.reclog(L("I2MO::页面mounted",":Page mounted ")+"("+L("t795::{1}层",":{1} pages",0,getCurrentPages().length)+")，Recorder.LM="+v.LM+"，RecordApp.LM="+b.LM+"，UniSupportLM="+b.UniSupportLM+"，UniJsSource="+b.UniJsSource.IsSource),this.isMounted=!0,this.uniPage__onShow(),this.reclog(L("ry5v::正在执行Install，请勿操作...",":Install is in progress, please do not operate..."),"#f60"),b.Install((()=>{this.reclog(L("Cix5::Install成功，环境：",":Install successfully, environment: ")+this.currentKeyTag(),2),this.reclog(L("K0HW::请先请求录音权限，然后再开始录音",":Please request recording permission before starting recording"))}),(e=>{this.reclog("RecordApp.Install"+L("qrjB::出错：",": error: ")+e,1)}))},unmounted(){b.Stop(),v.i18n.lang="zh-CN"},onShow(){this.isMounted&&this.uniPage__onShow()},methods:{uniPage__onShow(){b.UniPageOnShow(this)},currentKeyTag(){if(!b.Current)return"[?]";var e="Renderjs+H5";return b.UniNativeUtsPlugin&&(e=b.UniNativeUtsPlugin.nativePlugin?"NativePlugin":"UtsPlugin"),b.Current.Key+"("+e+")"},recReq(){this.reclog(L("k6jG::正在请求录音权限...",":Requesting recording permission...")),b.UniWebViewActivate(this),b.RequestPermission((()=>{this.reclog(this.currentKeyTag()+" "+L("ueCL::已获得录音权限，可以开始录音了",":The recording permission has been obtained and you can start recording."),2)}),((e,t)=>{this.reclog(this.currentKeyTag()+" "+(t?"isUserNotAllow,":"")+L("cZuo::请求录音权限失败：",":Requesting recording permission failed: ")+e,1)}))},recStart(){this.$refs.player.setPlayBytes(null),this.reclog(this.currentKeyTag()+" "+L("HbiG::正在打开...",":Starting...")),b.UniWebViewActivate(this),b.Start({type:this.recType,sampleRate:this.recSampleRate,bitRate:this.recBitRate,onProcess:(e,t,n,r,a,s)=>{this.recpowerx=t,this.recpowert=this.formatTime(n,1)+" / "+t},onProcess_renderjs:"function(buffers,powerLevel,duration,sampleRate,newBufferIdx,asyncEnd){\n\t\t\t\t\t//App中在这里修改buffers才会改变生成的音频文件\n\t\t\t\t\t//App中是在renderjs中进行的可视化图形绘制，因此需要写在这里，this是renderjs模块的this（也可以用This变量）；如果代码比较复杂，请直接在renderjs的methods里面放个方法xxxFunc，这里直接使用this.xxxFunc(args)进行调用\n\t\t\t\t\tif(this.waveView){\n\t\t\t\t\t\tthis.waveView.input(buffers[buffers.length-1],powerLevel,sampleRate);\n\t\t\t\t\t}\n\t\t\t\t}",takeoffEncodeChunk:this.takeoffEncodeChunkSet?e=>{}:null,takeoffEncodeChunk_renderjs:this.takeoffEncodeChunkSet?"function(chunkBytes){\n\t\t\t\t\t//App中这里可以做一些仅在renderjs中才生效的事情，不提供也行，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t}":null,start_renderjs:"function(){\n\t\t\t\t\t//App中可以放一个函数，在Start成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t\t//放一些仅在renderjs中才生效的事情，比如初始化，不提供也行\n\t\t\t\t}",stop_renderjs:"function(aBuf,duration,mime){\n\t\t\t\t\t//App中可以放一个函数，在Stop成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t\t\t\t\tthis.audioData=aBuf; //留着给Stop时进行转码成wav播放\n\t\t\t\t}"},(()=>{this.reclog(this.currentKeyTag()+" "+L("jCWZ::录制中：",":Recording: ")+this.recType+" "+this.recSampleRate+" "+this.recBitRate+"kbps",2),b.UniFindCanvas(this,[".recwave-WaveView"],"\n\t\t\t\t\tthis.waveView=Recorder.WaveView({compatibleCanvas:canvas1, width:300, height:100});\n\t\t\t\t",(e=>{this.waveView=v.WaveView({compatibleCanvas:e,width:300,height:100})}))}),(e=>{this.reclog(this.currentKeyTag()+" "+L("hgDD::开始录音失败：",":Failed to start recording: ")+e,1)}))},recPause(){b.GetCurrentRecOrNull()&&(b.Pause(),this.reclog(L("BuDV::已暂停",":Paused")))},recResume(){b.GetCurrentRecOrNull()&&(b.Resume(),this.reclog(L("eWM8::继续录音中...",":Resumed")))},recStop(){this.reclog(L("xmjS::正在结束录音...",":Stopping recording...")),b.Stop(((e,t,n)=>{var r=(b.GetCurrentRecOrNull()||{set:{type:this.recType}}).set;this.reclog(L("nIyX::已录制[{1}]：{2} {3}字节",":Recorded [{1}]: {2} {3}bytes",0,n,this.formatTime(t,1),e.byteLength)+" "+r.sampleRate+"hz "+r.bitRate+"kbps",2);this.$refs.player.setPlayBytes(e,"this.audioData",t,n,r,v)}),(e=>{this.reclog(L("5VqK::结束录音失败：",":Failed to end recording:")+e,1)}))},reclog(e,t){var n=new Date,r="["+(("0"+n.getHours()).substr(-2)+":"+("0"+n.getMinutes()).substr(-2)+":"+("0"+n.getSeconds()).substr(-2))+"]"+e;a("log","at pages/recTest/page_i18n.vue:292",r),this.reclogs.splice(0,0,{txt:r,color:t})},formatTime(e,t){var n=e%1e3,r=(e=(e-n)/1e3)%60,a=(e=(e-r)/60)%60,s=(e=(e-a)/60,"");return e>0&&(s+=(e<10?"0":"")+e+":"),s+=(a<10?"0":"")+a+":",s+=(r<10?"0":"")+r,t&&(s+="″"+("00"+n).substr(-3)),s},getTexts:()=>(uni.setNavigationBarTitle({title:L("IkUi::RecordApp国际化多语言",":RecordApp internationalization in multiple languages")+" - uni-app"}),{moreLangs:L("hAh0::其他语言支持办法：复制Recorder和插件的i18n目录内的Template.js文件，改个文件名，然后翻译成对应的语言，然后在页面中引入此文件即可",":Other language support methods: Copy the Template.js file in the i18n directory of the Recorder and plug-in, change the file name, then translate it into the corresponding language, and then import this file into the page."),T_Type:L("hLSC::类型",":Type"),T_SampleRate:L("3EHL::采样率",":SampleRate"),T_BitRate:L("L2Co::比特率",":BitRate"),T_req:L("9bU5::请求录音权限",":Request recording permission"),T_start:L("JUOj::开始录音",":Start recording"),T_stop:L("aod9::停止录音",":Stop recording"),T_pause:L("J45w::暂停",":Pause"),T_resume:L("npYY::继续",":Resume")}),langClick(e){var t=e.target.dataset.lang;if(t){var n=this.lang;this.setLang(t),t!=n&&this.reclog(L("7nbd::已切换语言为：",":The language has been switched to: ")+t)}},setLang(e){uni.setStorageSync("test_page_lang",e),v.i18n.lang=e,b.UniIsApp()&&b.UniWebViewEval(this,'Recorder.i18n.lang="'+e+'"'),this.lang=e;var t=this.getTexts();for(var n in t)this[n]=t[n]}}};U(O);const D=n(O,[["render",function(t,n,r,a,s,i){const o=e.resolveComponent("TestPlayer");return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("view",{style:{padding:"10px 10px 0"}},[e.createTextVNode(" Language: "),e.createElementVNode("checkbox",{checked:"zh-CN"==s.lang,onClick:n[0]||(n[0]=(...e)=>i.langClick&&i.langClick(...e)),"data-lang":"zh-CN"},"简体中文",8,["checked"]),e.createElementVNode("checkbox",{checked:"en-US"==s.lang,onClick:n[1]||(n[1]=(...e)=>i.langClick&&i.langClick(...e)),"data-lang":"en-US"},"English",8,["checked"]),e.createElementVNode("text",{style:{"font-size":"12px",color:"#999"}},e.toDisplayString(t.moreLangs),1)]),e.createElementVNode("view",{style:{padding:"10px 10px 0"}},[e.createTextVNode(e.toDisplayString(t.T_Type)+": "+e.toDisplayString(s.recType)+" "+e.toDisplayString(t.T_SampleRate)+": ",1),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=e=>s.recSampleRate=e),style:{width:"60px",display:"inline-block",border:"1px solid #ddd"}},null,512),[[e.vModelText,s.recSampleRate,void 0,{number:!0}]]),e.createTextVNode("hz "+e.toDisplayString(t.T_BitRate)+"：",1),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":n[3]||(n[3]=e=>s.recBitRate=e),style:{width:"60px",display:"inline-block",border:"1px solid #ddd"}},null,512),[[e.vModelText,s.recBitRate,void 0,{number:!0}]]),e.createTextVNode("kbps ")]),e.createElementVNode("view",{style:{display:"flex","padding-top":"10px"}},[e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{type:"warn",onClick:n[4]||(n[4]=(...e)=>i.recReq&&i.recReq(...e)),style:e.normalizeStyle([{"font-size":"16px","line-height":"1.2",padding:"10px 15px"},{padding:t.T_req.length>10?"0 15px":""}])},e.toDisplayString(t.T_req),5)]),e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{type:"primary",onClick:n[5]||(n[5]=(...e)=>i.recStart&&i.recStart(...e)),style:{"font-size":"16px","line-height":"1.2",padding:"10px 15px"}},e.toDisplayString(t.T_start),1)]),e.createElementVNode("view",{style:{width:"10px"}}),e.createElementVNode("view",{style:{flex:"1"}},[e.createElementVNode("button",{onClick:n[6]||(n[6]=(...e)=>i.recStop&&i.recStop(...e)),style:{"font-size":"16px","line-height":"1.2",padding:"10px 15px"}},e.toDisplayString(t.T_stop),1)]),e.createElementVNode("view",{style:{width:"10px"}})]),e.createElementVNode("view",{style:{padding:"10px 10px 0"}},[e.createElementVNode("button",{size:"mini",type:"default",onClick:n[7]||(n[7]=(...e)=>i.recPause&&i.recPause(...e))},e.toDisplayString(t.T_pause),1),e.createElementVNode("button",{size:"mini",type:"default",onClick:n[8]||(n[8]=(...e)=>i.recResume&&i.recResume(...e))},e.toDisplayString(t.T_resume),1)]),e.createElementVNode("view",{style:{padding:"5px 0 0 10px"}},[e.createElementVNode("view",{style:{height:"40px",width:"300px",background:"#999",position:"relative"}},[e.createElementVNode("view",{style:e.normalizeStyle([{height:"40px",background:"#0B1",position:"absolute"},{width:s.recpowerx+"%"}])},null,4),e.createElementVNode("view",{style:{"padding-left":"50px","line-height":"40px",position:"relative"}},e.toDisplayString(s.recpowert),1)]),e.createElementVNode("view",{style:{"padding-top":"5px"}}),e.createElementVNode("view",{class:"recwave"},[e.createElementVNode("canvas",{type:"2d",class:"recwave-WaveView"})])]),e.createElementVNode("view",{style:{"padding-top":"10px"}},[e.createVNode(o,{ref:"player"},null,512)]),e.createElementVNode("view",{style:{"padding-top":"10px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.reclogs,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.idx,style:{"border-bottom":"1px dashed #666",padding:"5px 0"}},[e.createElementVNode("view",{style:e.normalizeStyle({color:1==t.color?"red":2==t.color?"green":t.color})},e.toDisplayString(t.txt),5)])))),128))])])}]]),H=e=>{(e.$renderjs||(e.$renderjs=[])).push("test_1"),(e.$renderjsModules||(e.$renderjsModules={})).test_1="39e68e20"},W={methods:{renderjsCallThis(e){var t=uni.base64ToArrayBuffer(e.base64),n=e.duration,r=e.mime;a("log","at pages/recTest/page_renderjsOnly.vue:11","renderjsCallThis: "+t.byteLength+"字节 "+n+"ms "+r)}}};H(W);const z=n(W,[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",{class:"mainView"})}]]);!function(e){var t="object"==typeof window&&!!window.document,n=(t?window:Object).Recorder,r=n.i18n;!function(e,t,n,r){var s="48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000",i="8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, 192, 224, 256, 320";e.prototype.enc_mp3={stable:!0,takeEC:"full",getTestMsg:function(){return n("Zm7L::采样率范围：{1}；比特率范围：{2}（不同比特率支持的采样率范围不同，小于32kbps时采样率需小于32000）",0,s,i)}};var o,l=function(t){var r=t.bitRate,a=t.sampleRate,o=a;if(-1==(" "+i+",").indexOf(" "+r+",")&&e.CLog(n("eGB9::{1}不在mp3支持的取值范围：{2}",0,"bitRate="+r,i),3),-1==(" "+s+",").indexOf(" "+a+",")){for(var l=s.split(", "),c=[],u=0;u<l.length;u++)c.push({v:+l[u],s:Math.abs(l[u]-a)});c.sort((function(e,t){return e.s-t.s})),o=c[0].v,t.sampleRate=o,e.CLog(n("zLTa::sampleRate已更新为{1}，因为{2}不在mp3支持的取值范围：{3}",0,o,a,s),3)}},c=function(){return n.G("NeedImport-2",["mp3.js","src/engine/mp3-engine.js"])},u=r&&"function"==typeof Worker;e.prototype.mp3=function(t,n,r){var s=this,i=s.set,o=t.length;if(e.lamejs){if(u){var p=s.mp3_start(i);if(p){if(p.isW)return s.mp3_encode(p,t),void s.mp3_complete(p,n,r,1);s.mp3_stop(p)}}l(i);var d=new e.lamejs.Mp3Encoder(1,i.sampleRate,i.bitRate),_=57600,m=new Int8Array(5e5),v=0,g=0,b=function(){try{if(g<o)var e=d.encodeBuffer(t.subarray(g,g+_));else e=d.flush()}catch(p){return a("error","at node_modules/recorder-core/src/engine/mp3.js:86",p),void r("MP3 Encoder: "+p.message)}var s=e.length;if(s>0){if(v+s>m.length){var l=new Int8Array(m.length+Math.max(5e5,s));l.set(m.subarray(0,v)),m=l}m.set(e,v),v+=s}if(g<o)g+=_,setTimeout(b);else{var c=[m.buffer.slice(0,v)],u=f.fn(c,v,o,i.sampleRate);h(u,i),n(c[0]||new ArrayBuffer(0),"audio/mp3")}};b()}else r(c())},e.BindDestroy("mp3Worker",(function(){o&&(e.CLog("mp3Worker Destroy"),o.terminate(),o=null)})),e.prototype.mp3_envCheck=function(t,r){var a="";return r.takeoffEncodeChunk&&(d()||(a=n("yhUs::当前浏览器版本太低，无法实时处理"))),a||e.lamejs||(a=c()),a},e.prototype.mp3_start=function(e){return d(e)};var p={id:0},d=function(t,r){var s,i=function(e){var t=e.data,n=s.wkScope.wk_ctxs,r=s.wkScope.wk_lame,i=s.wkScope.wk_mp3TrimFix,o=n[t.id];if("init"==t.action)n[t.id]={sampleRate:t.sampleRate,bitRate:t.bitRate,takeoff:t.takeoff,pcmSize:0,memory:new Int8Array(5e5),mOffset:0,encObj:new r.Mp3Encoder(1,t.sampleRate,t.bitRate)};else if(!o)return;var l=function(e){var t=e.length;if(o.mOffset+t>o.memory.length){var n=new Int8Array(o.memory.length+Math.max(5e5,t));n.set(o.memory.subarray(0,o.mOffset)),o.memory=n}o.memory.set(e,o.mOffset),o.mOffset+=t};switch(t.action){case"stop":o.encObj=null,delete n[t.id];break;case"encode":o.pcmSize+=t.pcm.length;try{var c=o.encObj.encodeBuffer(t.pcm)}catch(d){o.err=d,a("error","at node_modules/recorder-core/src/engine/mp3.js:191",d)}c&&c.length>0&&(o.takeoff?_.onmessage({action:"takeoff",id:t.id,chunk:c}):l(c));break;case"complete":try{c=o.encObj.flush()}catch(d){o.err=d,a("error","at node_modules/recorder-core/src/engine/mp3.js:206",d)}if(c&&c.length>0&&(o.takeoff?_.onmessage({action:"takeoff",id:t.id,chunk:c}):l(c)),o.err){_.onmessage({action:t.action,id:t.id,err:"MP3 Encoder: "+o.err.message});break}var u=[o.memory.buffer.slice(0,o.mOffset)],p=i.fn(u,o.mOffset,o.pcmSize,o.sampleRate);_.onmessage({action:t.action,id:t.id,blob:u[0]||new ArrayBuffer(0),meta:p})}},c=function(e){_.onmessage=function(t){var n=t;e&&(n=t.data);var r=p[n.id];r&&("takeoff"==n.action?r.set.takeoffEncodeChunk(new Uint8Array(n.chunk.buffer)):(r.call&&r.call(n),r.call=null))}},h=function(){var e={worker:_,set:t};return t?(e.id=++p.id,p[e.id]=e,l(t),_.postMessage({action:"init",id:e.id,sampleRate:t.sampleRate,bitRate:t.bitRate,takeoff:!!t.takeoffEncodeChunk,x:new Int16Array(5)})):_.postMessage({x:new Int16Array(5)}),e},_=o;if(r||!u)return e.CLog(n("k9PT::当前环境不支持Web Worker，mp3实时编码器运行在主线程中"),3),_={postMessage:function(e){i({data:e})}},s={wkScope:{wk_ctxs:{},wk_lame:e.lamejs,wk_mp3TrimFix:f}},c(),h();try{if(!_){var m=(i+"").replace(/[\w\$]+\.onmessage/g,"self.postMessage"),v=");wk_lame();self.onmessage="+(m=m.replace(/[\w\$]+\.wkScope/g,"wkScope"));v+=";var wkScope={ wk_ctxs:{},wk_lame:wk_lame",v+=",wk_mp3TrimFix:{rm:"+f.rm+",fn:"+f.fn+"} }";var g=e.lamejs.toString(),b=(window.URL||webkitURL).createObjectURL(new Blob(["var wk_lame=(",g,v],{type:"text/javascript"}));_=new Worker(b),setTimeout((function(){(window.URL||webkitURL).revokeObjectURL(b)}),1e4),c(1)}var w=h();return w.isW=1,o=_,w}catch(y){return _&&_.terminate(),a("error","at node_modules/recorder-core/src/engine/mp3.js:312",y),d(t,1)}};e.prototype.mp3_stop=function(t){if(t&&t.worker){t.worker.postMessage({action:"stop",id:t.id}),t.worker=null,delete p[t.id];var r=-1;for(var a in p)r++;r&&e.CLog(n("fT6M::mp3 worker剩{1}个未stop",0,r),3)}},e.prototype.mp3_encode=function(e,t){e&&e.worker&&e.worker.postMessage({action:"encode",id:e.id,pcm:t})},e.prototype.mp3_complete=function(e,t,r,a){var s=this;e&&e.worker?(e.call=function(n){a&&s.mp3_stop(e),n.err?r(n.err):(h(n.meta,e.set),t(n.blob,"audio/mp3"))},e.worker.postMessage({action:"complete",id:e.id})):r(n("mPxH::mp3编码器未start"))},e.mp3ReadMeta=function(e,t){var n="undefined"!=typeof window&&window.parseInt||"undefined"!=typeof self&&self.parseInt||parseInt,r=new Uint8Array(e[0]||[]);if(r.length<4)return null;var a=function(e,t){return("0000000"+((t||r)[e]||0).toString(2)).substr(-8)},s=a(0)+a(1),i=a(2)+a(3);if(!/^1{11}/.test(s))return null;var o={"00":2.5,10:2,11:1}[s.substr(11,2)],l={"01":3}[s.substr(13,2)],c={1:[44100,48e3,32e3],2:[22050,24e3,16e3],2.5:[11025,12e3,8e3]}[o];c&&(c=c[n(i.substr(4,2),2)]);var u=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320]][1==o?1:0][n(i.substr(0,4),2)];if(!(o&&l&&u&&c))return null;for(var p=Math.round(8*t/u),d=1==l?384:2==l||1==o?1152:576,f=d/c*1e3,h=Math.floor(d*u/8/c*1e3),_=0,m=0,v=0;v<e.length;v++){var g=e[v];if((m+=g.byteLength)>=h+3){var b=new Uint8Array(g);_="1"==a(g.byteLength-(m-(h+3)+1),b).charAt(6);break}}return _&&h++,{version:o,layer:l,sampleRate:c,bitRate:u,duration:p,size:t,hasPadding:_,frameSize:h,frameDurationFloat:f}};var f={rm:e.mp3ReadMeta,fn:function(e,t,n,r){var a=this.rm(e,t);if(!a)return{err:"mp3 unknown format"};var s=Math.round(n/r*1e3),i=Math.floor((a.duration-s)/a.frameDurationFloat);if(i>0){var o=i*a.frameSize-(a.hasPadding?1:0);t-=o;for(var l=0,c=[],u=0;u<e.length;u++){var p=e[u];if(o<=0)break;o>=p.byteLength?(o-=p.byteLength,c.push(p),e.splice(u,1),u--):(e[u]=p.slice(o),l=p,o=0)}if(!this.rm(e,t)){l&&(e[0]=l);for(u=0;u<c.length;u++)e.splice(u,0,c[u]);a.err="mp3 fix error: 已还原，错误原因不明"}var d=a.trimFix={};d.remove=i,d.removeDuration=Math.round(i*a.frameDurationFloat),d.duration=Math.round(8*t/a.bitRate)}return a}},h=function(t,r){var a="MP3 Info: ";(t.sampleRate&&t.sampleRate!=r.sampleRate||t.bitRate&&t.bitRate!=r.bitRate)&&(e.CLog(a+n("uY9i::和设置的不匹配{1}，已更新成{2}",0,"set:"+r.bitRate+"kbps "+r.sampleRate+"hz","set:"+t.bitRate+"kbps "+t.sampleRate+"hz"),3,r),r.sampleRate=t.sampleRate,r.bitRate=t.bitRate);var s=t.trimFix;s?(a+=n("iMSm::Fix移除{1}帧",0,s.remove)+" "+s.removeDuration+"ms -> "+s.duration+"ms",s.remove>2&&(t.err=(t.err?t.err+", ":"")+n("b9zm::移除帧数过多"))):a+=(t.duration||"-")+"ms",t.err?e.CLog(a,1,t.err,t):e.CLog(a,t)}}(n,0,r.$T,t)}(),function(e){function t(){var e=function(e){return Math.log(e)/Math.log(10)},n=function(e){throw new Error("abort("+e+")")};function r(e){return new Int8Array(e)}function a(e){return new Int16Array(e)}function s(e){return new Int32Array(e)}function i(e){return new Float32Array(e)}function o(e){return new Float64Array(e)}function l(e){if(1==e.length)return i(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(l(e));return n}function c(e){if(1==e.length)return s(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(c(e));return n}function u(e){if(1==e.length)return a(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(u(e));return n}function p(e){if(1==e.length)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var n=[],r=0;r<t;r++)n.push(p(e));return n}var d={fill:function(e,t,n,r){if(2==arguments.length)for(var a=0;a<e.length;a++)e[a]=arguments[1];else for(a=t;a<n;a++)e[a]=r}},f={arraycopy:function(e,t,n,r,a){for(var s=t+a;t<s;)n[r++]=e[t++]}},h={};function _(e){this.ordinal=e}h.SQRT2=1.4142135623730951,h.FAST_LOG10=function(t){return e(t)},h.FAST_LOG10_X=function(t,n){return e(t)*n},_.short_block_allowed=new _(0),_.short_block_coupled=new _(1),_.short_block_dispensed=new _(2),_.short_block_forced=new _(3);var m={};function v(e){this.ordinal=e}function g(e){var t=e;this.ordinal=function(){return t}}function b(){var e=3,t=98,n=4;this.getLameShortVersion=function(){return e+"."+t+"."+n}}function w(){var e=null;function t(e){this.bits=0|e}this.qupvt=null,this.setModules=function(t){this.qupvt=t,e=t};var r=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function a(e,t,n,r,a,s){var i=.5946/t;for(e>>=1;0!=e--;)a[s++]=i>n[r++]?0:1,a[s++]=i>n[r++]?0:1}function i(t,n,r,a,s,i){var o=(t>>=1)%2;for(t>>=1;0!=t--;){var l,c,u,p,d,f,h,_;l=r[a++]*n,c=r[a++]*n,d=0|l,u=r[a++]*n,f=0|c,p=r[a++]*n,h=0|u,l+=e.adj43[d],_=0|p,c+=e.adj43[f],s[i++]=0|l,u+=e.adj43[h],s[i++]=0|c,p+=e.adj43[_],s[i++]=0|u,s[i++]=0|p}0!=o&&(d=0|(l=r[a++]*n),f=0|(c=r[a++]*n),l+=e.adj43[d],c+=e.adj43[f],s[i++]=0|l,s[i++]=0|c)}function o(t,r,s,o,l){var c,u,p,f=0,h=0,_=0,m=0,v=r,g=0,b=v,w=0,y=t,S=0;for(p=null!=l&&o.global_gain==l.global_gain,u=o.block_type==z.SHORT_TYPE?38:21,c=0;c<=u;c++){var R=-1;if((p||o.block_type==z.NORM_TYPE)&&(R=o.global_gain-(o.scalefac[c]+(0!=o.preflag?e.pretab[c]:0)<<o.scalefac_scale+1)-8*o.subblock_gain[o.window[c]]),p&&l.step[c]==R)0!=h&&(i(h,s,y,S,b,w),h=0),0!=_&&n();else{var k,A=o.width[c];if(f+o.width[c]>o.max_nonzero_coeff&&(k=o.max_nonzero_coeff-f+1,d.fill(r,o.max_nonzero_coeff,576,0),(A=k)<0&&(A=0),c=u+1),0==h&&0==_&&(b=v,w=g,y=t,S=m),null!=l&&l.sfb_count1>0&&c>=l.sfb_count1&&l.step[c]>0&&R>=l.step[c]?(0!=h&&(i(h,s,y,S,b,w),h=0,b=v,w=g,y=t,S=m),_+=A):(0!=_&&(a(_,s,y,S,b,w),_=0,b=v,w=g,y=t,S=m),h+=A),A<=0){0!=_&&n(),0!=h&&n();break}}c<=u&&(g+=o.width[c],m+=o.width[c],f+=o.width[c])}0!=h&&(i(h,s,y,S,b,w),h=0),0!=_&&n()}function l(e,t,n){var r=0,a=0;do{var s=e[t++],i=e[t++];r<s&&(r=s),a<i&&(a=i)}while(t<n);return r<a&&(r=a),r}function c(e,t,n,r,a,s){var i,o=65536*x.ht[r].xlen+x.ht[a].xlen,l=0;do{var c=e[t++],u=e[t++];0!=c&&(c>14&&(c=15,l+=o),c*=16),0!=u&&(u>14&&(u=15,l+=o),c+=u),l+=x.largetbl[c]}while(t<n);return i=65535&l,(l>>=16)>i&&(l=i,r=a),s.bits+=l,r}function u(e,t,n,r){var a=0,s=x.ht[1].hlen;do{var i=2*e[t+0]+e[t+1];t+=2,a+=s[i]}while(t<n);return r.bits+=a,1}function p(e,t,n,r,a){var s,i,o=0,l=x.ht[r].xlen;i=2==r?x.table23:x.table56;do{var c=e[t+0]*l+e[t+1];t+=2,o+=i[c]}while(t<n);return s=65535&o,(o>>=16)>s&&(o=s,r++),a.bits+=o,r}function f(e,t,n,r,a){var s=0,i=0,o=0,l=x.ht[r].xlen,c=x.ht[r].hlen,u=x.ht[r+1].hlen,p=x.ht[r+2].hlen;do{var d=e[t+0]*l+e[t+1];t+=2,s+=c[d],i+=u[d],o+=p[d]}while(t<n);var f=r;return s>i&&(s=i,f++),s>o&&(s=o,f=r+2),a.bits+=s,f}var h=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function _(e,t,r,a){var s=l(e,t,r);switch(s){case 0:return s;case 1:return u(e,t,r,a);case 2:case 3:return p(e,t,r,h[s-1],a);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return f(e,t,r,h[s-1],a);default:var i,o;for(s>I.IXMAX_VAL&&n(),s-=15,i=24;i<32&&!(x.ht[i].linmax>=s);i++);for(o=i-8;o<24&&!(x.ht[o].linmax>=s);o++);return c(e,t,r,o,i,a)}}function m(e,n,r,a,s,i,o){for(var l=n.big_values,c=0;c<=22;c++)a[c]=I.LARGE_BITS;for(c=0;c<16;c++){var u=e.scalefac_band.l[c+1];if(u>=l)break;var p=0,d=new t(p),f=_(r,0,u,d);p=d.bits;for(var h=0;h<8;h++){var m=e.scalefac_band.l[c+h+2];if(m>=l)break;var v=p,g=_(r,u,m,d=new t(v));v=d.bits,a[c+h]>v&&(a[c+h]=v,s[c+h]=c,i[c+h]=f,o[c+h]=g)}}}function v(e,n,r,a,s,i,o,l){for(var c=n.big_values,u=2;u<z.SBMAX_l+1;u++){var p=e.scalefac_band.l[u];if(p>=c)break;var d=s[u-2]+n.count1bits;if(r.part2_3_length<=d)break;var f=new t(d),h=_(a,p,c,f);d=f.bits,r.part2_3_length<=d||(r.assign(n),r.part2_3_length=d,r.region0_count=i[u-2],r.region1_count=u-2-i[u-2],r.table_select[0]=o[u-2],r.table_select[1]=l[u-2],r.table_select[2]=h)}}this.noquant_count_bits=function(e,r,a){var s=r.l3_enc,i=Math.min(576,r.max_nonzero_coeff+2>>1<<1);for(null!=a&&(a.sfb_count1=0);i>1&&0==(s[i-1]|s[i-2]);i-=2);r.count1=i;for(var o=0,l=0;i>3;i-=4){var c;if((2147483647&(s[i-1]|s[i-2]|s[i-3]|s[i-4]))>1)break;c=2*(2*(2*s[i-4]+s[i-3])+s[i-2])+s[i-1],o+=x.t32l[c],l+=x.t33l[c]}var u=o;if(r.count1table_select=0,o>l&&(u=l,r.count1table_select=1),r.count1bits=u,r.big_values=i,0==i)return u;if(r.block_type==z.SHORT_TYPE)(o=3*e.scalefac_band.s[3])>r.big_values&&(o=r.big_values),l=r.big_values;else if(r.block_type==z.NORM_TYPE){if(o=r.region0_count=e.bv_scf[i-2],l=r.region1_count=e.bv_scf[i-1],l=e.scalefac_band.l[o+l+2],o=e.scalefac_band.l[o+1],l<i){var p=new t(u);r.table_select[2]=_(s,l,i,p),u=p.bits}}else r.region0_count=7,r.region1_count=z.SBMAX_l-1-7-1,(o=e.scalefac_band.l[8])>(l=i)&&(o=l);if(o=Math.min(o,i),l=Math.min(l,i),0<o&&(p=new t(u),r.table_select[0]=_(s,0,o,p),u=p.bits),o<l&&(p=new t(u),r.table_select[1]=_(s,o,l,p),u=p.bits),2==e.use_best_huffman&&n(),null!=a&&r.block_type==z.NORM_TYPE){for(var d=0;e.scalefac_band.l[d]<r.big_values;)d++;a.sfb_count1=d}return u},this.count_bits=function(t,r,a,s){var i=a.l3_enc,l=I.IXMAX_VAL/e.IPOW20(a.global_gain);return a.xrpow_max>l?I.LARGE_BITS:(o(r,i,e.IPOW20(a.global_gain),a,s),0!=(2&t.substep_shaping)&&n(),this.noquant_count_bits(t,a,s))},this.best_huffman_divide=function(e,n){var r=new L,a=n.l3_enc,i=s(23),o=s(23),l=s(23),c=s(23);if(n.block_type!=z.SHORT_TYPE||1!=e.mode_gr){r.assign(n),n.block_type==z.NORM_TYPE&&(m(e,n,a,i,o,l,c),v(e,r,n,a,i,o,l,c));var u=r.big_values;if(!(0==u||(a[u-2]|a[u-1])>1||(u=n.count1+2)>576)){r.assign(n),r.count1=u;for(var p=0,d=0;u>r.big_values;u-=4){var f=2*(2*(2*a[u-4]+a[u-3])+a[u-2])+a[u-1];p+=x.t32l[f],d+=x.t33l[f]}if(r.big_values=u,r.count1table_select=0,p>d&&(p=d,r.count1table_select=1),r.count1bits=p,r.block_type==z.NORM_TYPE)v(e,r,n,a,i,o,l,c);else{if(r.part2_3_length=p,(p=e.scalefac_band.l[8])>u&&(p=u),p>0){var h=new t(r.part2_3_length);r.table_select[0]=_(a,0,p,h),r.part2_3_length=h.bits}u>p&&(h=new t(r.part2_3_length),r.table_select[1]=_(a,p,u,h),r.part2_3_length=h.bits),n.part2_3_length>r.part2_3_length&&n.assign(r)}}}};var g=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],b=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],y=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],S=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];function R(e,t){for(var n,r=t.tt[1][e],a=t.tt[0][e],s=0;s<x.scfsi_band.length-1;s++){for(n=x.scfsi_band[s];n<x.scfsi_band[s+1]&&!(a.scalefac[n]!=r.scalefac[n]&&r.scalefac[n]>=0);n++);if(n==x.scfsi_band[s+1]){for(n=x.scfsi_band[s];n<x.scfsi_band[s+1];n++)r.scalefac[n]=-1;t.scfsi[e][s]=1}}var i=0,o=0;for(n=0;n<11;n++)-1!=r.scalefac[n]&&(o++,i<r.scalefac[n]&&(i=r.scalefac[n]));for(var l=0,c=0;n<z.SBPSY_l;n++)-1!=r.scalefac[n]&&(c++,l<r.scalefac[n]&&(l=r.scalefac[n]));for(s=0;s<16;s++)if(i<g[s]&&l<b[s]){var u=y[s]*o+S[s]*c;r.part2_length>u&&(r.part2_length=u,r.scalefac_compress=s)}}w.slen1_tab=y,w.slen2_tab=S,this.best_scalefac_store=function(t,n,r,a){var s,i,o,l,c=a.tt[n][r],u=0;for(o=0,s=0;s<c.sfbmax;s++){var p=c.width[s];for(o+=p,l=-p;l<0&&0==c.l3_enc[l+o];l++);0==l&&(c.scalefac[s]=u=-2)}if(0==c.scalefac_scale&&0==c.preflag){var d=0;for(s=0;s<c.sfbmax;s++)c.scalefac[s]>0&&(d|=c.scalefac[s]);if(0==(1&d)&&0!=d){for(s=0;s<c.sfbmax;s++)c.scalefac[s]>0&&(c.scalefac[s]>>=1);c.scalefac_scale=u=1}}if(0==c.preflag&&c.block_type!=z.SHORT_TYPE&&2==t.mode_gr){for(s=11;s<z.SBPSY_l&&!(c.scalefac[s]<e.pretab[s]&&-2!=c.scalefac[s]);s++);if(s==z.SBPSY_l){for(s=11;s<z.SBPSY_l;s++)c.scalefac[s]>0&&(c.scalefac[s]-=e.pretab[s]);c.preflag=u=1}}for(i=0;i<4;i++)a.scfsi[r][i]=0;for(2==t.mode_gr&&1==n&&a.tt[0][r].block_type!=z.SHORT_TYPE&&a.tt[1][r].block_type!=z.SHORT_TYPE&&(R(r,a),u=0),s=0;s<c.sfbmax;s++)-2==c.scalefac[s]&&(c.scalefac[s]=0);0!=u&&(2==t.mode_gr?this.scale_bitcount(c):this.scale_bitcount_lsf(t,c))};var k=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],A=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],T=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(t){var n,r,a,s=0,i=0,o=t.scalefac;if(t.block_type==z.SHORT_TYPE)a=k,0!=t.mixed_block_flag&&(a=A);else if(a=T,0==t.preflag){for(r=11;r<z.SBPSY_l&&!(o[r]<e.pretab[r]);r++);if(r==z.SBPSY_l)for(t.preflag=1,r=11;r<z.SBPSY_l;r++)o[r]-=e.pretab[r]}for(r=0;r<t.sfbdivide;r++)s<o[r]&&(s=o[r]);for(;r<t.sfbmax;r++)i<o[r]&&(i=o[r]);for(t.part2_length=I.LARGE_BITS,n=0;n<16;n++)s<g[n]&&i<b[n]&&t.part2_length>a[n]&&(t.part2_length=a[n],t.scalefac_compress=n);return t.part2_length==I.LARGE_BITS};var C=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(t,n){var r,a,i,o,l,c,u,p,d=s(4),f=n.scalefac;for(r=0!=n.preflag?2:0,u=0;u<4;u++)d[u]=0;if(n.block_type==z.SHORT_TYPE){a=1;var h=e.nr_of_sfb_block[r][a];for(p=0,i=0;i<4;i++)for(o=h[i]/3,u=0;u<o;u++,p++)for(l=0;l<3;l++)f[3*p+l]>d[i]&&(d[i]=f[3*p+l])}else for(a=0,h=e.nr_of_sfb_block[r][a],p=0,i=0;i<4;i++)for(o=h[i],u=0;u<o;u++,p++)f[p]>d[i]&&(d[i]=f[p]);for(c=!1,i=0;i<4;i++)d[i]>C[r][i]&&(c=!0);if(!c){var _,m,v,g;for(n.sfb_partition_table=e.nr_of_sfb_block[r][a],i=0;i<4;i++)n.slen[i]=E[d[i]];switch(_=n.slen[0],m=n.slen[1],v=n.slen[2],g=n.slen[3],r){case 0:n.scalefac_compress=(5*_+m<<4)+(v<<2)+g;break;case 1:n.scalefac_compress=400+(5*_+m<<2)+v;break;case 2:n.scalefac_compress=500+3*_+m}}if(!c)for(n.part2_length=0,i=0;i<4;i++)n.part2_length+=n.slen[i]*n.sfb_partition_table[i];return c};var E=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(e){for(var t=2;t<=576;t+=2){for(var n,a=0;e.scalefac_band.l[++a]<t;);for(n=r[a][0];e.scalefac_band.l[n+1]>t;)n--;for(n<0&&(n=r[a][0]),e.bv_scf[t-2]=n,n=r[a][1];e.scalefac_band.l[n+e.bv_scf[t-2]+2]>t;)n--;n<0&&(n=r[a][1]),e.bv_scf[t-1]=n}}}function y(){}function S(){function e(e,t,n,r,a,s,i,o,l,c,u,p,d,f){this.quant_comp=t,this.quant_comp_s=n,this.safejoint=r,this.nsmsfix=a,this.st_lrm=s,this.st_s=i,this.nsbass=o,this.scale=l,this.masking_adj=c,this.ath_lower=u,this.ath_curve=p,this.interch=d,this.sfscale=f}var t;function r(e,t,r){n()}this.setModules=function(e){t=e};var a=[new e(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new e(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new e(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new e(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new e(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new e(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new e(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new e(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new e(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new e(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new e(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new e(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new e(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new e(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new e(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new e(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new e(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function s(e,n,r){var s=n,i=t.nearestBitrateFullIndex(n);if(e.VBR=v.vbr_abr,e.VBR_mean_bitrate_kbps=s,e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320),e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.brate=e.VBR_mean_bitrate_kbps,e.VBR_mean_bitrate_kbps>320&&(e.disable_reservoir=!0),a[i].safejoint>0&&(e.exp_nspsytune=2|e.exp_nspsytune),a[i].sfscale>0&&(e.internal_flags.noise_shaping=2),Math.abs(a[i].nsbass)>0){var o=int(4*a[i].nsbass);o<0&&(o+=64),e.exp_nspsytune=e.exp_nspsytune|o<<2}return 0!=r?e.quant_comp=a[i].quant_comp:Math.abs(e.quant_comp- -1)>0||(e.quant_comp=a[i].quant_comp),0!=r?e.quant_comp_short=a[i].quant_comp_s:Math.abs(e.quant_comp_short- -1)>0||(e.quant_comp_short=a[i].quant_comp_s),0!=r?e.msfix=a[i].nsmsfix:Math.abs(e.msfix- -1)>0||(e.msfix=a[i].nsmsfix),0!=r?e.internal_flags.nsPsy.attackthre=a[i].st_lrm:Math.abs(e.internal_flags.nsPsy.attackthre- -1)>0||(e.internal_flags.nsPsy.attackthre=a[i].st_lrm),0!=r?e.internal_flags.nsPsy.attackthre_s=a[i].st_s:Math.abs(e.internal_flags.nsPsy.attackthre_s- -1)>0||(e.internal_flags.nsPsy.attackthre_s=a[i].st_s),0!=r?e.scale=a[i].scale:Math.abs(e.scale- -1)>0||(e.scale=a[i].scale),0!=r?e.maskingadjust=a[i].masking_adj:Math.abs(e.maskingadjust-0)>0||(e.maskingadjust=a[i].masking_adj),a[i].masking_adj>0?0!=r?e.maskingadjust_short=.9*a[i].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=.9*a[i].masking_adj):0!=r?e.maskingadjust_short=1.1*a[i].masking_adj:Math.abs(e.maskingadjust_short-0)>0||(e.maskingadjust_short=1.1*a[i].masking_adj),0!=r?e.ATHlower=-a[i].ath_lower/10:Math.abs(10*-e.ATHlower-0)>0||(e.ATHlower=-a[i].ath_lower/10),0!=r?e.ATHcurve=a[i].ath_curve:Math.abs(e.ATHcurve- -1)>0||(e.ATHcurve=a[i].ath_curve),0!=r?e.interChRatio=a[i].interch:Math.abs(e.interChRatio- -1)>0||(e.interChRatio=a[i].interch),n}this.apply_preset=function(e,t,n){switch(t){case G.R3MIX:t=G.V3,e.VBR=v.vbr_mtrh;break;case G.MEDIUM:t=G.V4,e.VBR=v.vbr_rh;break;case G.MEDIUM_FAST:t=G.V4,e.VBR=v.vbr_mtrh;break;case G.STANDARD:t=G.V2,e.VBR=v.vbr_rh;break;case G.STANDARD_FAST:t=G.V2,e.VBR=v.vbr_mtrh;break;case G.EXTREME:t=G.V0,e.VBR=v.vbr_rh;break;case G.EXTREME_FAST:t=G.V0,e.VBR=v.vbr_mtrh;break;case G.INSANE:return t=320,e.preset=t,s(e,t,n),e.VBR=v.vbr_off,t}switch(e.preset=t,t){case G.V9:case G.V8:case G.V7:case G.V6:case G.V5:case G.V4:case G.V3:case G.V2:case G.V1:case G.V0:return r(),t}return 8<=t&&t<=320?s(e,t,n):(e.preset=0,t)}}function R(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,r){var a,s=t.internal_flags,i=s.l3_side,o=e.getframebits(t);r.bits=(o-8*s.sideinfo_len)/s.mode_gr;var l=2048*s.mode_gr-8;t.brate>320?n():(a=11520,t.strict_ISO&&n()),s.ResvMax=a-o,s.ResvMax>l&&(s.ResvMax=l),(s.ResvMax<0||t.disable_reservoir)&&(s.ResvMax=0);var c=r.bits*s.mode_gr+Math.min(s.ResvSize,s.ResvMax);return c>a&&(c=a),i.resvDrain_pre=0,null!=s.pinfo&&n(),c},this.ResvMaxBits=function(e,t,n,r){var a,s=e.internal_flags,i=s.ResvSize,o=s.ResvMax;0!=r&&(i+=t),0!=(1&s.substep_shaping)&&(o*=.9),n.bits=t,10*i>9*o?(a=i-9*o/10,n.bits+=a,s.substep_shaping|=128):(a=0,s.substep_shaping&=127,e.disable_reservoir||0!=(1&s.substep_shaping)||(n.bits-=.1*t));var l=i<6*s.ResvMax/10?i:6*s.ResvMax/10;return(l-=a)<0&&(l=0),l},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var n,r=e.l3_side;e.ResvSize+=t*e.mode_gr;var a=0;r.resvDrain_post=0,r.resvDrain_pre=0,0!=(n=e.ResvSize%8)&&(a+=n),(n=e.ResvSize-a-e.ResvMax)>0&&(a+=n);var s=Math.min(8*r.main_data_begin,a)/8;r.resvDrain_pre+=8*s,a-=8*s,e.ResvSize-=8*s,r.main_data_begin-=s,r.resvDrain_post+=a,e.ResvSize-=a}}function k(){this.setModules=function(e,t,n){};var e=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function t(t,n){return n=n>>8^e[255&(n^t)]}this.updateMusicCRC=function(e,n,r,a){for(var s=0;s<a;++s)e[0]=t(n[r+s],e[0])}}function A(){var e=this,t=null,a=null;this.setModules=function(e,n,r,s){t=r,a=s};var i=null,o=0,l=0,c=0;function u(e){f.arraycopy(e.header[e.w_ptr].buf,0,i,l,e.sideinfo_len),l+=e.sideinfo_len,o+=8*e.sideinfo_len,e.w_ptr=e.w_ptr+1&K.MAX_HEADER_BUF-1}function p(e,t,n){for(;n>0;){var r;0==c&&(c=8,l++,e.header[e.w_ptr].write_timing==o&&u(e),i[l]=0),n-=r=Math.min(n,c),c-=r,i[l]|=t>>n<<c,o+=r}}function h(e,n){var r,a=e.internal_flags;if(n>=8&&(p(a,76,8),n-=8),n>=8&&(p(a,65,8),n-=8),n>=8&&(p(a,77,8),n-=8),n>=8&&(p(a,69,8),n-=8),n>=32){var s=t.getLameShortVersion();if(n>=32)for(r=0;r<s.length&&n>=8;++r)n-=8,p(a,s.charCodeAt(r),8)}for(;n>=1;n-=1)p(a,a.ancillary_flag,1),a.ancillary_flag^=e.disable_reservoir?0:1}function _(e,t,n){for(var r=e.header[e.h_ptr].ptr;n>0;){var a=Math.min(n,8-(7&r));n-=a,e.header[e.h_ptr].buf[r>>3]|=t>>n<<8-(7&r)-a,r+=a}e.header[e.h_ptr].ptr=r}function m(e,t){var r,a,s,i=e.internal_flags;if(r=i.l3_side,i.header[i.h_ptr].ptr=0,d.fill(i.header[i.h_ptr].buf,0,i.sideinfo_len,0),e.out_samplerate<16e3?_(i,4094,12):_(i,4095,12),_(i,e.version,1),_(i,1,2),_(i,e.error_protection?0:1,1),_(i,i.bitrate_index,4),_(i,i.samplerate_index,2),_(i,i.padding,1),_(i,e.extension,1),_(i,e.mode.ordinal(),2),_(i,i.mode_ext,2),_(i,e.copyright,1),_(i,e.original,1),_(i,e.emphasis,2),e.error_protection&&_(i,0,16),1==e.version){for(_(i,r.main_data_begin,9),2==i.channels_out?_(i,r.private_bits,3):_(i,r.private_bits,5),s=0;s<i.channels_out;s++){var o;for(o=0;o<4;o++)_(i,r.scfsi[s][o],1)}for(a=0;a<2;a++)for(s=0;s<i.channels_out;s++)_(i,(l=r.tt[a][s]).part2_3_length+l.part2_length,12),_(i,l.big_values/2,9),_(i,l.global_gain,8),_(i,l.scalefac_compress,4),l.block_type!=z.NORM_TYPE?(_(i,1,1),_(i,l.block_type,2),_(i,l.mixed_block_flag,1),14==l.table_select[0]&&(l.table_select[0]=16),_(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),_(i,l.table_select[1],5),_(i,l.subblock_gain[0],3),_(i,l.subblock_gain[1],3),_(i,l.subblock_gain[2],3)):(_(i,0,1),14==l.table_select[0]&&(l.table_select[0]=16),_(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),_(i,l.table_select[1],5),14==l.table_select[2]&&(l.table_select[2]=16),_(i,l.table_select[2],5),_(i,l.region0_count,4),_(i,l.region1_count,3)),_(i,l.preflag,1),_(i,l.scalefac_scale,1),_(i,l.count1table_select,1)}else for(_(i,r.main_data_begin,8),_(i,r.private_bits,i.channels_out),a=0,s=0;s<i.channels_out;s++){var l;_(i,(l=r.tt[a][s]).part2_3_length+l.part2_length,12),_(i,l.big_values/2,9),_(i,l.global_gain,8),_(i,l.scalefac_compress,9),l.block_type!=z.NORM_TYPE?(_(i,1,1),_(i,l.block_type,2),_(i,l.mixed_block_flag,1),14==l.table_select[0]&&(l.table_select[0]=16),_(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),_(i,l.table_select[1],5),_(i,l.subblock_gain[0],3),_(i,l.subblock_gain[1],3),_(i,l.subblock_gain[2],3)):(_(i,0,1),14==l.table_select[0]&&(l.table_select[0]=16),_(i,l.table_select[0],5),14==l.table_select[1]&&(l.table_select[1]=16),_(i,l.table_select[1],5),14==l.table_select[2]&&(l.table_select[2]=16),_(i,l.table_select[2],5),_(i,l.region0_count,4),_(i,l.region1_count,3)),_(i,l.scalefac_scale,1),_(i,l.count1table_select,1)}e.error_protection&&n();var c=i.h_ptr;i.h_ptr=c+1&K.MAX_HEADER_BUF-1,i.header[i.h_ptr].write_timing=i.header[c].write_timing+t,i.h_ptr,i.w_ptr}function v(e,t){var n,r=x.ht[t.count1table_select+32],a=0,s=t.big_values,i=t.big_values;for(n=(t.count1-t.big_values)/4;n>0;--n){var o=0,l=0;0!=t.l3_enc[s+0]&&(l+=8,t.xr[i+0]<0&&o++),0!=t.l3_enc[s+1]&&(l+=4,o*=2,t.xr[i+1]<0&&o++),0!=t.l3_enc[s+2]&&(l+=2,o*=2,t.xr[i+2]<0&&o++),0!=t.l3_enc[s+3]&&(l++,o*=2,t.xr[i+3]<0&&o++),s+=4,i+=4,p(e,o+r.table[l],r.hlen[l]),a+=r.hlen[l]}return a}function g(e,t,n,r,a){var s=x.ht[t],i=0;if(0==t)return i;for(var o=n;o<r;o+=2){var l=0,c=0,u=s.xlen,d=s.xlen,f=0,h=a.l3_enc[o],_=a.l3_enc[o+1];0!=h&&(a.xr[o]<0&&f++,l--),t>15&&(h>14&&(f|=h-15<<1,c=u,h=15),_>14&&(f<<=u,f|=_-15,c+=u,_=15),d=16),0!=_&&(f<<=1,a.xr[o+1]<0&&f++,l--),h=h*d+_,c-=l,l+=s.hlen[h],p(e,s.table[h],l),p(e,f,c),i+=l+c}return i}function b(e,t){var n=3*e.scalefac_band.s[3];n>t.big_values&&(n=t.big_values);var r=g(e,t.table_select[0],0,n,t);return r+=g(e,t.table_select[1],n,t.big_values,t)}function y(e,t){var n,r,a,s;n=t.big_values;var i=t.region0_count+1;return a=e.scalefac_band.l[i],i+=t.region1_count+1,a>n&&(a=n),(s=e.scalefac_band.l[i])>n&&(s=n),r=g(e,t.table_select[0],0,a,t),r+=g(e,t.table_select[1],a,s,t),r+=g(e,t.table_select[2],s,n,t)}function S(e){var t,n,r,a,s=0,i=e.internal_flags,o=i.l3_side;if(1==e.version)for(t=0;t<2;t++)for(n=0;n<i.channels_out;n++){var l=o.tt[t][n],c=w.slen1_tab[l.scalefac_compress],u=w.slen2_tab[l.scalefac_compress];for(a=0,r=0;r<l.sfbdivide;r++)-1!=l.scalefac[r]&&(p(i,l.scalefac[r],c),a+=c);for(;r<l.sfbmax;r++)-1!=l.scalefac[r]&&(p(i,l.scalefac[r],u),a+=u);l.block_type==z.SHORT_TYPE?a+=b(i,l):a+=y(i,l),s+=a+=v(i,l)}else for(t=0,n=0;n<i.channels_out;n++){var d,f,h=0;if(a=0,r=0,f=0,(l=o.tt[t][n]).block_type==z.SHORT_TYPE){for(;f<4;f++){var _=l.sfb_partition_table[f]/3,m=l.slen[f];for(d=0;d<_;d++,r++)p(i,Math.max(l.scalefac[3*r+0],0),m),p(i,Math.max(l.scalefac[3*r+1],0),m),p(i,Math.max(l.scalefac[3*r+2],0),m),h+=3*m}a+=b(i,l)}else{for(;f<4;f++)for(_=l.sfb_partition_table[f],m=l.slen[f],d=0;d<_;d++,r++)p(i,Math.max(l.scalefac[r],0),m),h+=m;a+=y(i,l)}s+=h+(a+=v(i,l))}return s}function R(){this.total=0}function k(t,r){var a,s,i,c=t.internal_flags;return c.w_ptr,-1==(i=c.h_ptr-1)&&(i=K.MAX_HEADER_BUF-1),a=c.header[i].write_timing-o,r.total=a,a>=0&&n(),a+=s=e.getframebits(t),r.total+=s,r.total%8!=0?r.total=1+r.total/8:r.total=r.total/8,r.total+=l+1,a}this.getframebits=function(e){var t,n=e.internal_flags;return t=0!=n.bitrate_index?x.bitrate_table[e.version][n.bitrate_index]:e.brate,8*(0|72e3*(e.version+1)*t/e.out_samplerate+n.padding)},this.flush_bitstream=function(e){var t,r,a=e.internal_flags;a.h_ptr,t=a.l3_side,(r=k(e,new R))<0||(h(e,r),a.ResvSize=0,t.main_data_begin=0,a.findReplayGain&&n(),a.findPeakSample&&n())},this.format_bitstream=function(e){var t,n=e.internal_flags;t=n.l3_side;var r=this.getframebits(e);h(e,t.resvDrain_pre),m(e,r);var a=8*n.sideinfo_len;if(a+=S(e),h(e,t.resvDrain_post),a+=t.resvDrain_post,t.main_data_begin+=(r-a)/8,k(e,new R),n.ResvSize,8*t.main_data_begin!=n.ResvSize&&(n.ResvSize=8*t.main_data_begin),o>1e9){var s;for(s=0;s<K.MAX_HEADER_BUF;++s)n.header[s].write_timing-=o;o=0}return 0},this.copy_buffer=function(e,t,r,o,u){var p=l+1;if(p<=0)return 0;if(0!=o&&p>o)return-1;if(f.arraycopy(i,0,t,r,p),l=-1,c=0,0!=u){var d=s(1);d[0]=e.nMusicCRC,a.updateMusicCRC(d,t,r,p),e.nMusicCRC=d[0],p>0&&(e.VBR_seek_table.nBytesWritten+=p),e.decode_on_the_fly&&n()}return p},this.init_bit_stream_w=function(e){i=r(G.LAME_MAXMP3BUFFER),e.h_ptr=e.w_ptr=0,e.header[e.h_ptr].write_timing=0,l=-1,c=0,o=0}}function T(e,t,n,r){this.xlen=e,this.linmax=t,this.table=n,this.hlen=r}m.MAX_VALUE=34028235e31,v.vbr_off=new v(0),v.vbr_mt=new v(1),v.vbr_rh=new v(2),v.vbr_abr=new v(3),v.vbr_mtrh=new v(4),v.vbr_default=v.vbr_mtrh,g.STEREO=new g(0),g.JOINT_STEREO=new g(1),g.DUAL_CHANNEL=new g(2),g.MONO=new g(3),g.NOT_SET=new g(4),y.STEPS_per_dB=100,y.MAX_dB=120,y.GAIN_NOT_ENOUGH_SAMPLES=-24601,y.GAIN_ANALYSIS_ERROR=0,y.GAIN_ANALYSIS_OK=1,y.INIT_GAIN_ANALYSIS_ERROR=0,y.INIT_GAIN_ANALYSIS_OK=1,y.YULE_ORDER=10,y.MAX_ORDER=y.YULE_ORDER,y.MAX_SAMP_FREQ=48e3,y.RMS_WINDOW_TIME_NUMERATOR=1,y.RMS_WINDOW_TIME_DENOMINATOR=20,y.MAX_SAMPLES_PER_WINDOW=y.MAX_SAMP_FREQ*y.RMS_WINDOW_TIME_NUMERATOR/y.RMS_WINDOW_TIME_DENOMINATOR+1,k.NUMTOCENTRIES=100,k.MAXFRAMESIZE=2880,A.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=1e-6*Math.abs(e):Math.abs(e-t)<=1e-6*Math.abs(t)},A.NEQ=function(e,t){return!A.EQ(e,t)};var x={};function C(e){this.bits=e}function E(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}function M(){this.setModules=function(e,t){}}function B(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=i(z.SBMAX_l),this.s=i(z.SBMAX_s),this.psfb21=i(z.PSFB21),this.psfb12=i(z.PSFB12),this.cb_l=i(z.CBANDS),this.cb_s=i(z.CBANDS),this.eql_w=i(z.BLKSIZE/2)}function V(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=g.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}function N(e){var t=e;this.quantize=t,this.iteration_loop=function(e,t,r,a){var o=e.internal_flags,l=i(O.SFBMAX),c=i(576),u=s(2),p=0,d=o.l3_side,f=new C(p);this.quantize.rv.ResvFrameBegin(e,f),p=f.bits;for(var h=0;h<o.mode_gr;h++){this.quantize.qupvt.on_pe(e,t,u,p,h,h),o.mode_ext==z.MPG_MD_MS_LR&&n();for(var _=0;_<o.channels_out;_++){var m,v,g=d.tt[h][_];g.block_type!=z.SHORT_TYPE?(m=0,v=o.PSY.mask_adjust-m):(m=0,v=o.PSY.mask_adjust_short-m),o.masking_lower=Math.pow(10,.1*v),this.quantize.init_outer_loop(o,g),this.quantize.init_xrpow(o,g,c)&&(this.quantize.qupvt.calc_xmin(e,a[h][_],g,l),this.quantize.outer_loop(e,g,l,c,_,u[_])),this.quantize.iteration_finish_one(o,h,_)}}this.quantize.rv.ResvFrameEnd(o,p)}}function P(){}function j(e,t,n,r){this.l=s(1+z.SBMAX_l),this.s=s(1+z.SBMAX_s),this.psfb21=s(1+z.PSFB21),this.psfb12=s(1+z.PSFB12);var a=this.l,i=this.s;4==arguments.length&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],f.arraycopy(this.arrL,0,a,0,Math.min(this.arrL.length,this.l.length)),f.arraycopy(this.arrS,0,i,0,Math.min(this.arrS.length,this.s.length)),f.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),f.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}function I(){var t=null,r=null,a=null;function o(e){return _[e+I.Q_MAX2]}this.setModules=function(e,n,s){t=e,r=n,a=s},this.IPOW20=function(e){return g[e]};var l=2220446049250313e-31,c=I.IXMAX_VAL+2,u=I.Q_MAX,p=I.Q_MAX2,d=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var f=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=f,this.sfBandIndex=[new j([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new j([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0,8,16,24,36,52,72,96,124,160,162,164,166,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var _=i(u+p+1),g=i(u),b=i(c),w=i(c);function y(e,t){var n=a.ATHformula(t,e);return n-=d,n=Math.pow(10,n/10+e.ATHlower)}function S(t){for(var r=t.internal_flags.ATH.l,a=t.internal_flags.ATH.psfb21,s=t.internal_flags.ATH.s,i=t.internal_flags.ATH.psfb12,o=t.internal_flags,l=t.out_samplerate,c=0;c<z.SBMAX_l;c++){var u=o.scalefac_band.l[c],p=o.scalefac_band.l[c+1];r[c]=m.MAX_VALUE;for(var d=u;d<p;d++){var f=y(t,d*l/1152);r[c]=Math.min(r[c],f)}}for(c=0;c<z.PSFB21;c++)for(u=o.scalefac_band.psfb21[c],p=o.scalefac_band.psfb21[c+1],a[c]=m.MAX_VALUE,d=u;d<p;d++)f=y(t,d*l/1152),a[c]=Math.min(a[c],f);for(c=0;c<z.SBMAX_s;c++){for(u=o.scalefac_band.s[c],p=o.scalefac_band.s[c+1],s[c]=m.MAX_VALUE,d=u;d<p;d++)f=y(t,d*l/384),s[c]=Math.min(s[c],f);s[c]*=o.scalefac_band.s[c+1]-o.scalefac_band.s[c]}for(c=0;c<z.PSFB12;c++){for(u=o.scalefac_band.psfb12[c],p=o.scalefac_band.psfb12[c+1],i[c]=m.MAX_VALUE,d=u;d<p;d++)f=y(t,d*l/384),i[c]=Math.min(i[c],f);i[c]*=o.scalefac_band.s[13]-o.scalefac_band.s[12]}t.noATH&&n(),o.ATH.floor=10*e(y(t,-1))}function R(e){this.s=e}this.adj43=w,this.iteration_init=function(e){var n,r=e.internal_flags,a=r.l3_side;if(0==r.iteration_init_init){for(r.iteration_init_init=1,a.main_data_begin=0,S(e),b[0]=0,n=1;n<c;n++)b[n]=Math.pow(n,4/3);for(n=0;n<c-1;n++)w[n]=n+1-Math.pow(.5*(b[n]+b[n+1]),.75);for(w[n]=.5,n=0;n<u;n++)g[n]=Math.pow(2,-.1875*(n-210));for(n=0;n<=u+p;n++)_[n]=Math.pow(2,.25*(n-210-p));var s,i,o,l;for(t.huffman_init(r),(n=e.exp_nspsytune>>2&63)>=32&&(n-=64),s=Math.pow(10,n/4/10),(n=e.exp_nspsytune>>8&63)>=32&&(n-=64),i=Math.pow(10,n/4/10),(n=e.exp_nspsytune>>14&63)>=32&&(n-=64),o=Math.pow(10,n/4/10),(n=e.exp_nspsytune>>20&63)>=32&&(n-=64),l=o*Math.pow(10,n/4/10),n=0;n<z.SBMAX_l;n++)d=n<=6?s:n<=13?i:n<=20?o:l,r.nsPsy.longfact[n]=d;for(n=0;n<z.SBMAX_s;n++){var d;d=n<=5?s:n<=10?i:n<=11?o:l,r.nsPsy.shortfact[n]=d}}},this.on_pe=function(e,t,a,i,o,l){var c,u,p=e.internal_flags,d=0,f=s(2),h=new C(d),_=r.ResvMaxBits(e,i,h,l),m=(d=h.bits)+_;for(m>K.MAX_BITS_PER_GRANULE&&(m=K.MAX_BITS_PER_GRANULE),c=0,u=0;u<p.channels_out;++u)a[u]=Math.min(K.MAX_BITS_PER_CHANNEL,d/p.channels_out),f[u]=0|a[u]*t[o][u]/700-a[u],f[u]>3*i/4&&(f[u]=3*i/4),f[u]<0&&(f[u]=0),f[u]+a[u]>K.MAX_BITS_PER_CHANNEL&&(f[u]=Math.max(0,K.MAX_BITS_PER_CHANNEL-a[u])),c+=f[u];if(c>_)for(u=0;u<p.channels_out;++u)f[u]=_*f[u]/c;for(u=0;u<p.channels_out;++u)a[u]+=f[u],_-=f[u];for(c=0,u=0;u<p.channels_out;++u)c+=a[u];return c>K.MAX_BITS_PER_GRANULE&&n(),m},this.athAdjust=function(e,t,n){var r=90.30873362,a=94.82444863,s=h.FAST_LOG10_X(t,10),i=e*e,o=0;return s-=n,i>1e-20&&(o=1+h.FAST_LOG10_X(i,10/r)),o<0&&(o=0),s*=o,s+=n+r-a,Math.pow(10,.1*s)},this.calc_xmin=function(e,t,r,a){var s,i=0,o=e.internal_flags,c=0,u=0,p=o.ATH,d=r.xr,f=e.VBR==v.vbr_mtrh?1:0,h=o.masking_lower;for(e.VBR!=v.vbr_mtrh&&e.VBR!=v.vbr_mt||(h=1),s=0;s<r.psy_lmax;s++){R=(S=e.VBR==v.vbr_rh||e.VBR==v.vbr_mtrh?athAdjust(p.adjust,p.l[s],p.floor):p.adjust*p.l[s])/(b=r.width[s]),k=l,E=b>>1,C=0;do{C+=M=d[c]*d[c],k+=M<R?M:R,C+=B=d[++c]*d[c],k+=B<R?B:R,c++}while(--E>0);C>S&&u++,s==z.SBPSY_l&&n(),0!=f&&(S=k),e.ATHonly||(T=t.en.l[s])>0&&(x=C*t.thm.l[s]*h/T,0!=f&&(x*=o.nsPsy.longfact[s]),S<x&&(S=x)),a[i++]=0!=f?S:S*o.nsPsy.longfact[s]}var _=575;if(r.block_type!=z.SHORT_TYPE)for(var m=576;0!=m--&&A.EQ(d[m],0);)_=m;r.max_nonzero_coeff=_;for(var g=r.sfb_smin;s<r.psymax;g++,s+=3){var b,w,y;for(y=e.VBR==v.vbr_rh||e.VBR==v.vbr_mtrh?athAdjust(p.adjust,p.s[g],p.floor):p.adjust*p.s[g],b=r.width[s],w=0;w<3;w++){var S,R,k,T,x,C=0,E=b>>1;R=y/b,k=l;do{var M,B;C+=M=d[c]*d[c],k+=M<R?M:R,C+=B=d[++c]*d[c],k+=B<R?B:R,c++}while(--E>0);C>y&&u++,g==z.SBPSY_s&&n(),S=0!=f?k:y,e.ATHonly||e.ATHshort||(T=t.en.s[g][w])>0&&(x=C*t.thm.s[g][w]*h/T,0!=f&&(x*=o.nsPsy.shortfact[g]),S<x&&(S=x)),a[i++]=0!=f?S:S*o.nsPsy.shortfact[g]}e.useTemporal&&(a[i-3]>a[i-3+1]&&(a[i-3+1]+=(a[i-3]-a[i-3+1])*o.decay),a[i-3+1]>a[i-3+2]&&(a[i-3+2]+=(a[i-3+1]-a[i-3+2])*o.decay))}return u},this.calc_noise_core=function(e,t,n,r){var a=0,s=t.s,o=e.l3_enc;if(s>e.count1)for(;0!=n--;)c=e.xr[s],s++,a+=c*c,c=e.xr[s],s++,a+=c*c;else if(s>e.big_values){var l=i(2);for(l[0]=0,l[1]=r;0!=n--;)c=Math.abs(e.xr[s])-l[o[s]],s++,a+=c*c,c=Math.abs(e.xr[s])-l[o[s]],s++,a+=c*c}else for(;0!=n--;){var c;c=Math.abs(e.xr[s])-b[o[s]]*r,s++,a+=c*c,c=Math.abs(e.xr[s])-b[o[s]]*r,s++,a+=c*c}return t.s=s,a},this.calc_noise=function(e,t,n,r,a){var s,i,l=0,c=0,u=0,p=0,d=0,_=-20,m=0,v=e.scalefac,g=0;for(r.over_SSD=0,s=0;s<e.psymax;s++){var b,w=e.global_gain-(v[g++]+(0!=e.preflag?f[s]:0)<<e.scalefac_scale+1)-8*e.subblock_gain[e.window[s]],y=0;if(null!=a&&a.step[s]==w)y=a.noise[s],m+=e.width[s],n[l++]=y/t[c++],y=a.noise_log[s];else{var S,k=o(w);i=e.width[s]>>1,m+e.width[s]>e.max_nonzero_coeff&&(i=(S=e.max_nonzero_coeff-m+1)>0?S>>1:0);var A=new R(m);y=this.calc_noise_core(e,A,i,k),m=A.s,null!=a&&(a.step[s]=w,a.noise[s]=y),y=n[l++]=y/t[c++],y=h.FAST_LOG10(Math.max(y,1e-20)),null!=a&&(a.noise_log[s]=y)}null!=a&&(a.global_gain=e.global_gain),d+=y,y>0&&(b=Math.max(0|10*y+.5,1),r.over_SSD+=b*b,u++,p+=y),_=Math.max(_,y)}return r.over_count=u,r.tot_noise=d,r.over_noise=p,r.max_noise=_,u}}function U(){this.global_gain=0,this.sfb_count1=0,this.step=s(39),this.noise=i(39),this.noise_log=i(39)}function L(){this.xr=i(576),this.l3_enc=s(576),this.scalefac=s(O.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=s(3),this.subblock_gain=s(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=s(O.SFBMAX),this.window=s(O.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=s(4),this.max_nonzero_coeff=0;var e=this;function t(e){return new Int32Array(e)}function n(e){return new Float32Array(e)}this.assign=function(r){e.xr=n(r.xr),e.l3_enc=t(r.l3_enc),e.scalefac=t(r.scalefac),e.xrpow_max=r.xrpow_max,e.part2_3_length=r.part2_3_length,e.big_values=r.big_values,e.count1=r.count1,e.global_gain=r.global_gain,e.scalefac_compress=r.scalefac_compress,e.block_type=r.block_type,e.mixed_block_flag=r.mixed_block_flag,e.table_select=t(r.table_select),e.subblock_gain=t(r.subblock_gain),e.region0_count=r.region0_count,e.region1_count=r.region1_count,e.preflag=r.preflag,e.scalefac_scale=r.scalefac_scale,e.count1table_select=r.count1table_select,e.part2_length=r.part2_length,e.sfb_lmax=r.sfb_lmax,e.sfb_smin=r.sfb_smin,e.psy_lmax=r.psy_lmax,e.sfbmax=r.sfbmax,e.psymax=r.psymax,e.sfbdivide=r.sfbdivide,e.width=t(r.width),e.window=t(r.window),e.count1bits=r.count1bits,e.sfb_partition_table=r.sfb_partition_table.slice(0),e.slen=t(r.slen),e.max_nonzero_coeff=r.max_nonzero_coeff}}x.t1HB=[1,1,1,0],x.t2HB=[1,2,1,3,1,1,3,2,0],x.t3HB=[3,2,1,1,1,1,3,2,0],x.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],x.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],x.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],x.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],x.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],x.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],x.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],x.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],x.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],x.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],x.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],x.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],x.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16],x.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0],x.t1l=[1,4,3,5],x.t2l=[1,4,7,4,5,7,6,7,8],x.t3l=[2,3,7,4,4,7,6,7,8],x.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],x.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],x.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],x.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],x.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],x.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],x.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],x.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],x.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],x.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],x.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],x.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],x.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],x.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10],x.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8],x.ht=[new T(0,0,null,null),new T(2,0,x.t1HB,x.t1l),new T(3,0,x.t2HB,x.t2l),new T(3,0,x.t3HB,x.t3l),new T(0,0,null,null),new T(4,0,x.t5HB,x.t5l),new T(4,0,x.t6HB,x.t6l),new T(6,0,x.t7HB,x.t7l),new T(6,0,x.t8HB,x.t8l),new T(6,0,x.t9HB,x.t9l),new T(8,0,x.t10HB,x.t10l),new T(8,0,x.t11HB,x.t11l),new T(8,0,x.t12HB,x.t12l),new T(16,0,x.t13HB,x.t13l),new T(0,0,null,x.t16_5l),new T(16,0,x.t15HB,x.t15l),new T(1,1,x.t16HB,x.t16l),new T(2,3,x.t16HB,x.t16l),new T(3,7,x.t16HB,x.t16l),new T(4,15,x.t16HB,x.t16l),new T(6,63,x.t16HB,x.t16l),new T(8,255,x.t16HB,x.t16l),new T(10,1023,x.t16HB,x.t16l),new T(13,8191,x.t16HB,x.t16l),new T(4,15,x.t24HB,x.t24l),new T(5,31,x.t24HB,x.t24l),new T(6,63,x.t24HB,x.t24l),new T(7,127,x.t24HB,x.t24l),new T(8,255,x.t24HB,x.t24l),new T(9,511,x.t24HB,x.t24l),new T(11,2047,x.t24HB,x.t24l),new T(13,8191,x.t24HB,x.t24l),new T(0,0,x.t32HB,x.t32l),new T(0,0,x.t33HB,x.t33l)],x.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],x.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],x.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],x.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],x.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],x.scfsi_band=[0,6,11,16,21],I.Q_MAX=257,I.Q_MAX2=116,I.LARGE_BITS=1e5,I.IXMAX_VAL=8206;var O={};function D(){var e,t;this.rv=null,this.qupvt=null;var r,a=new M;function s(e,t,n,r){r=0;for(var a=0;a<=n;++a){var s=Math.abs(e.xr[a]);r+=s,t[a]=Math.sqrt(s*Math.sqrt(s)),t[a]>e.xrpow_max&&(e.xrpow_max=t[a])}return r}function o(e,n){var r=e.ATH,a=n.xr;if(n.block_type!=z.SHORT_TYPE)for(var s=!1,i=z.PSFB21-1;i>=0&&!s;i--){var o=e.scalefac_band.psfb21[i],l=e.scalefac_band.psfb21[i+1],c=t.athAdjust(r.adjust,r.psfb21[i],r.floor);e.nsPsy.longfact[21]>1e-12&&(c*=e.nsPsy.longfact[21]);for(var u=l-1;u>=o;u--){if(!(Math.abs(a[u])<c)){s=!0;break}a[u]=0}}else for(var p=0;p<3;p++)for(s=!1,i=z.PSFB12-1;i>=0&&!s;i--){l=(o=3*e.scalefac_band.s[12]+(e.scalefac_band.s[13]-e.scalefac_band.s[12])*p+(e.scalefac_band.psfb12[i]-e.scalefac_band.psfb12[0]))+(e.scalefac_band.psfb12[i+1]-e.scalefac_band.psfb12[i]);var d=t.athAdjust(r.adjust,r.psfb12[i],r.floor);for(e.nsPsy.shortfact[12]>1e-12&&(d*=e.nsPsy.shortfact[12]),u=l-1;u>=o;u--){if(!(Math.abs(a[u])<d)){s=!0;break}a[u]=0}}}function l(e){this.ordinal=e}function c(e,t,a,s,i){var o,c=e.CurrentStep[s],u=!1,p=e.OldValue[s],d=l.BINSEARCH_NONE;for(t.global_gain=p,a-=t.part2_length;;){var f;if(o=r.count_bits(e,i,t,null),1==c||o==a)break;o>a?(d==l.BINSEARCH_DOWN&&(u=!0),u&&(c/=2),d=l.BINSEARCH_UP,f=c):(d==l.BINSEARCH_UP&&(u=!0),u&&(c/=2),d=l.BINSEARCH_DOWN,f=-c),t.global_gain+=f,t.global_gain<0&&n(),t.global_gain>255&&n()}for(;o>a&&t.global_gain<255;)t.global_gain++,o=r.count_bits(e,i,t,null);return e.CurrentStep[s]=p-t.global_gain>=4?4:2,e.OldValue[s]=t.global_gain,t.part2_3_length=o,o}function u(e){for(var t=0;t<e.sfbmax;t++)if(e.scalefac[t]+e.subblock_gain[e.window[t]]==0)return!1;return!0}function p(e,t,r,a,s){var i;switch(e){default:case 9:t.over_count>0?(i=r.over_SSD<=t.over_SSD,r.over_SSD==t.over_SSD&&(i=r.bits<t.bits)):i=r.max_noise<0&&10*r.max_noise+r.bits<=10*t.max_noise+t.bits;break;case 0:i=r.over_count<t.over_count||r.over_count==t.over_count&&r.over_noise<t.over_noise||r.over_count==t.over_count&&A.EQ(r.over_noise,t.over_noise)&&r.tot_noise<t.tot_noise;break;case 8:n();case 1:i=r.max_noise<t.max_noise;break;case 2:i=r.tot_noise<t.tot_noise;break;case 3:i=r.tot_noise<t.tot_noise&&r.max_noise<t.max_noise;break;case 4:i=r.max_noise<=0&&t.max_noise>.2||r.max_noise<=0&&t.max_noise<0&&t.max_noise>r.max_noise-.2&&r.tot_noise<t.tot_noise||r.max_noise<=0&&t.max_noise>0&&t.max_noise>r.max_noise-.2&&r.tot_noise<t.tot_noise+t.over_noise||r.max_noise>0&&t.max_noise>-.05&&t.max_noise>r.max_noise-.1&&r.tot_noise+r.over_noise<t.tot_noise+t.over_noise||r.max_noise>0&&t.max_noise>-.1&&t.max_noise>r.max_noise-.15&&r.tot_noise+r.over_noise+r.over_noise<t.tot_noise+t.over_noise+t.over_noise;break;case 5:i=r.over_noise<t.over_noise||A.EQ(r.over_noise,t.over_noise)&&r.tot_noise<t.tot_noise;break;case 6:i=r.over_noise<t.over_noise||A.EQ(r.over_noise,t.over_noise)&&(r.max_noise<t.max_noise||A.EQ(r.max_noise,t.max_noise)&&r.tot_noise<=t.tot_noise);break;case 7:i=r.over_count<t.over_count||r.over_noise<t.over_noise}return 0==t.over_count&&(i=i&&r.bits<t.bits),i}function h(e,t,r,a,s){var i,o=e.internal_flags;i=0==t.scalefac_scale?1.2968395546510096:1.6817928305074292;for(var l=0,c=0;c<t.sfbmax;c++)l<r[c]&&(l=r[c]);var u=o.noise_shaping_amp;switch(3==u&&n(),u){case 2:break;case 1:l>1?l=Math.pow(l,.5):l*=.95;break;default:l>1?l=1:l*=.95}var p=0;for(c=0;c<t.sfbmax;c++){var d,f=t.width[c];if(p+=f,!(r[c]<l)){for(0!=(2&o.substep_shaping)&&n(),t.scalefac[c]++,d=-f;d<0;d++)a[p+d]*=i,a[p+d]>t.xrpow_max&&(t.xrpow_max=a[p+d]);if(2==o.noise_shaping_amp)return}}}function _(e,n){for(var r=1.2968395546510096,a=0,s=0;s<e.sfbmax;s++){var i=e.width[s],o=e.scalefac[s];if(0!=e.preflag&&(o+=t.pretab[s]),a+=i,0!=(1&o)){o++;for(var l=-i;l<0;l++)n[a+l]*=r,n[a+l]>e.xrpow_max&&(e.xrpow_max=n[a+l])}e.scalefac[s]=o>>1}e.preflag=0,e.scalefac_scale=1}function m(e,n,r){var a,s=n.scalefac;for(a=0;a<n.sfb_lmax;a++)if(s[a]>=16)return!0;for(var i=0;i<3;i++){var o=0,l=0;for(a=n.sfb_lmax+i;a<n.sfbdivide;a+=3)o<s[a]&&(o=s[a]);for(;a<n.sfbmax;a+=3)l<s[a]&&(l=s[a]);if(!(o<16&&l<8)){if(n.subblock_gain[i]>=7)return!0;n.subblock_gain[i]++;var c=e.scalefac_band.l[n.sfb_lmax];for(a=n.sfb_lmax+i;a<n.sfbmax;a+=3){var u=n.width[a],p=s[a];if((p-=4>>n.scalefac_scale)>=0)s[a]=p,c+=3*u;else{s[a]=0;var d=210+(p<<n.scalefac_scale+1);h=t.IPOW20(d),c+=u*(i+1);for(var f=-u;f<0;f++)r[c+f]*=h,r[c+f]>n.xrpow_max&&(n.xrpow_max=r[c+f]);c+=u*(3-i-1)}}var h=t.IPOW20(202);for(c+=n.width[a]*(i+1),f=-n.width[a];f<0;f++)r[c+f]*=h,r[c+f]>n.xrpow_max&&(n.xrpow_max=r[c+f])}}return!1}function g(e,t,n,a,s){var i=e.internal_flags;h(e,t,n,a);var o=u(t);return!(o||(o=2==i.mode_gr?r.scale_bitcount(t):r.scale_bitcount_lsf(i,t))&&(i.noise_shaping>1&&(d.fill(i.pseudohalf,0),0==t.scalefac_scale?(_(t,a),o=!1):t.block_type==z.SHORT_TYPE&&i.subblock_gain>0&&(o=m(i,t,a)||u(t))),o||(o=2==i.mode_gr?r.scale_bitcount(t):r.scale_bitcount_lsf(i,t)),o))}this.setModules=function(n,s,i,o){e=s,this.rv=s,t=i,this.qupvt=i,r=o,a.setModules(t,r)},this.init_xrpow=function(e,t,n){var r=0,a=0|t.max_nonzero_coeff;if(t.xrpow_max=0,d.fill(n,a,576,0),(r=s(t,n,a,r))>1e-20){var i=0;0!=(2&e.substep_shaping)&&(i=1);for(var o=0;o<t.psymax;o++)e.pseudohalf[o]=i;return!0}return d.fill(t.l3_enc,0,576,0),!1},this.init_outer_loop=function(e,r){r.part2_3_length=0,r.big_values=0,r.count1=0,r.global_gain=210,r.scalefac_compress=0,r.table_select[0]=0,r.table_select[1]=0,r.table_select[2]=0,r.subblock_gain[0]=0,r.subblock_gain[1]=0,r.subblock_gain[2]=0,r.subblock_gain[3]=0,r.region0_count=0,r.region1_count=0,r.preflag=0,r.scalefac_scale=0,r.count1table_select=0,r.part2_length=0,r.sfb_lmax=z.SBPSY_l,r.sfb_smin=z.SBPSY_s,r.psy_lmax=e.sfb21_extra?z.SBMAX_l:z.SBPSY_l,r.psymax=r.psy_lmax,r.sfbmax=r.sfb_lmax,r.sfbdivide=11;for(var a=0;a<z.SBMAX_l;a++)r.width[a]=e.scalefac_band.l[a+1]-e.scalefac_band.l[a],r.window[a]=3;if(r.block_type==z.SHORT_TYPE){var s=i(576);r.sfb_smin=0,r.sfb_lmax=0,0!=r.mixed_block_flag&&n(),r.psymax=r.sfb_lmax+3*((e.sfb21_extra?z.SBMAX_s:z.SBPSY_s)-r.sfb_smin),r.sfbmax=r.sfb_lmax+3*(z.SBPSY_s-r.sfb_smin),r.sfbdivide=r.sfbmax-18,r.psy_lmax=r.sfb_lmax;var l=e.scalefac_band.l[r.sfb_lmax];for(f.arraycopy(r.xr,0,s,0,576),a=r.sfb_smin;a<z.SBMAX_s;a++)for(var c=e.scalefac_band.s[a],u=e.scalefac_band.s[a+1],p=0;p<3;p++)for(var h=c;h<u;h++)r.xr[l++]=s[3*h+p];var _=r.sfb_lmax;for(a=r.sfb_smin;a<z.SBMAX_s;a++)r.width[_]=r.width[_+1]=r.width[_+2]=e.scalefac_band.s[a+1]-e.scalefac_band.s[a],r.window[_]=0,r.window[_+1]=1,r.window[_+2]=2,_+=3}r.count1bits=0,r.sfb_partition_table=t.nr_of_sfb_block[0][0],r.slen[0]=0,r.slen[1]=0,r.slen[2]=0,r.slen[3]=0,r.max_nonzero_coeff=575,d.fill(r.scalefac,0),o(e,r)},l.BINSEARCH_NONE=new l(0),l.BINSEARCH_UP=new l(1),l.BINSEARCH_DOWN=new l(2),this.outer_loop=function(e,a,s,o,l,u){var d=e.internal_flags,h=new L,_=i(576),m=i(O.SFBMAX),b=new E,w=new U,y=9999999,S=!1,R=!1,k=0;if(c(d,a,u,l,o),0==d.noise_shaping)return 100;t.calc_noise(a,s,m,b,w),b.bits=a.part2_3_length,h.assign(a);var A=0;for(f.arraycopy(o,0,_,0,576);!S;){do{var T,x=new E,C=255;if(T=0!=(2&d.substep_shaping)?20:3,d.sfb21_extra&&n(),!g(e,h,m,o))break;0!=h.scalefac_scale&&(C=254);var M=u-h.part2_length;if(M<=0)break;for(;(h.part2_3_length=r.count_bits(d,o,h,w))>M&&h.global_gain<=C;)h.global_gain++;if(h.global_gain>C)break;if(0==b.over_count){for(;(h.part2_3_length=r.count_bits(d,o,h,w))>y&&h.global_gain<=C;)h.global_gain++;if(h.global_gain>C)break}if(t.calc_noise(h,s,m,x,w),x.bits=h.part2_3_length,0!=(p(a.block_type!=z.SHORT_TYPE?e.quant_comp:e.quant_comp_short,b,x)?1:0))y=a.part2_3_length,b=x,a.assign(h),A=0,f.arraycopy(o,0,_,0,576);else if(0==d.full_outer_loop){if(++A>T&&0==b.over_count)break;if(3==d.noise_shaping_amp&&R&&A>30)break;if(3==d.noise_shaping_amp&&R&&h.global_gain-k>15)break}}while(h.global_gain+h.scalefac_scale<255);3==d.noise_shaping_amp?n():S=!0}return e.VBR==v.vbr_rh||e.VBR==v.vbr_mtrh?f.arraycopy(_,0,o,0,576):0!=(1&d.substep_shaping)&&n(),b.over_count},this.iteration_finish_one=function(t,n,a){var s=t.l3_side,i=s.tt[n][a];r.best_scalefac_store(t,n,a,s),1==t.use_best_huffman&&r.best_huffman_divide(t,i),e.ResvAdjust(t,i)}}function H(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*h.SQRT2*.5/2384e-9,.017876148*h.SQRT2*.5/2384e-9,.003134727*h.SQRT2*.5/2384e-9,.002457142*h.SQRT2*.5/2384e-9,971317e-9*h.SQRT2*.5/2384e-9,218868e-9*h.SQRT2*.5/2384e-9,101566e-9*h.SQRT2*.5/2384e-9,13828e-9*h.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,r=36,a=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],s=a[z.SHORT_TYPE],o=a[z.SHORT_TYPE],l=a[z.SHORT_TYPE],c=a[z.SHORT_TYPE],u=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function p(t,n,r){for(var a,s,i,o=10,l=n+238-14-286,c=-15;c<0;c++){var u,p,d;u=e[o+-10],p=t[l+-224]*u,d=t[n+224]*u,u=e[o+-9],p+=t[l+-160]*u,d+=t[n+160]*u,u=e[o+-8],p+=t[l+-96]*u,d+=t[n+96]*u,u=e[o+-7],p+=t[l+-32]*u,d+=t[n+32]*u,u=e[o+-6],p+=t[l+32]*u,d+=t[n+-32]*u,u=e[o+-5],p+=t[l+96]*u,d+=t[n+-96]*u,u=e[o+-4],p+=t[l+160]*u,d+=t[n+-160]*u,u=e[o+-3],p+=t[l+224]*u,d+=t[n+-224]*u,u=e[o+-2],p+=t[n+-256]*u,d-=t[l+256]*u,u=e[o+-1],p+=t[n+-192]*u,d-=t[l+192]*u,u=e[o+0],p+=t[n+-128]*u,d-=t[l+128]*u,u=e[o+1],p+=t[n+-64]*u,d-=t[l+64]*u,u=e[o+2],p+=t[n+0]*u,d-=t[l+0]*u,u=e[o+3],p+=t[n+64]*u,d-=t[l+-64]*u,u=e[o+4],p+=t[n+128]*u,d-=t[l+-128]*u,u=e[o+5],p+=t[n+192]*u,u=(d-=t[l+-192]*u)-(p*=e[o+6]),r[30+2*c]=d+p,r[31+2*c]=e[o+7]*u,o+=18,n--,l++}d=t[n+-16]*e[o+-10],p=t[n+-32]*e[o+-2],d+=(t[n+-48]-t[n+16])*e[o+-9],p+=t[n+-96]*e[o+-1],d+=(t[n+-80]+t[n+48])*e[o+-8],p+=t[n+-160]*e[o+0],d+=(t[n+-112]-t[n+80])*e[o+-7],p+=t[n+-224]*e[o+1],d+=(t[n+-144]+t[n+112])*e[o+-6],p-=t[n+32]*e[o+2],d+=(t[n+-176]-t[n+144])*e[o+-5],p-=t[n+96]*e[o+3],d+=(t[n+-208]+t[n+176])*e[o+-4],p-=t[n+160]*e[o+4],d+=(t[n+-240]-t[n+208])*e[o+-3],a=(p-=t[n+224])-d,s=p+d,d=r[14],p=r[15]-d,r[31]=s+d,r[30]=a+p,r[15]=a-p,r[14]=s-d,i=r[28]-r[0],r[0]+=r[28],r[28]=i*e[o+-36+7],i=r[29]-r[1],r[1]+=r[29],r[29]=i*e[o+-36+7],i=r[26]-r[2],r[2]+=r[26],r[26]=i*e[o+-72+7],i=r[27]-r[3],r[3]+=r[27],r[27]=i*e[o+-72+7],i=r[24]-r[4],r[4]+=r[24],r[24]=i*e[o+-108+7],i=r[25]-r[5],r[5]+=r[25],r[25]=i*e[o+-108+7],i=r[22]-r[6],r[6]+=r[22],r[22]=i*h.SQRT2,i=r[23]-r[7],r[7]+=r[23],r[23]=i*h.SQRT2-r[7],r[7]-=r[6],r[22]-=r[7],r[23]-=r[22],i=r[6],r[6]=r[31]-i,r[31]=r[31]+i,i=r[7],r[7]=r[30]-i,r[30]=r[30]+i,i=r[22],r[22]=r[15]-i,r[15]=r[15]+i,i=r[23],r[23]=r[14]-i,r[14]=r[14]+i,i=r[20]-r[8],r[8]+=r[20],r[20]=i*e[o+-180+7],i=r[21]-r[9],r[9]+=r[21],r[21]=i*e[o+-180+7],i=r[18]-r[10],r[10]+=r[18],r[18]=i*e[o+-216+7],i=r[19]-r[11],r[11]+=r[19],r[19]=i*e[o+-216+7],i=r[16]-r[12],r[12]+=r[16],r[16]=i*e[o+-252+7],i=r[17]-r[13],r[13]+=r[17],r[17]=i*e[o+-252+7],i=-r[20]+r[24],r[20]+=r[24],r[24]=i*e[o+-216+7],i=-r[21]+r[25],r[21]+=r[25],r[25]=i*e[o+-216+7],i=r[4]-r[8],r[4]+=r[8],r[8]=i*e[o+-216+7],i=r[5]-r[9],r[5]+=r[9],r[9]=i*e[o+-216+7],i=r[0]-r[12],r[0]+=r[12],r[12]=i*e[o+-72+7],i=r[1]-r[13],r[1]+=r[13],r[13]=i*e[o+-72+7],i=r[16]-r[28],r[16]+=r[28],r[28]=i*e[o+-72+7],i=-r[17]+r[29],r[17]+=r[29],r[29]=i*e[o+-72+7],i=h.SQRT2*(r[2]-r[10]),r[2]+=r[10],r[10]=i,i=h.SQRT2*(r[3]-r[11]),r[3]+=r[11],r[11]=i,i=h.SQRT2*(-r[18]+r[26]),r[18]+=r[26],r[26]=i-r[18],i=h.SQRT2*(-r[19]+r[27]),r[19]+=r[27],r[27]=i-r[19],i=r[2],r[19]-=r[3],r[3]-=i,r[2]=r[31]-i,r[31]+=i,i=r[3],r[11]-=r[19],r[18]-=i,r[3]=r[30]-i,r[30]+=i,i=r[18],r[27]-=r[11],r[19]-=i,r[18]=r[15]-i,r[15]+=i,i=r[19],r[10]-=i,r[19]=r[14]-i,r[14]+=i,i=r[10],r[11]-=i,r[10]=r[23]-i,r[23]+=i,i=r[11],r[26]-=i,r[11]=r[22]-i,r[22]+=i,i=r[26],r[27]-=i,r[26]=r[7]-i,r[7]+=i,i=r[27],r[27]=r[6]-i,r[6]+=i,i=h.SQRT2*(r[0]-r[4]),r[0]+=r[4],r[4]=i,i=h.SQRT2*(r[1]-r[5]),r[1]+=r[5],r[5]=i,i=h.SQRT2*(r[16]-r[20]),r[16]+=r[20],r[20]=i,i=h.SQRT2*(r[17]-r[21]),r[17]+=r[21],r[21]=i,i=-h.SQRT2*(r[8]-r[12]),r[8]+=r[12],r[12]=i-r[8],i=-h.SQRT2*(r[9]-r[13]),r[9]+=r[13],r[13]=i-r[9],i=-h.SQRT2*(r[25]-r[29]),r[25]+=r[29],r[29]=i-r[25],i=-h.SQRT2*(r[24]+r[28]),r[24]-=r[28],r[28]=i-r[24],i=r[24]-r[16],r[24]=i,i=r[20]-i,r[20]=i,i=r[28]-i,r[28]=i,i=r[25]-r[17],r[25]=i,i=r[21]-i,r[21]=i,i=r[29]-i,r[29]=i,i=r[17]-r[1],r[17]=i,i=r[9]-i,r[9]=i,i=r[25]-i,r[25]=i,i=r[5]-i,r[5]=i,i=r[21]-i,r[21]=i,i=r[13]-i,r[13]=i,i=r[29]-i,r[29]=i,i=r[1]-r[0],r[1]=i,i=r[16]-i,r[16]=i,i=r[17]-i,r[17]=i,i=r[8]-i,r[8]=i,i=r[9]-i,r[9]=i,i=r[24]-i,r[24]=i,i=r[25]-i,r[25]=i,i=r[4]-i,r[4]=i,i=r[5]-i,r[5]=i,i=r[20]-i,r[20]=i,i=r[21]-i,r[21]=i,i=r[12]-i,r[12]=i,i=r[13]-i,r[13]=i,i=r[28]-i,r[28]=i,i=r[29]-i,r[29]=i,i=r[0],r[0]+=r[31],r[31]-=i,i=r[1],r[1]+=r[30],r[30]-=i,i=r[16],r[16]+=r[15],r[15]-=i,i=r[17],r[17]+=r[14],r[14]-=i,i=r[8],r[8]+=r[23],r[23]-=i,i=r[9],r[9]+=r[22],r[22]-=i,i=r[24],r[24]+=r[7],r[7]-=i,i=r[25],r[25]+=r[6],r[6]-=i,i=r[4],r[4]+=r[27],r[27]-=i,i=r[5],r[5]+=r[26],r[26]-=i,i=r[20],r[20]+=r[11],r[11]-=i,i=r[21],r[21]+=r[10],r[10]-=i,i=r[12],r[12]+=r[19],r[19]-=i,i=r[13],r[13]+=r[18],r[18]-=i,i=r[28],r[28]+=r[3],r[3]-=i,i=r[29],r[29]+=r[2],r[2]-=i}function _(e,t){for(var n=0;n<3;n++){var r,s,i,o,l,c;s=(o=e[t+6]*a[z.SHORT_TYPE][0]-e[t+15])+(r=e[t+0]*a[z.SHORT_TYPE][2]-e[t+9]),i=o-r,l=(o=e[t+15]*a[z.SHORT_TYPE][0]+e[t+6])+(r=e[t+9]*a[z.SHORT_TYPE][2]+e[t+0]),c=-o+r,r=2069978111953089e-26*(e[t+3]*a[z.SHORT_TYPE][1]-e[t+12]),o=2069978111953089e-26*(e[t+12]*a[z.SHORT_TYPE][1]+e[t+3]),e[t+0]=190752519173728e-25*s+r,e[t+15]=190752519173728e-25*-l+o,i=.8660254037844387*i*1907525191737281e-26,l=.5*l*1907525191737281e-26+o,e[t+3]=i-l,e[t+6]=i+l,s=.5*s*1907525191737281e-26-r,c=.8660254037844387*c*1907525191737281e-26,e[t+9]=s+c,e[t+12]=s-c,t++}}function m(e,t,n){var r,a,s,i,l,c,u,p,d,f,h,_,m,v,g,b,w,y;s=n[17]-n[9],l=n[15]-n[11],c=n[14]-n[12],u=n[0]+n[8],p=n[1]+n[7],d=n[2]+n[6],f=n[3]+n[5],e[t+17]=u+d-f-(p-n[4]),a=(u+d-f)*o[19]+(p-n[4]),r=(s-l-c)*o[18],e[t+5]=r+a,e[t+6]=r-a,i=(n[16]-n[10])*o[18],p=p*o[19]+n[4],r=s*o[12]+i+l*o[13]+c*o[14],a=-u*o[16]+p-d*o[17]+f*o[15],e[t+1]=r+a,e[t+2]=r-a,r=s*o[13]-i-l*o[14]+c*o[12],a=-u*o[17]+p-d*o[15]+f*o[16],e[t+9]=r+a,e[t+10]=r-a,r=s*o[14]-i+l*o[12]-c*o[13],a=u*o[15]-p+d*o[16]-f*o[17],e[t+13]=r+a,e[t+14]=r-a,h=n[8]-n[0],m=n[6]-n[2],v=n[5]-n[3],g=n[17]+n[9],b=n[16]+n[10],w=n[15]+n[11],y=n[14]+n[12],e[t+0]=g+w+y+(b+n[13]),r=(g+w+y)*o[19]-(b+n[13]),a=(h-m+v)*o[18],e[t+11]=r+a,e[t+12]=r-a,_=(n[7]-n[1])*o[18],b=n[13]-b*o[19],r=g*o[15]-b+w*o[16]+y*o[17],a=h*o[14]+_+m*o[12]+v*o[13],e[t+3]=r+a,e[t+4]=r-a,r=-g*o[17]+b-w*o[15]-y*o[16],a=h*o[13]+_-m*o[14]-v*o[12],e[t+7]=r+a,e[t+8]=r-a,r=-g*o[16]+b-w*o[17]-y*o[15],a=h*o[12]-_+m*o[13]-v*o[14],e[t+15]=r+a,e[t+16]=r-a}this.mdct_sub48=function(e,o,h){for(var v=o,g=286,b=0;b<e.channels_out;b++){for(var w=0;w<e.mode_gr;w++){for(var y,S=e.l3_side.tt[w][b],R=S.xr,k=0,A=e.sb_sample[b][1-w],T=0,x=0;x<9;x++)for(p(v,g,A[T]),p(v,g+32,A[T+1]),T+=2,g+=64,y=1;y<32;y+=2)A[T-1][y]*=-1;for(y=0;y<32;y++,k+=18){var C=S.block_type,E=e.sb_sample[b][w],M=e.sb_sample[b][1-w];if(0!=S.mixed_block_flag&&y<2&&(C=0),e.amp_filter[y]<1e-12)d.fill(R,k+0,k+18,0);else if(e.amp_filter[y]<1&&n(),C==z.SHORT_TYPE){for(x=-t/4;x<0;x++){var B=a[z.SHORT_TYPE][x+3];R[k+3*x+9]=E[9+x][u[y]]*B-E[8-x][u[y]],R[k+3*x+18]=E[14-x][u[y]]*B+E[15+x][u[y]],R[k+3*x+10]=E[15+x][u[y]]*B-E[14-x][u[y]],R[k+3*x+19]=M[2-x][u[y]]*B+M[3+x][u[y]],R[k+3*x+11]=M[3+x][u[y]]*B-M[2-x][u[y]],R[k+3*x+20]=M[8-x][u[y]]*B+M[9+x][u[y]]}_(R,k)}else{var V=i(18);for(x=-r/4;x<0;x++){var N,P;N=a[C][x+27]*M[x+9][u[y]]+a[C][x+36]*M[8-x][u[y]],P=a[C][x+9]*E[x+9][u[y]]-a[C][x+18]*E[8-x][u[y]],V[x+9]=N-P*s[3+x+9],V[x+18]=N*s[3+x+9]+P}m(R,k,V)}if(C!=z.SHORT_TYPE&&0!=y)for(x=7;x>=0;--x){var j,I;j=R[k+x]*l[20+x]+R[k+-1-x]*c[28+x],I=R[k+x]*c[28+x]-R[k+-1-x]*l[20+x],R[k+-1-x]=j,R[k+x]=I}}}if(v=h,g=286,1==e.mode_gr)for(var U=0;U<18;U++)f.arraycopy(e.sb_sample[b][1][U],0,e.sb_sample[b][0][U],0,32)}}}function W(){this.thm=new $,this.en=new $}function z(){var e=z.MPG_MD_MS_LR,t=null;this.psy=null;var r=null,a=null;this.setModules=function(e,n,s,i){t=e,this.psy=n,r=n,a=i};var o=new H;function c(e){var t,r;if(0!=e.ATH.useAdjust)if(r=e.loudness_sq[0][0],t=e.loudness_sq[1][0],2==e.channels_out?n():(r+=r,t+=t),2==e.mode_gr&&(r=Math.max(r,t)),r*=.5,(r*=e.ATH.aaSensitivityP)>.03125)e.ATH.adjust>=1?e.ATH.adjust=1:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=1;else{var a=31.98*r+625e-6;e.ATH.adjust>=a?(e.ATH.adjust*=.075*a+.925,e.ATH.adjust<a&&(e.ATH.adjust=a)):e.ATH.adjustLimit>=a?e.ATH.adjust=a:e.ATH.adjust<e.ATH.adjustLimit&&(e.ATH.adjust=e.ATH.adjustLimit),e.ATH.adjustLimit=a}else e.ATH.adjust=1}function u(e){var t,r;for(e.bitrate_stereoMode_Hist[e.bitrate_index][4]++,e.bitrate_stereoMode_Hist[15][4]++,2==e.channels_out&&n(),t=0;t<e.mode_gr;++t)for(r=0;r<e.channels_out;++r){var a=0|e.l3_side.tt[t][r].block_type;0!=e.l3_side.tt[t][r].mixed_block_flag&&(a=4),e.bitrate_blockType_Hist[e.bitrate_index][a]++,e.bitrate_blockType_Hist[e.bitrate_index][5]++,e.bitrate_blockType_Hist[15][a]++,e.bitrate_blockType_Hist[15][5]++}}function d(e,t){var n,r,a=e.internal_flags;if(0==a.lame_encode_frame_init){var s,l,c=i(2014),u=i(2014);for(a.lame_encode_frame_init=1,s=0,l=0;s<286+576*(1+a.mode_gr);++s)s<576*a.mode_gr?(c[s]=0,2==a.channels_out&&(u[s]=0)):(c[s]=t[0][l],2==a.channels_out&&(u[s]=t[1][l]),++l);for(r=0;r<a.mode_gr;r++)for(n=0;n<a.channels_out;n++)a.l3_side.tt[r][n].block_type=z.SHORT_TYPE;o.mdct_sub48(a,c,u)}}this.lame_encode_mp3_frame=function(i,f,h,_,m,b){var w,y=p([2,2]);y[0][0]=new W,y[0][1]=new W,y[1][0]=new W,y[1][1]=new W;var S,R=p([2,2]);R[0][0]=new W,R[0][1]=new W,R[1][0]=new W,R[1][1]=new W;var k,A,T,x=[null,null],C=i.internal_flags,E=l([2,4]),M=[.5,.5],B=[[0,0],[0,0]],V=[[0,0],[0,0]];if(x[0]=f,x[1]=h,0==C.lame_encode_frame_init&&d(i,x),C.padding=0,(C.slot_lag-=C.frac_SpF)<0&&(C.slot_lag+=i.out_samplerate,C.padding=1),0!=C.psymodel){var N,P=[null,null],j=0,I=s(2);for(T=0;T<C.mode_gr;T++){for(A=0;A<C.channels_out;A++)P[A]=x[A],j=576+576*T-z.FFTOFFSET;if(i.VBR==v.vbr_mtrh||i.VBR==v.vbr_mt?n():N=r.L3psycho_anal_ns(i,P,j,T,y,R,B[T],V[T],E[T],I),0!=N)return-4;for(i.mode==g.JOINT_STEREO&&n(),A=0;A<C.channels_out;A++){var U=C.l3_side.tt[T][A];U.block_type=I[A],U.mixed_block_flag=0}}}else n();if(c(C),o.mdct_sub48(C,x[0],x[1]),C.mode_ext=z.MPG_MD_LR_LR,i.force_ms?C.mode_ext=z.MPG_MD_MS_LR:i.mode==g.JOINT_STEREO&&n(),C.mode_ext==e?(S=R,k=V):(S=y,k=B),i.analysis&&null!=C.pinfo&&n(),i.VBR==v.vbr_off||i.VBR==v.vbr_abr){var L,O;for(L=0;L<18;L++)C.nsPsy.pefirbuf[L]=C.nsPsy.pefirbuf[L+1];for(O=0,T=0;T<C.mode_gr;T++)for(A=0;A<C.channels_out;A++)O+=k[T][A];for(C.nsPsy.pefirbuf[18]=O,O=C.nsPsy.pefirbuf[9],L=0;L<9;L++)O+=(C.nsPsy.pefirbuf[L]+C.nsPsy.pefirbuf[18-L])*z.fircoef[L];for(O=3350*C.mode_gr*C.channels_out/O,T=0;T<C.mode_gr;T++)for(A=0;A<C.channels_out;A++)k[T][A]*=O}return C.iteration_loop.iteration_loop(i,k,M,S),t.format_bitstream(i),w=t.copy_buffer(C,_,m,b,1),i.bWriteVbrTag&&a.addVbrFrame(i),i.analysis&&null!=C.pinfo&&n(),u(C),w}}function F(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}function q(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[s(4),s(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new L}function $(){this.l=i(z.SBMAX_l),this.s=l([z.SBMAX_s,3]);var e=this;this.assign=function(t){f.arraycopy(t.l,0,e.l,0,z.SBMAX_l);for(var n=0;n<z.SBMAX_s;n++)for(var r=0;r<3;r++)e.s[n][r]=t.s[n][r]}}function X(){this.last_en_subshort=l([4,9]),this.lastAttacks=s(4),this.pefirbuf=i(19),this.longfact=i(z.SBMAX_l),this.shortfact=i(z.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function K(){var e=40;function t(){this.write_timing=0,this.ptr=0,this.buf=r(e)}this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=l([2,K.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new q,this.ms_ratio=i(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=s(2),this.CurrentStep=s(2),this.masking_lower=0,this.bv_scf=s(576),this.pseudohalf=s(O.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*K.BPC+1),this.itime=o(2),this.sideinfo_len=0,this.sb_sample=l([2,2,18,z.SBLIMIT]),this.amp_filter=i(32),this.header=new Array(K.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new j,this.minval_l=i(z.CBANDS),this.minval_s=i(z.CBANDS),this.nb_1=l([4,z.CBANDS]),this.nb_2=l([4,z.CBANDS]),this.nb_s1=l([4,z.CBANDS]),this.nb_s2=l([4,z.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=i(4),this.loudness_sq=l([2,2]),this.loudness_sq_save=i(2),this.mld_l=i(z.SBMAX_l),this.mld_s=i(z.SBMAX_s),this.bm_l=s(z.SBMAX_l),this.bo_l=s(z.SBMAX_l),this.bm_s=s(z.SBMAX_s),this.bo_s=s(z.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=c([z.CBANDS,2]),this.s3ind_s=c([z.CBANDS,2]),this.numlines_s=s(z.CBANDS),this.numlines_l=s(z.CBANDS),this.rnumlines_l=i(z.CBANDS),this.mld_cb_l=i(z.CBANDS),this.mld_cb_s=i(z.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=i(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=s(2),this.nsPsy=new X,this.VBR_seek_table=new F,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=c([16,5]),this.bitrate_blockType_Hist=c([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var n=0;n<this.en.length;n++)this.en[n]=new $;for(n=0;n<this.thm.length;n++)this.thm[n]=new $;for(n=0;n<this.header.length;n++)this.header[n]=new t}function J(){var e=i(z.BLKSIZE),t=i(z.BLKSIZE_s/2),n=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(e,t,r){var a,s,i,o=0,l=t+(r<<=1);a=4;do{var c,u,p,d,f,_,m;m=a>>1,_=(f=a<<1)+(d=a),a=f<<1,i=(s=t)+m;do{R=e[s+0]-e[s+d],S=e[s+0]+e[s+d],x=e[s+f]-e[s+_],A=e[s+f]+e[s+_],e[s+f]=S-A,e[s+0]=S+A,e[s+_]=R-x,e[s+d]=R+x,R=e[i+0]-e[i+d],S=e[i+0]+e[i+d],x=h.SQRT2*e[i+_],A=h.SQRT2*e[i+f],e[i+f]=S-A,e[i+0]=S+A,e[i+_]=R-x,e[i+d]=R+x,i+=a,s+=a}while(s<l);for(u=n[o+0],c=n[o+1],p=1;p<m;p++){var v,g;v=1-2*c*c,g=2*c*u,s=t+p,i=t+d-p;do{var b,w,y,S,R,k,A,T,x,C;w=g*e[s+d]-v*e[i+d],b=v*e[s+d]+g*e[i+d],R=e[s+0]-b,S=e[s+0]+b,k=e[i+0]-w,y=e[i+0]+w,w=g*e[s+_]-v*e[i+_],b=v*e[s+_]+g*e[i+_],x=e[s+f]-b,A=e[s+f]+b,C=e[i+f]-w,T=e[i+f]+w,w=c*A-u*C,b=u*A+c*C,e[s+f]=S-b,e[s+0]=S+b,e[i+_]=k-w,e[i+d]=k+w,w=u*T-c*x,b=c*T+u*x,e[i+f]=y-b,e[i+0]=y+b,e[s+_]=R-w,e[s+d]=R+w,i+=a,s+=a}while(s<l);u=(v=u)*n[o+0]-c*n[o+1],c=v*n[o+1]+c*n[o+0]}o+=2}while(a<r)}var a=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(e,n,s,i,o){for(var l=0;l<3;l++){var c=z.BLKSIZE_s/2,u=65535&192*(l+1),p=z.BLKSIZE_s/8-1;do{var d,f,h,_,m,v=255&a[p<<2];f=(d=t[v]*i[s][o+v+u])-(m=t[127-v]*i[s][o+v+u+128]),d+=m,_=(h=t[v+64]*i[s][o+v+u+64])-(m=t[63-v]*i[s][o+v+u+192]),h+=m,c-=4,n[l][c+0]=d+h,n[l][c+2]=d-h,n[l][c+1]=f+_,n[l][c+3]=f-_,f=(d=t[v+1]*i[s][o+v+u+1])-(m=t[126-v]*i[s][o+v+u+129]),d+=m,_=(h=t[v+65]*i[s][o+v+u+65])-(m=t[62-v]*i[s][o+v+u+193]),h+=m,n[l][c+z.BLKSIZE_s/2+0]=d+h,n[l][c+z.BLKSIZE_s/2+2]=d-h,n[l][c+z.BLKSIZE_s/2+1]=f+_,n[l][c+z.BLKSIZE_s/2+3]=f-_}while(--p>=0);r(n[l],c,z.BLKSIZE_s/2)}},this.fft_long=function(t,n,s,i,o){var l=z.BLKSIZE/8-1,c=z.BLKSIZE/2;do{var u,p,d,f,h,_=255&a[l];p=(u=e[_]*i[s][o+_])-(h=e[_+512]*i[s][o+_+512]),u+=h,f=(d=e[_+256]*i[s][o+_+256])-(h=e[_+768]*i[s][o+_+768]),d+=h,n[0+(c-=4)]=u+d,n[c+2]=u-d,n[c+1]=p+f,n[c+3]=p-f,p=(u=e[_+1]*i[s][o+_+1])-(h=e[_+513]*i[s][o+_+513]),u+=h,f=(d=e[_+257]*i[s][o+_+257])-(h=e[_+769]*i[s][o+_+769]),d+=h,n[c+z.BLKSIZE/2+0]=u+d,n[c+z.BLKSIZE/2+2]=u-d,n[c+z.BLKSIZE/2+1]=p+f,n[c+z.BLKSIZE/2+3]=p-f}while(--l>=0);r(n,c,z.BLKSIZE/2)},this.init_fft=function(n){for(var r=0;r<z.BLKSIZE;r++)e[r]=.42-.5*Math.cos(2*Math.PI*(r+.5)/z.BLKSIZE)+.08*Math.cos(4*Math.PI*(r+.5)/z.BLKSIZE);for(r=0;r<z.BLKSIZE_s/2;r++)t[r]=.5*(1-Math.cos(2*Math.PI*(r+.5)/z.BLKSIZE_s))}}function Y(){var e=new J,t=2.302585092994046,r=2,a=16,o=2,c=16,u=.34,p=1/217621504/(z.BLKSIZE/2),f=.01,b=.8,w=.6,y=.3,S=3.5,R=21,k=.2302585093;function A(e,t){for(var n=0,r=0;r<z.BLKSIZE/2;++r)n+=e[r]*t.ATH.eql_w[r];return n*=p}function T(t,r,a,s,i,o,l,c,u,p,d){var f=t.internal_flags;u<2?(e.fft_long(f,s[i],u,p,d),e.fft_short(f,o[l],u,p,d)):2==u&&n(),r[0]=s[i+0][0],r[0]*=r[0];for(var h=z.BLKSIZE/2-1;h>=0;--h){var _=s[i+0][z.BLKSIZE/2-h],m=s[i+0][z.BLKSIZE/2+h];r[z.BLKSIZE/2-h]=.5*(_*_+m*m)}for(var v=2;v>=0;--v)for(a[v][0]=o[l+0][v][0],a[v][0]*=a[v][0],h=z.BLKSIZE_s/2-1;h>=0;--h)_=o[l+0][v][z.BLKSIZE_s/2-h],m=o[l+0][v][z.BLKSIZE_s/2+h],a[v][z.BLKSIZE_s/2-h]=.5*(_*_+m*m);var g=0;for(h=11;h<z.HBLKSIZE;h++)g+=r[h];f.tot_ener[u]=g,t.analysis&&n(),2==t.athaa_loudapprox&&u<2&&(f.loudness_sq[c][u]=f.loudness_sq_save[u],f.loudness_sq_save[u]=A(r,f))}var x,C,E,M=8,B=23,V=15,N=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function P(){x=Math.pow(10,(M+1)/16),C=Math.pow(10,(B+1)/16),E=Math.pow(10,V/10)}var j=[3.3246*3.3246,3.23837*3.23837,9.9500500969,9.0247369744,8.1854926609,7.0440875649,2.46209*2.46209,2.284*2.284,4.4892710641,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,2.4621061921,2.1508568964,1.37074*1.37074,1.31036*1.31036,1.5691069696,1.4555939904,1.16203*1.16203,1.2715945225,1.09428*1.09428,1.0659*1.0659,1.0779838276,1.0382591025,1],I=[1.7782755904,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.6999465924,1.22321*1.22321,1.3169398564,1],U=[5.5396212496,2.29259*2.29259,4.9868695969,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,2.2499700001,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.2339655056,1.0779838276];function L(e,t,n,r,a,s){var i,o,l;if(t>e){if(!(t<e*C))return e+t;i=t/e}else{if(e>=t*C)return e+t;i=e/t}if(e+=t,r+3<=6){if(i>=x)return e;var c=0|h.FAST_LOG10_X(i,16);return e*I[c]}return c=0|h.FAST_LOG10_X(i,16),t=0!=s?a.ATH.cb_s[n]*a.ATH.adjust:a.ATH.cb_l[n]*a.ATH.adjust,e<E*t?e>t?(o=1,c<=13&&(o=U[c]),l=h.FAST_LOG10_X(e/t,10/15),e*((j[c]-o)*l+o)):c>13?e:e*U[c]:e*j[c]}function O(e,t,n,r,a){var s,i,o=0,l=0;for(s=i=0;s<z.SBMAX_s;++i,++s){for(var c=e.bo_s[s],u=e.npart_s,p=c<u?c:u;i<p;)o+=t[i],l+=n[i],i++;if(e.en[r].s[s][a]=o,e.thm[r].s[s][a]=l,i>=u){++s;break}var d=e.PSY.bo_s_weight[s],f=1-d;o=d*t[i],l=d*n[i],e.en[r].s[s][a]+=o,e.thm[r].s[s][a]+=l,o=f*t[i],l=f*n[i]}for(;s<z.SBMAX_s;++s)e.en[r].s[s][a]=0,e.thm[r].s[s][a]=0}function D(e,t,n,r){var a,s,i=0,o=0;for(a=s=0;a<z.SBMAX_l;++s,++a){for(var l=e.bo_l[a],c=e.npart_l,u=l<c?l:c;s<u;)i+=t[s],o+=n[s],s++;if(e.en[r].l[a]=i,e.thm[r].l[a]=o,s>=c){++a;break}var p=e.PSY.bo_l_weight[a],d=1-p;i=p*t[s],o=p*n[s],e.en[r].l[a]+=i,e.thm[r].l[a]+=o,i=d*t[s],o=d*n[s]}for(;a<z.SBMAX_l;++a)e.en[r].l[a]=0,e.thm[r].l[a]=0}function H(e,t,n,r,a,s){var i,l,u=e.internal_flags;for(l=i=0;l<u.npart_s;++l){for(var p=0,d=u.numlines_s[l],f=0;f<d;++f,++i)p+=t[s][i];n[l]=p}for(i=l=0;l<u.npart_s;l++){var h=u.s3ind_s[l][0],_=u.s3_ss[i++]*n[h];for(++h;h<=u.s3ind_s[l][1];)_+=u.s3_ss[i]*n[h],++i,++h;var m=o*u.nb_s1[a][l];if(r[l]=Math.min(_,m),u.blocktype_old[1&a]==z.SHORT_TYPE){m=c*u.nb_s2[a][l];var v=r[l];r[l]=Math.min(m,v)}u.nb_s2[a][l]=u.nb_s1[a][l],u.nb_s1[a][l]=_}for(;l<=z.CBANDS;++l)n[l]=0,r[l]=0}function W(e,t,n,r){var a=e.internal_flags;e.short_blocks!=_.short_block_coupled||0!=t[0]&&0!=t[1]||(t[0]=t[1]=0);for(var s=0;s<a.channels_out;s++)r[s]=z.NORM_TYPE,e.short_blocks==_.short_block_dispensed&&(t[s]=1),e.short_blocks==_.short_block_forced&&(t[s]=0),0!=t[s]?a.blocktype_old[s]==z.SHORT_TYPE&&(r[s]=z.STOP_TYPE):(r[s]=z.SHORT_TYPE,a.blocktype_old[s]==z.NORM_TYPE&&(a.blocktype_old[s]=z.START_TYPE),a.blocktype_old[s]==z.STOP_TYPE&&(a.blocktype_old[s]=z.SHORT_TYPE)),n[s]=a.blocktype_old[s],a.blocktype_old[s]=r[s]}function F(e,t,n){return n>=1?e:n<=0?t:t>0?Math.pow(e/t,n)*t:0}var q=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function $(e,n){for(var r=309.07,a=0;a<z.SBMAX_s-1;a++)for(var s=0;s<3;s++){var i=e.thm.s[a][s];if(i>0){var o=i*n,l=e.en.s[a][s];l>o&&(r+=l>1e10*o?q[a]*(10*t):q[a]*h.FAST_LOG10(l/o))}}return r}var X=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function K(e,n){for(var r=281.0575,a=0;a<z.SBMAX_l-1;a++){var s=e.thm.l[a];if(s>0){var i=s*n,o=e.en.l[a];o>i&&(r+=o>1e10*i?X[a]*(10*t):X[a]*h.FAST_LOG10(o/i))}}return r}function Y(e,t,n,r,a){var s,i;for(s=i=0;s<e.npart_l;++s){var o,l=0,c=0;for(o=0;o<e.numlines_l[s];++o,++i){var u=t[i];l+=u,c<u&&(c=u)}n[s]=l,r[s]=c,a[s]=l*e.rnumlines_l[s]}}function G(e,t,n,r){var a=N.length-1,s=0,i=n[s]+n[s+1];for(i>0?((o=t[s])<t[s+1]&&(o=t[s+1]),(l=0|(i=20*(2*o-i)/(i*(e.numlines_l[s]+e.numlines_l[s+1]-1))))>a&&(l=a),r[s]=l):r[s]=0,s=1;s<e.npart_l-1;s++){var o,l;(i=n[s-1]+n[s]+n[s+1])>0?((o=t[s-1])<t[s]&&(o=t[s]),o<t[s+1]&&(o=t[s+1]),(l=0|(i=20*(3*o-i)/(i*(e.numlines_l[s-1]+e.numlines_l[s]+e.numlines_l[s+1]-1))))>a&&(l=a),r[s]=l):r[s]=0}(i=n[s-1]+n[s])>0?((o=t[s-1])<t[s]&&(o=t[s]),(l=0|(i=20*(2*o-i)/(i*(e.numlines_l[s-1]+e.numlines_l[s]-1))))>a&&(l=a),r[s]=l):r[s]=0}var Q=[-1730326e-23,-.01703172,-1349528e-23,.0418072,-673278e-22,-.0876324,-30835e-21,.1863476,-1104424e-22,-.627638];function Z(e){var t,n,r,a;return t=e,n=(t*=t>=0?3:1.5)>=.5&&t<=2.5?8*((a=t-.5)*a-2*a):0,(r=15.811389+7.5*(t+=.474)-17.5*Math.sqrt(1+t*t))<=-60?0:(t=Math.exp((n+r)*k),t/=.6609193)}function ee(e){return e<0&&(e=0),e*=.001,13*Math.atan(.76*e)+3.5*Math.atan(e*e/56.25)}function te(e,t,n,r,a,o,l,c,p,d,f,h){var _,m=i(z.CBANDS+1),v=c/(h>15?1152:384),g=s(z.HBLKSIZE);c/=p;var b=0,w=0;for(_=0;_<z.CBANDS;_++){var y;for(M=ee(c*b),m[_]=c*b,y=b;ee(c*y)-M<u&&y<=p/2;y++);for(e[_]=y-b,w=_+1;b<y;)g[b++]=_;if(b>p/2){b=p/2,++_;break}}m[_]=c*b;for(var S=0;S<h;S++){var R,k,A,T,x;A=d[S],T=d[S+1],(R=0|Math.floor(.5+f*(A-.5)))<0&&(R=0),(k=0|Math.floor(.5+f*(T-.5)))>p/2&&(k=p/2),n[S]=(g[R]+g[k])/2,t[S]=g[k];var C=v*T;l[S]=(C-m[t[S]])/(m[t[S]+1]-m[t[S]]),l[S]<0?l[S]=0:l[S]>1&&(l[S]=1),x=ee(c*d[S]*f),x=Math.min(x,15.5)/15.5,o[S]=Math.pow(10,1.25*(1-Math.cos(Math.PI*x))-2.5)}b=0;for(var E=0;E<w;E++){var M,B,V=e[E];M=ee(c*b),B=ee(c*(b+V-1)),r[E]=.5*(M+B),M=ee(c*(b-.5)),B=ee(c*(b+V-.5)),a[E]=B-M,b+=V}return w}function ne(e,t,r,a,s,o){var c,u=l([z.CBANDS,z.CBANDS]),p=0;if(o)for(var d=0;d<t;d++)for(c=0;c<t;c++){var f=Z(r[d]-r[c])*a[c];u[d][c]=f*s[d]}else n();for(d=0;d<t;d++){for(c=0;c<t&&!(u[d][c]>0);c++);for(e[d][0]=c,c=t-1;c>0&&!(u[d][c]>0);c--);e[d][1]=c,p+=e[d][1]-e[d][0]+1}var h=i(p),_=0;for(d=0;d<t;d++)for(c=e[d][0];c<=e[d][1];c++)h[_++]=u[d][c];return h}function re(e){var t=ee(e);return t=Math.min(t,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*t))-2.5)}function ae(e,t){return e<-.3&&(e=3410),e/=1e3,e=Math.max(.1,e),3.64*Math.pow(e,-.8)-6.8*Math.exp(-.6*Math.pow(e-3.4,2))+6*Math.exp(-.15*Math.pow(e-8.7,2))+.001*(.6+.04*t)*Math.pow(e,4)}this.L3psycho_anal_ns=function(e,t,o,c,u,p,f,h,_,m){var S,k,A,x,C,E,M,B,V,P=e.internal_flags,j=l([2,z.BLKSIZE]),I=l([2,3,z.BLKSIZE_s]),U=i(z.CBANDS+1),q=i(z.CBANDS+1),X=i(z.CBANDS+2),J=s(2),Z=s(2),ee=l([2,576]),te=s(z.CBANDS+2),ne=s(z.CBANDS+2);for(d.fill(ne,0),S=P.channels_out,e.mode==g.JOINT_STEREO&&(S=4),V=e.VBR==v.vbr_off?0==P.ResvMax?0:P.ResvSize/P.ResvMax*.5:e.VBR==v.vbr_rh||e.VBR==v.vbr_mtrh||e.VBR==v.vbr_mt?.6:1,k=0;k<P.channels_out;k++){var re=t[k],ae=o+576-350-R+192;for(x=0;x<576;x++){var se,ie;for(se=re[ae+x+10],ie=0,C=0;C<(R-1)/2-1;C+=2)se+=Q[C]*(re[ae+x+C]+re[ae+x+R-C]),ie+=Q[C+1]*(re[ae+x+C+1]+re[ae+x+R-C-1]);ee[k][x]=se+ie}u[c][k].en.assign(P.en[k]),u[c][k].thm.assign(P.thm[k]),S>2&&n()}for(k=0;k<S;k++){var oe,le=i(12),ce=[0,0,0,0],ue=i(12),pe=1,de=i(z.CBANDS),fe=i(z.CBANDS),he=[0,0,0,0],_e=i(z.HBLKSIZE),me=l([3,z.HBLKSIZE_s]);for(x=0;x<3;x++)le[x]=P.nsPsy.last_en_subshort[k][x+6],ue[x]=le[x]/P.nsPsy.last_en_subshort[k][x+4],ce[0]+=le[x];2==k&&n();var ve=ee[1&k],ge=0;for(x=0;x<9;x++){for(var be=ge+64,we=1;ge<be;ge++)we<Math.abs(ve[ge])&&(we=Math.abs(ve[ge]));P.nsPsy.last_en_subshort[k][x]=le[x+3]=we,ce[1+x/3]+=we,we>le[x+3-2]?we/=le[x+3-2]:we=le[x+3-2]>10*we?le[x+3-2]/(10*we):0,ue[x+3]=we}for(e.analysis&&n(),oe=3==k?P.nsPsy.attackthre_s:P.nsPsy.attackthre,x=0;x<12;x++)0==he[x/3]&&ue[x]>oe&&(he[x/3]=x%3+1);for(x=1;x<4;x++)(ce[x-1]>ce[x]?ce[x-1]/ce[x]:ce[x]/ce[x-1])<1.7&&(he[x]=0,1==x&&(he[0]=0));for(0!=he[0]&&0!=P.nsPsy.lastAttacks[k]&&(he[0]=0),3!=P.nsPsy.lastAttacks[k]&&he[0]+he[1]+he[2]+he[3]==0||(pe=0,0!=he[1]&&0!=he[0]&&(he[1]=0),0!=he[2]&&0!=he[1]&&(he[2]=0),0!=he[3]&&0!=he[2]&&(he[3]=0)),k<2?Z[k]=pe:n(),_[k]=P.tot_ener[k],T(e,_e,me,j,1&k,I,1&k,c,k,t,o),Y(P,_e,U,de,fe),G(P,de,fe,te),B=0;B<3;B++){var ye,Se;for(H(e,me,q,X,k,B),O(P,q,X,k,B),M=0;M<z.SBMAX_s;M++){if(Se=P.thm[k].s[M][B],Se*=b,he[B]>=2||1==he[B+1]){var Re=0!=B?B-1:2;we=F(P.thm[k].s[M][Re],Se,w*V),Se=Math.min(Se,we)}1==he[B]?(Re=0!=B?B-1:2,we=F(P.thm[k].s[M][Re],Se,y*V),Se=Math.min(Se,we)):(0!=B&&3==he[B-1]||0==B&&3==P.nsPsy.lastAttacks[k])&&(Re=2!=B?B+1:0,we=F(P.thm[k].s[M][Re],Se,y*V),Se=Math.min(Se,we)),ye=le[3*B+3]+le[3*B+4]+le[3*B+5],6*le[3*B+5]<ye&&(Se*=.5,6*le[3*B+4]<ye&&(Se*=.5)),P.thm[k].s[M][B]=Se}}for(P.nsPsy.lastAttacks[k]=he[2],E=0,A=0;A<P.npart_l;A++){for(var ke=P.s3ind[A][0],Ae=U[ke]*N[te[ke]],Te=P.s3_ll[E++]*Ae;++ke<=P.s3ind[A][1];)Ae=U[ke]*N[te[ke]],Te=L(Te,P.s3_ll[E++]*Ae,ke,ke-A,P,0);Te*=.158489319246111,P.blocktype_old[1&k]==z.SHORT_TYPE?X[A]=Te:X[A]=F(Math.min(Te,Math.min(r*P.nb_1[k][A],a*P.nb_2[k][A])),Te,V),P.nb_2[k][A]=P.nb_1[k][A],P.nb_1[k][A]=Te}for(;A<=z.CBANDS;++A)U[A]=0,X[A]=0;D(P,U,X,k)}for(e.mode!=g.STEREO&&e.mode!=g.JOINT_STEREO||n(),e.mode==g.JOINT_STEREO&&n(),W(e,Z,m,J),k=0;k<S;k++){var xe,Ce,Ee,Me=0;k>1?n():(xe=f,Me=0,Ce=m[k],Ee=u[c][k]),Ce==z.SHORT_TYPE?xe[Me+k]=$(Ee,P.masking_lower):xe[Me+k]=K(Ee,P.masking_lower),e.analysis&&(P.pinfo.pe[c][k]=xe[Me+k])}return 0},this.psymodel_init=function(n){var r,a,s=n.internal_flags,o=!0,l=13,c=24,u=0,p=0,d=-8.25,h=-4.5,_=i(z.CBANDS),g=i(z.CBANDS),b=i(z.CBANDS),w=n.out_samplerate;switch(n.experimentalZ){default:case 0:o=!0;break;case 1:o=n.VBR!=v.vbr_mtrh&&n.VBR!=v.vbr_mt;break;case 2:o=!1;break;case 3:l=8,u=-1.75,p=-.0125,d=-8.25,h=-2.25}for(s.ms_ener_ratio_old=.25,s.blocktype_old[0]=s.blocktype_old[1]=z.NORM_TYPE,r=0;r<4;++r){for(var y=0;y<z.CBANDS;++y)s.nb_1[r][y]=1e20,s.nb_2[r][y]=1e20,s.nb_s1[r][y]=s.nb_s2[r][y]=1;for(var R=0;R<z.SBMAX_l;R++)s.en[r].l[R]=1e20,s.thm[r].l[R]=1e20;for(y=0;y<3;++y){for(R=0;R<z.SBMAX_s;R++)s.en[r].s[R][y]=1e20,s.thm[r].s[R][y]=1e20;s.nsPsy.lastAttacks[r]=0}for(y=0;y<9;y++)s.nsPsy.last_en_subshort[r][y]=10}for(s.loudness_sq_save[0]=s.loudness_sq_save[1]=0,s.npart_l=te(s.numlines_l,s.bo_l,s.bm_l,_,g,s.mld_l,s.PSY.bo_l_weight,w,z.BLKSIZE,s.scalefac_band.l,z.BLKSIZE/1152,z.SBMAX_l),r=0;r<s.npart_l;r++){var k=u;_[r]>=l&&(k=p*(_[r]-l)/(c-l)+u*(c-_[r])/(c-l)),b[r]=Math.pow(10,k/10),s.numlines_l[r]>0?s.rnumlines_l[r]=1/s.numlines_l[r]:s.rnumlines_l[r]=0}for(s.s3_ll=ne(s.s3ind,s.npart_l,_,g,b,o),y=0,r=0;r<s.npart_l;r++){x=m.MAX_VALUE;for(var A=0;A<s.numlines_l[r];A++,y++){var T=w*y/(1e3*z.BLKSIZE);C=this.ATHformula(1e3*T,n)-20,C=Math.pow(10,.1*C),x>(C*=s.numlines_l[r])&&(x=C)}s.ATH.cb_l[r]=x,(x=20*_[r]/10-20)>6&&(x=100),x<-15&&(x=-15),x-=8,s.minval_l[r]=Math.pow(10,x/10)*s.numlines_l[r]}for(s.npart_s=te(s.numlines_s,s.bo_s,s.bm_s,_,g,s.mld_s,s.PSY.bo_s_weight,w,z.BLKSIZE_s,s.scalefac_band.s,z.BLKSIZE_s/384,z.SBMAX_s),y=0,r=0;r<s.npart_s;r++){var x;for(k=d,_[r]>=l&&(k=h*(_[r]-l)/(c-l)+d*(c-_[r])/(c-l)),b[r]=Math.pow(10,k/10),x=m.MAX_VALUE,A=0;A<s.numlines_s[r];A++,y++){var C;T=w*y/(1e3*z.BLKSIZE_s),C=this.ATHformula(1e3*T,n)-20,C=Math.pow(10,.1*C),x>(C*=s.numlines_s[r])&&(x=C)}s.ATH.cb_s[r]=x,x=7*_[r]/12-7,_[r]>12&&(x*=1+3.1*Math.log(1+x)),_[r]<12&&(x*=1+2.3*Math.log(1-x)),x<-15&&(x=-15),x-=8,s.minval_s[r]=Math.pow(10,x/10)*s.numlines_s[r]}s.s3_ss=ne(s.s3ind_s,s.npart_s,_,g,b,o),P(),e.init_fft(s),s.decay=Math.exp(-1*t/(f*w/192)),a=S,0!=(2&n.exp_nspsytune)&&(a=1),Math.abs(n.msfix)>0&&(a=n.msfix),n.msfix=a;for(var E=0;E<s.npart_l;E++)s.s3ind[E][1]>s.npart_l-1&&(s.s3ind[E][1]=s.npart_l-1);var M=576*s.mode_gr/w;if(s.ATH.decay=Math.pow(10,-1.2*M),s.ATH.adjust=.01,s.ATH.adjustLimit=1,-1!=n.ATHtype){var B=n.out_samplerate/z.BLKSIZE,V=0;for(T=0,r=0;r<z.BLKSIZE/2;++r)T+=B,s.ATH.eql_w[r]=1/Math.pow(10,this.ATHformula(T,n)/10),V+=s.ATH.eql_w[r];for(V=1/V,r=z.BLKSIZE/2;--r>=0;)s.ATH.eql_w[r]*=V}for(E=y=0;E<s.npart_s;++E)for(r=0;r<s.numlines_s[E];++r)++y;for(E=y=0;E<s.npart_l;++E)for(r=0;r<s.numlines_l[E];++r)++y;for(y=0,r=0;r<s.npart_l;r++)T=w*(y+s.numlines_l[r]/2)/(1*z.BLKSIZE),s.mld_cb_l[r]=re(T),y+=s.numlines_l[r];for(;r<z.CBANDS;++r)s.mld_cb_l[r]=1;for(y=0,r=0;r<s.npart_s;r++)T=w*(y+s.numlines_s[r]/2)/(1*z.BLKSIZE_s),s.mld_cb_s[r]=re(T),y+=s.numlines_s[r];for(;r<z.CBANDS;++r)s.mld_cb_s[r]=1;return 0},this.ATHformula=function(e,t){var n;switch(t.ATHtype){case 0:n=ae(e,9);break;case 1:n=ae(e,-1);break;case 2:default:n=ae(e,0);break;case 3:n=ae(e,1)+6;break;case 4:n=ae(e,t.ATHcurve)}return n}}function G(){var e=this,t=131072;G.V9=410,G.V8=420,G.V7=430,G.V6=440,G.V5=450,G.V4=460,G.V3=470,G.V2=480,G.V1=490,G.V0=500,G.R3MIX=1e3,G.STANDARD=1001,G.EXTREME=1002,G.INSANE=1003,G.STANDARD_FAST=1004,G.EXTREME_FAST=1005,G.MEDIUM=1006,G.MEDIUM_FAST=1007;var r,a,s,o,l,p=16384+t;G.LAME_MAXMP3BUFFER=p;var d,f,h=new Y;function m(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=i(z.SBMAX_l),this.bo_s_weight=i(z.SBMAX_s)}function b(){this.lowerlimit=0}function w(e,t){this.lowpass=t}this.enc=new z,this.setModules=function(e,t,n,i,c,u,p,_,m){r=e,a=t,s=n,o=i,l=c,d=u,f=_,this.enc.setModules(a,h,o,d)};var S=4294479419;function R(e){var t;return e.class_id=S,t=e.internal_flags=new K,e.mode=g.NOT_SET,e.original=1,e.in_samplerate=44100,e.num_channels=2,e.num_samples=-1,e.bWriteVbrTag=!0,e.quality=-1,e.short_blocks=null,t.subblock_gain=-1,e.lowpassfreq=0,e.highpassfreq=0,e.lowpasswidth=-1,e.highpasswidth=-1,e.VBR=v.vbr_off,e.VBR_q=4,e.ATHcurve=-1,e.VBR_mean_bitrate_kbps=128,e.VBR_min_bitrate_kbps=0,e.VBR_max_bitrate_kbps=0,e.VBR_hard_min=0,t.VBR_min_bitrate=1,t.VBR_max_bitrate=13,e.quant_comp=-1,e.quant_comp_short=-1,e.msfix=-1,t.resample_ratio=1,t.OldValue[0]=180,t.OldValue[1]=180,t.CurrentStep[0]=4,t.CurrentStep[1]=4,t.masking_lower=1,t.nsPsy.attackthre=-1,t.nsPsy.attackthre_s=-1,e.scale=-1,e.athaa_type=-1,e.ATHtype=-1,e.athaa_loudapprox=-1,e.athaa_sensitivity=0,e.useTemporal=null,e.interChRatio=-1,t.mf_samples_to_encode=z.ENCDELAY+z.POSTDELAY,e.encoder_padding=0,t.mf_size=z.ENCDELAY-z.MDCTDELAY,e.findReplayGain=!1,e.decode_on_the_fly=!1,t.decode_on_the_fly=!1,t.findReplayGain=!1,t.findPeakSample=!1,t.RadioGain=0,t.AudiophileGain=0,t.noclipGainChange=0,t.noclipScale=-1,e.preset=0,e.write_id3tag_automatic=!0,0}function k(e){return e>1?0:e<=0?1:Math.cos(Math.PI/2*e)}function T(e,t){switch(e){case 44100:return t.version=1,0;case 48e3:return t.version=1,1;case 32e3:return t.version=1,2;case 22050:case 11025:return t.version=0,0;case 24e3:case 12e3:return t.version=0,1;case 16e3:case 8e3:return t.version=0,2;default:return t.version=0,-1}}function C(e,t,n){n<16e3&&(t=2);for(var r=x.bitrate_table[t][1],a=2;a<=14;a++)x.bitrate_table[t][a]>0&&Math.abs(x.bitrate_table[t][a]-e)<Math.abs(r-e)&&(r=x.bitrate_table[t][a]);return r}function E(e,t,n){n<16e3&&(t=2);for(var r=0;r<=14;r++)if(x.bitrate_table[t][r]>0&&x.bitrate_table[t][r]==e)return r;return-1}function M(t,n){var r=[new w(8,2e3),new w(16,3700),new w(24,3900),new w(32,5500),new w(40,7e3),new w(48,7500),new w(56,1e4),new w(64,11e3),new w(80,13500),new w(96,15100),new w(112,15600),new w(128,17e3),new w(160,17500),new w(192,18600),new w(224,19400),new w(256,19700),new w(320,20500)],a=e.nearestBitrateFullIndex(n);t.lowerlimit=r[a].lowpass}function j(e){var t=e.internal_flags,r=32;if(t.lowpass1>0){for(var a=999,s=0;s<=31;s++)(l=s/31)>=t.lowpass2&&(r=Math.min(r,s)),t.lowpass1<l&&l<t.lowpass2&&(a=Math.min(a,s));t.lowpass1=999==a?(r-.75)/31:(a-.75)/31,t.lowpass2=r/31}for(t.highpass2>0&&n(),t.highpass2>0&&n(),s=0;s<32;s++){var i,o,l=s/31;t.highpass2>t.highpass1?n():i=1,o=t.lowpass2>t.lowpass1?k((l-t.lowpass1)/(t.lowpass2-t.lowpass1+1e-20)):1,t.amp_filter[s]=i*o}}function I(e){var t=e.internal_flags;switch(e.quality){default:case 9:t.psymodel=0,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 8:e.quality=7;case 7:t.psymodel=1,t.noise_shaping=0,t.noise_shaping_amp=0,t.noise_shaping_stop=0,t.use_best_huffman=0,t.full_outer_loop=0;break;case 6:case 5:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=0,t.full_outer_loop=0;break;case 4:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=0,t.noise_shaping_stop=0,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 3:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 2:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=1,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0;break;case 1:case 0:t.psymodel=1,0==t.noise_shaping&&(t.noise_shaping=1),0==t.substep_shaping&&(t.substep_shaping=2),t.noise_shaping_amp=2,t.noise_shaping_stop=1,-1==t.subblock_gain&&(t.subblock_gain=1),t.use_best_huffman=1,t.full_outer_loop=0}}function U(e){var t=e.internal_flags;e.frameNum=0,e.write_id3tag_automatic&&f.id3tag_write_v2(e),t.bitrate_stereoMode_Hist=c([16,5]),t.bitrate_blockType_Hist=c([16,6]),t.PeakSample=0,e.bWriteVbrTag&&d.InitVbrTag(e)}function L(e,t){(null==e.in_buffer_0||e.in_buffer_nsamples<t)&&(e.in_buffer_0=i(t),e.in_buffer_1=i(t),e.in_buffer_nsamples=t)}function O(e){var t=z.BLKSIZE+e.framesize-z.FFTOFFSET;return t=Math.max(t,512+e.framesize-32)}function D(e,t,s,i,o,l,c){var u,p,d,f,h,_=e.internal_flags,m=0,v=[null,null],g=[null,null];if(_.Class_ID!=S)return-3;if(0==i)return 0;if((h=a.copy_buffer(_,o,l,c,0))<0)return h;if(l+=h,m+=h,g[0]=t,g[1]=s,A.NEQ(e.scale,0)&&A.NEQ(e.scale,1))for(p=0;p<i;++p)g[0][p]*=e.scale,2==_.channels_out&&(g[1][p]*=e.scale);if(A.NEQ(e.scale_left,0)&&A.NEQ(e.scale_left,1))for(p=0;p<i;++p)g[0][p]*=e.scale_left;if(A.NEQ(e.scale_right,0)&&A.NEQ(e.scale_right,1))for(p=0;p<i;++p)g[1][p]*=e.scale_right;2==e.num_channels&&1==_.channels_out&&n(),f=O(e),v[0]=_.mfbuf[0],v[1]=_.mfbuf[1];for(var b=0;i>0;){var w=[null,null],R=0,k=0;w[0]=g[0],w[1]=g[1];var T=new W;if(F(e,v,w,b,i,T),R=T.n_in,k=T.n_out,_.findReplayGain&&!_.decode_on_the_fly&&r.AnalyzeSamples(_.rgdata,v[0],_.mf_size,v[1],_.mf_size,k,_.channels_out)==y.GAIN_ANALYSIS_ERROR)return-6;if(i-=R,b+=R,_.channels_out,_.mf_size+=k,_.mf_samples_to_encode<1&&n(),_.mf_samples_to_encode+=k,_.mf_size>=f){var x=c-m;if(0==c&&(x=0),(u=H(e,v[0],v[1],o,l,x))<0)return u;for(l+=u,m+=u,_.mf_size-=e.framesize,_.mf_samples_to_encode-=e.framesize,d=0;d<_.channels_out;d++)for(p=0;p<_.mf_size;p++)v[d][p]=v[d][p+e.framesize]}}return m}function H(t,n,r,a,s,i){var o=e.enc.lame_encode_mp3_frame(t,n,r,a,s,i);return t.frameNum++,o}function W(){this.n_in=0,this.n_out=0}function F(e,t,r,a,s,i){var o=e.internal_flags;if(o.resample_ratio<.9999||o.resample_ratio>1.0001)n();else{i.n_out=Math.min(e.framesize,s),i.n_in=i.n_out;for(var l=0;l<i.n_out;++l)t[0][o.mf_size+l]=r[0][a+l],2==o.channels_out&&(t[1][o.mf_size+l]=r[1][a+l])}}this.lame_init=function(){var e=new V;return R(e),e.lame_allocated_gfp=1,e},this.nearestBitrateFullIndex=function(e){var t=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],n=0,r=0,a=0,s=0;s=t[16],a=16,r=t[16],n=16;for(var i=0;i<16;i++)if(Math.max(e,t[i+1])!=e){s=t[i+1],a=i+1,r=t[i],n=i;break}return s-e>e-r?n:a},this.lame_init_params=function(e){var t=e.internal_flags;if(t.Class_ID=0,null==t.ATH&&(t.ATH=new B),null==t.PSY&&(t.PSY=new m),null==t.rgdata&&(t.rgdata=new P),t.channels_in=e.num_channels,1==t.channels_in&&(e.mode=g.MONO),t.channels_out=e.mode==g.MONO?1:2,t.mode_ext=z.MPG_MD_MS_LR,e.mode==g.MONO&&(e.force_ms=!1),e.VBR==v.vbr_off&&128!=e.VBR_mean_bitrate_kbps&&0==e.brate&&(e.brate=e.VBR_mean_bitrate_kbps),e.VBR==v.vbr_off||e.VBR==v.vbr_mtrh||e.VBR==v.vbr_mt||(e.free_format=!1),e.VBR==v.vbr_off&&0==e.brate&&n(),e.VBR==v.vbr_off&&e.compression_ratio>0&&n(),0!=e.out_samplerate&&(e.out_samplerate<16e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,64)):e.out_samplerate<32e3?(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,8),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,160)):(e.VBR_mean_bitrate_kbps=Math.max(e.VBR_mean_bitrate_kbps,32),e.VBR_mean_bitrate_kbps=Math.min(e.VBR_mean_bitrate_kbps,320))),0==e.lowpassfreq){var r=16e3;switch(e.VBR){case v.vbr_off:M(i=new b,e.brate),r=i.lowerlimit;break;case v.vbr_abr:var i;M(i=new b,e.VBR_mean_bitrate_kbps),r=i.lowerlimit;break;case v.vbr_rh:n();default:n()}e.mode!=g.MONO||e.VBR!=v.vbr_off&&e.VBR!=v.vbr_abr||(r*=1.5),e.lowpassfreq=0|r}switch(0==e.out_samplerate&&n(),e.lowpassfreq=Math.min(20500,e.lowpassfreq),e.lowpassfreq=Math.min(e.out_samplerate/2,e.lowpassfreq),e.VBR==v.vbr_off&&(e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)),e.VBR==v.vbr_abr&&n(),e.bWriteVbrTag||(e.findReplayGain=!1,e.decode_on_the_fly=!1,t.findPeakSample=!1),t.findReplayGain=e.findReplayGain,t.decode_on_the_fly=e.decode_on_the_fly,t.decode_on_the_fly&&(t.findPeakSample=!0),t.findReplayGain&&n(),t.decode_on_the_fly&&!e.decode_only&&n(),t.mode_gr=e.out_samplerate<=24e3?1:2,e.framesize=576*t.mode_gr,e.encoder_delay=z.ENCDELAY,t.resample_ratio=e.in_samplerate/e.out_samplerate,e.VBR){case v.vbr_mt:case v.vbr_rh:case v.vbr_mtrh:var c=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];e.compression_ratio=c[e.VBR_q];break;case v.vbr_abr:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.VBR_mean_bitrate_kbps);break;default:e.compression_ratio=16*e.out_samplerate*t.channels_out/(1e3*e.brate)}e.mode==g.NOT_SET&&(e.mode=g.JOINT_STEREO),e.highpassfreq>0?n():(t.highpass1=0,t.highpass2=0),e.lowpassfreq>0?(t.lowpass2=2*e.lowpassfreq,e.lowpasswidth>=0?n():t.lowpass1=2*e.lowpassfreq,t.lowpass1/=e.out_samplerate,t.lowpass2/=e.out_samplerate):n(),j(e),t.samplerate_index=T(e.out_samplerate,e),t.samplerate_index<0&&n(),e.VBR==v.vbr_off?e.free_format?t.bitrate_index=0:(e.brate=C(e.brate,e.version,e.out_samplerate),t.bitrate_index=E(e.brate,e.version,e.out_samplerate),t.bitrate_index<=0&&n()):t.bitrate_index=1,e.analysis&&(e.bWriteVbrTag=!1),null!=t.pinfo&&(e.bWriteVbrTag=!1),a.init_bit_stream_w(t);for(var u,p=t.samplerate_index+3*e.version+6*(e.out_samplerate<16e3?1:0),d=0;d<z.SBMAX_l+1;d++)t.scalefac_band.l[d]=o.sfBandIndex[p].l[d];for(d=0;d<z.PSFB21+1;d++){var f=(t.scalefac_band.l[22]-t.scalefac_band.l[21])/z.PSFB21,w=t.scalefac_band.l[21]+d*f;t.scalefac_band.psfb21[d]=w}for(t.scalefac_band.psfb21[z.PSFB21]=576,d=0;d<z.SBMAX_s+1;d++)t.scalefac_band.s[d]=o.sfBandIndex[p].s[d];for(d=0;d<z.PSFB12+1;d++)f=(t.scalefac_band.s[13]-t.scalefac_band.s[12])/z.PSFB12,w=t.scalefac_band.s[12]+d*f,t.scalefac_band.psfb12[d]=w;for(t.scalefac_band.psfb12[z.PSFB12]=192,1==e.version?t.sideinfo_len=1==t.channels_out?21:36:t.sideinfo_len=1==t.channels_out?13:21,e.error_protection&&(t.sideinfo_len+=2),U(e),t.Class_ID=S,u=0;u<19;u++)t.nsPsy.pefirbuf[u]=700*t.mode_gr*t.channels_out;switch(-1==e.ATHtype&&(e.ATHtype=4),e.VBR){case v.vbr_mt:e.VBR=v.vbr_mtrh;case v.vbr_mtrh:null==e.useTemporal&&(e.useTemporal=!1),s.apply_preset(e,500-10*e.VBR_q,0),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),e.quality<5&&(e.quality=0),e.quality>5&&(e.quality=5),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,t.iteration_loop=new VBRNewIterationLoop(l);break;case v.vbr_rh:s.apply_preset(e,500-10*e.VBR_q,0),t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,e.experimentalY?t.sfb21_extra=!1:t.sfb21_extra=e.out_samplerate>44e3,e.quality>6&&(e.quality=6),e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),t.iteration_loop=new VBROldIterationLoop(l);break;default:var y;t.sfb21_extra=!1,e.quality<0&&(e.quality=LAME_DEFAULT_QUALITY),(y=e.VBR)==v.vbr_off&&(e.VBR_mean_bitrate_kbps=e.brate),s.apply_preset(e,e.VBR_mean_bitrate_kbps,0),e.VBR=y,t.PSY.mask_adjust=e.maskingadjust,t.PSY.mask_adjust_short=e.maskingadjust_short,y==v.vbr_off?t.iteration_loop=new N(l):n()}return e.VBR!=v.vbr_off&&n(),e.tune&&n(),I(e),e.athaa_type<0?t.ATH.useAdjust=3:t.ATH.useAdjust=e.athaa_type,t.ATH.aaSensitivityP=Math.pow(10,e.athaa_sensitivity/-10),null==e.short_blocks&&(e.short_blocks=_.short_block_allowed),e.short_blocks!=_.short_block_allowed||e.mode!=g.JOINT_STEREO&&e.mode!=g.STEREO||(e.short_blocks=_.short_block_coupled),e.quant_comp<0&&(e.quant_comp=1),e.quant_comp_short<0&&(e.quant_comp_short=0),e.msfix<0&&(e.msfix=0),e.exp_nspsytune=1|e.exp_nspsytune,e.internal_flags.nsPsy.attackthre<0&&(e.internal_flags.nsPsy.attackthre=Y.NSATTACKTHRE),e.internal_flags.nsPsy.attackthre_s<0&&(e.internal_flags.nsPsy.attackthre_s=Y.NSATTACKTHRE_S),e.scale<0&&(e.scale=1),e.ATHtype<0&&(e.ATHtype=4),e.ATHcurve<0&&(e.ATHcurve=4),e.athaa_loudapprox<0&&(e.athaa_loudapprox=2),e.interChRatio<0&&(e.interChRatio=0),null==e.useTemporal&&(e.useTemporal=!0),t.slot_lag=t.frac_SpF=0,e.VBR==v.vbr_off&&(t.slot_lag=t.frac_SpF=72e3*(e.version+1)*e.brate%e.out_samplerate|0),o.iteration_init(e),h.psymodel_init(e),0},this.lame_encode_flush=function(e,t,r,s){var i,o,l,c,p=e.internal_flags,d=u([2,1152]),f=0,h=p.mf_samples_to_encode-z.POSTDELAY,_=O(e);if(p.mf_samples_to_encode<1)return 0;for(i=0,e.in_samplerate!=e.out_samplerate&&n(),(l=e.framesize-h%e.framesize)<576&&(l+=e.framesize),e.encoder_padding=l,c=(h+l)/e.framesize;c>0&&f>=0;){var m=_-p.mf_size,v=e.frameNum;m*=e.in_samplerate,(m/=e.out_samplerate)>1152&&(m=1152),m<1&&(m=1),o=s-i,0==s&&(o=0),r+=f=this.lame_encode_buffer(e,d[0],d[1],m,t,r,o),i+=f,c-=v!=e.frameNum?1:0}return p.mf_samples_to_encode=0,f<0?f:(o=s-i,0==s&&(o=0),a.flush_bitstream(e),(f=a.copy_buffer(p,t,r,o,1))<0?f:(r+=f,o=s-(i+=f),0==s&&(o=0),e.write_id3tag_automatic&&n(),i))},this.lame_encode_buffer=function(e,t,n,r,a,s,i){var o=e.internal_flags,l=[null,null];if(o.Class_ID!=S)return-3;if(0==r)return 0;L(o,r),l[0]=o.in_buffer_0,l[1]=o.in_buffer_1;for(var c=0;c<r;c++)l[0][c]=t[c],o.channels_in>1&&(l[1][c]=n[c]);return D(e,l[0],l[1],r,a,s,i)}}function Q(){this.setModules=function(e,t){}}function Z(){this.setModules=function(e,t,n){}}function ee(){}function te(){this.setModules=function(e,t){}}function ne(e,t,a){1!=e&&n("fix cc: only supports mono");var s=new G,i=new Q,o=new y,l=new A,c=new S,u=new I,p=new D,d=new k,f=new b,h=new te,_=new R,m=new w,v=new Z,T=new ee;s.setModules(o,l,c,u,p,d,f,h,T),l.setModules(o,T,f,d),h.setModules(l,f),c.setModules(s),p.setModules(l,_,u,m),u.setModules(m,_,s.enc.psy),_.setModules(l),m.setModules(u),d.setModules(s,l,f),i.setModules(v,T),v.setModules(f,h,c);var x=s.lame_init();x.num_channels=e,x.in_samplerate=t,x.out_samplerate=t,x.brate=a,x.mode=g.STEREO,x.quality=3,x.bWriteVbrTag=!1,x.disable_reservoir=!0,x.write_id3tag_automatic=!1,s.lame_init_params(x);var C=1152,E=0|1.25*C+7200,M=r(E);this.encodeBuffer=function(t,n){1==e&&(n=t),t.length>C&&(C=t.length,M=r(E=0|1.25*C+7200));var a=s.lame_encode_buffer(x,t,n,t.length,M,0,E);return new Int8Array(M.subarray(0,a))},this.flush=function(){var e=s.lame_encode_flush(x,M,0,E);return new Int8Array(M.subarray(0,e))}}O.SFBMAX=3*z.SBMAX_s,z.ENCDELAY=576,z.POSTDELAY=1152,z.MDCTDELAY=48,z.FFTOFFSET=224+z.MDCTDELAY,z.DECDELAY=528,z.SBLIMIT=32,z.CBANDS=64,z.SBPSY_l=21,z.SBPSY_s=12,z.SBMAX_l=22,z.SBMAX_s=13,z.PSFB21=6,z.PSFB12=6,z.BLKSIZE=1024,z.HBLKSIZE=z.BLKSIZE/2+1,z.BLKSIZE_s=256,z.HBLKSIZE_s=z.BLKSIZE_s/2+1,z.NORM_TYPE=0,z.START_TYPE=1,z.SHORT_TYPE=2,z.STOP_TYPE=3,z.MPG_MD_LR_LR=0,z.MPG_MD_LR_I=1,z.MPG_MD_MS_LR=2,z.MPG_MD_MS_I=3,z.fircoef=[-.1039435,-.1892065,5*-.0432472,-.155915,3898045e-23,.0467745*5,.50455,.756825,.187098*5],K.MFSIZE=3456+z.ENCDELAY-z.MDCTDELAY,K.MAX_HEADER_BUF=256,K.MAX_BITS_PER_CHANNEL=4095,K.MAX_BITS_PER_GRANULE=7680,K.BPC=320,O.SFBMAX=3*z.SBMAX_s,t.Mp3Encoder=ne}t(),e.lamejs=t}(("object"==typeof window&&window.document?window:Object).Recorder),function(e){var t,n,r,a,s,i,o="object"==typeof window&&!!window.document,l=(o?window:Object).Recorder,c=l.i18n;t=l,n=c.$T,r=o,a=function(e){return new i(e)},s="WaveView",(i=function(e){var t=this,a={scale:2,speed:9,phase:21.8,fps:20,keep:!0,lineWidth:3,linear1:[0,"rgba(150,96,238,1)",.2,"rgba(170,79,249,1)",1,"rgba(53,199,253,1)"],linear2:[0,"rgba(209,130,255,0.6)",1,"rgba(53,199,255,0.6)"],linearBg:[0,"rgba(255,255,255,0.2)",1,"rgba(54,197,252,0.2)"]};for(var i in e)a[i]=e[i];t.set=e=a;var o="compatibleCanvas";if(e[o])var l=t.canvas=e[o];else{if(!r)throw new Error(n.G("NonBrowser-1",[s]));var c=e.elem;c&&("string"==typeof c?c=document.querySelector(c):c.length&&(c=c[0])),c&&(e.width=c.offsetWidth,e.height=c.offsetHeight);var u=t.elem=document.createElement("div");u.style.fontSize=0,u.innerHTML='<canvas style="width:100%;height:100%;"/>',l=t.canvas=u.querySelector("canvas"),c&&(c.innerHTML="",c.appendChild(u))}var p=e.scale,d=e.width*p,f=e.height*p;if(!d||!f)throw new Error(n.G("IllegalArgs-1",[s+" width=0 height=0"]));l.width=d,l.height=f;var h=t.ctx=l.getContext("2d");t.linear1=t.genLinear(h,d,e.linear1),t.linear2=t.genLinear(h,d,e.linear2),t.linearBg=t.genLinear(h,f,e.linearBg,!0),t._phase=0}).prototype=a.prototype={genLinear:function(e,t,n,r){for(var a=e.createLinearGradient(0,0,r?0:t,r?t:0),s=0;s<n.length;)a.addColorStop(n[s++],n[s++]);return a},genPath:function(e,t,n){for(var r=[],a=this.set,s=a.scale,i=a.width*s,o=a.height*s/2,l=0;l<=i;l+=s){var c=(1+Math.cos(Math.PI+l/i*2*Math.PI))/2*o*t*Math.sin(2*Math.PI*(l/i)*e+n)+o;r.push(c)}return r},input:function(e,t,n){var r=this;r.sampleRate=n,r.pcmData=e,r.pcmPos=0,r.inputTime=Date.now(),r.schedule()},schedule:function(){var e=this,n=e.set,r=Math.floor(1e3/n.fps);e.timer||(e.timer=setInterval((function(){e.schedule()}),r));var a=Date.now();if(!(a-(e.drawTime||0)<r)){e.drawTime=a;for(var s=e.sampleRate/n.fps,i=e.pcmData,o=e.pcmPos,l=Math.max(0,Math.min(s,i.length-o)),c=0,u=0;u<l;u++,o++)c+=Math.abs(i[o]);e.pcmPos=o,!l&&n.keep||e.draw(t.PowerLevel(c,l)),!l&&a-e.inputTime>1300&&(clearInterval(e.timer),e.timer=0)}},draw:function(e){var t=this,n=t.set,r=t.ctx,a=n.scale,s=n.width*a,i=n.height*a,o=n.speed/n.fps,l=t._phase-=o,c=l+o*n.phase,u=e/100,p=t.genPath(2,u,l),d=t.genPath(1.8,u,c);r.clearRect(0,0,s,i),r.beginPath();for(var f=0,h=0;h<=s;f++,h+=a)0==h?r.moveTo(h,p[f]):r.lineTo(h,p[f]);for(f--,h=s-1;h>=0;f--,h-=a)r.lineTo(h,d[f]);r.closePath(),r.fillStyle=t.linearBg,r.fill(),t.drawPath(d,t.linear2),t.drawPath(p,t.linear1)},drawPath:function(e,t){var n=this,r=n.set,a=n.ctx,s=r.scale,i=r.width*s;a.beginPath();for(var o=0,l=0;l<=i;o++,l+=s)0==l?a.moveTo(l,e[o]):a.lineTo(l,e[o]);a.lineWidth=r.lineWidth*s,a.strokeStyle=t,a.stroke()}},t[s]=a}();const F=n({data:()=>({permitted:!1,recordtext:"not permitted"}),mounted(){this.isMounted=!0,b.UniPageOnShow(this),b.UniRenderjsRegister(this)},onShow(){this.isMounted&&b.UniPageOnShow(this)},props:{StopHandler:{type:Function,default:()=>{a("log","at pages/recTest/my_test.vue:44","StopHandler")}}},methods:{recReq(){b.UniWebViewActivate(this),b.RequestPermission((()=>{a("log","at pages/recTest/my_test.vue:54","已获得录音权限，可以开始录音了"),this.permitted=!0,this.recordtext="permitted"}),((e,t)=>{a("error","at pages/recTest/my_test.vue:61","请求录音权限失败："+e)}))},recStart(){var e={type:"mp3",sampleRate:16e3,bitRate:16,onProcess:(e,t,n,r,a,s)=>{},onProcess_renderjs:"function(buffers,powerLevel,duration,sampleRate,newBufferIdx,asyncEnd){\n\t                //App中在这里修改buffers才会改变生成的音频文件\n\t                //App中是在renderjs中进行的可视化图形绘制，因此需要写在这里，this是renderjs模块的this（也可以用This变量）；如果代码比较复杂，请直接在renderjs的methods里面放个方法xxxFunc，这里直接使用this.xxxFunc(args)进行调用\n\t                if(this.waveView) this.waveView.input(buffers[buffers.length-1],powerLevel,sampleRate);\n\t            }",takeoffEncodeChunk:null,takeoffEncodeChunk_renderjs:null,start_renderjs:"function(){\n\t                //App中可以放一个函数，在Start成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t                //放一些仅在renderjs中才生效的事情，比如初始化，不提供也行\n\t            }",stop_renderjs:"function(arrayBuffer,duration,mime){\n\t                //App中可以放一个函数，在Stop成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t                //放一些仅在renderjs中才生效的事情，不提供也行\n\t            }"};b.UniWebViewActivate(this),b.Start(e,(()=>{a("log","at pages/recTest/my_test.vue:105","已开始录音"),this.recordtext="开始录音"}),(e=>{a("error","at pages/recTest/my_test.vue:117","开始录音失败："+e),this.recordtext="开始录音失败"+e}))},recStop(){b.Stop(((e,t,n)=>{"undefined"!=typeof Blob&&"object"==typeof window&&new Blob([e],{type:n}),this.recordtext="录音成功",uni.uploadFile({url:"http://127.0.0.1:8000/speechtotext",file:new File([e],"recorder.mp3"),name:"mp3",formData:{},success:e=>{a("log","at pages/recTest/my_test.vue:142","上传成功："+e.data),this.StopHandler()},fail:e=>(a("error","at pages/recTest/my_test.vue:145","上传录音失败："+e),{status:"error"})})}),(e=>(this.recordtext="录音失败"+e,a("error","at pages/recTest/my_test.vue:153","结束录音失败："+e),{status:"failure"})))}}},[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("button",{onClick:n[0]||(n[0]=(...e)=>i.recReq&&i.recReq(...e))}," 请求录音 "),e.createElementVNode("button",{onClick:n[1]||(n[1]=(...e)=>i.recStart&&i.recStart(...e))}," 开始录音 "),e.createElementVNode("button",{onClick:n[2]||(n[2]=(...e)=>i.recStop&&i.recStop(...e))}," 结束录音 "),e.createElementVNode("text",null,e.toDisplayString(s.recordtext),1)])}]]),q=e=>{(e.$renderjs||(e.$renderjs=[])).push("yourModuleName"),(e.$renderjsModules||(e.$renderjsModules={})).yourModuleName="425f6c57"},$={data:()=>({}),mounted(){this.isMounted=!0,b.UniPageOnShow(this)},onShow(){this.isMounted&&b.UniPageOnShow(this)},methods:{recReq(){b.UniWebViewActivate(this),b.RequestPermission((()=>{a("log","at pages/test_api/test_api.vue:60","已获得录音权限，可以开始录音了")}),((e,t)=>{a("error","at pages/test_api/test_api.vue:65","请求录音权限失败："+e)}))},recStart(){b.UniWebViewActivate(this),b.RequestPermission((()=>{a("log","at pages/test_api/test_api.vue:74","已获得录音权限，可以开始录音了")}),((e,t)=>{a("error","at pages/test_api/test_api.vue:79","请求录音权限失败："+e)}));var e={type:"mp3",sampleRate:16e3,bitRate:16,onProcess:(e,t,n,r,a,s)=>{},onProcess_renderjs:"function(buffers,powerLevel,duration,sampleRate,newBufferIdx,asyncEnd){\n\t                //App中在这里修改buffers才会改变生成的音频文件\n\t                //App中是在renderjs中进行的可视化图形绘制，因此需要写在这里，this是renderjs模块的this（也可以用This变量）；如果代码比较复杂，请直接在renderjs的methods里面放个方法xxxFunc，这里直接使用this.xxxFunc(args)进行调用\n\t                if(this.waveView) this.waveView.input(buffers[buffers.length-1],powerLevel,sampleRate);\n\t            }",takeoffEncodeChunk:null,takeoffEncodeChunk_renderjs:null,start_renderjs:"function(){\n\t                //App中可以放一个函数，在Start成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t                //放一些仅在renderjs中才生效的事情，比如初始化，不提供也行\n\t            }",stop_renderjs:"function(arrayBuffer,duration,mime){\n\t                //App中可以放一个函数，在Stop成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t                //放一些仅在renderjs中才生效的事情，不提供也行\n\t            }"};b.UniWebViewActivate(this),b.Start(e,(()=>{a("log","at pages/test_api/test_api.vue:120","已开始录音"),b.UniFindCanvas(this,[".recwave-WaveView"],"\n\t                this.waveView=Recorder.WaveView({compatibleCanvas:canvas1, width:300, height:100});\n\t            ",(e=>{this.waveView=v.WaveView({compatibleCanvas:e,width:300,height:100})}))}),(e=>{a("error","at pages/test_api/test_api.vue:131","开始录音失败："+e)}))},recPause(){b.GetCurrentRecOrNull()&&(b.Pause(),a("log","at pages/test_api/test_api.vue:139","已暂停"))},recResume(){b.GetCurrentRecOrNull()&&(b.Resume(),a("log","at pages/test_api/test_api.vue:146","继续录音中..."))},recStop(){b.Stop(((e,t,n)=>{"undefined"!=typeof Blob&&"object"==typeof window&&new Blob([e],{type:n}),uni.uploadFile({url:"http://127.0.0.1:8000/speechtotext",file:new File([e],"recorder.mp3"),name:"mp3",formData:{},success:e=>{a("log","at pages/test_api/test_api.vue:168","上传成功："+e.data)},fail:e=>{a("error","at pages/test_api/test_api.vue:169","上传录音失败："+e)}})}),(e=>{a("error","at pages/test_api/test_api.vue:172","结束录音失败："+e)}))}}};q($);const X=n($,[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("button",{onClick:n[0]||(n[0]=(...e)=>i.recReq&&i.recReq(...e))},"请求录音"),e.createElementVNode("button",{onMousedown:n[1]||(n[1]=(...e)=>i.recStart&&i.recStart(...e)),onMouseup:n[2]||(n[2]=(...e)=>i.recStop&&i.recStop(...e))},"按住录音",32),e.createElementVNode("button",{onClick:n[3]||(n[3]=(...e)=>t.recognize&&t.recognize(...e))},"语音识别")])}]]);const K=n({data:()=>({permitted:!1}),mounted(){this.isMounted=!0,b.UniPageOnShow(this),b.UniRenderjsRegister(this)},onShow(){this.isMounted&&b.UniPageOnShow(this)},props:{StopHandler:{type:Function,default:()=>{a("log","at components/micphone/micphone.vue:75","StopHandler")}}},methods:{recStart(){b.UniWebViewActivate(this),b.RequestPermission((()=>{a("log","at components/micphone/micphone.vue:86","已获得录音权限，可以开始录音了"),this.permitted=!0}),((e,t)=>{a("error","at components/micphone/micphone.vue:92","请求录音权限失败："+e)}));var e={type:"mp3",sampleRate:16e3,bitRate:16,onProcess:(e,t,n,r,a,s)=>{},onProcess_renderjs:"function(buffers,powerLevel,duration,sampleRate,newBufferIdx,asyncEnd){\n\t                //App中在这里修改buffers才会改变生成的音频文件\n\t                //App中是在renderjs中进行的可视化图形绘制，因此需要写在这里，this是renderjs模块的this（也可以用This变量）；如果代码比较复杂，请直接在renderjs的methods里面放个方法xxxFunc，这里直接使用this.xxxFunc(args)进行调用\n\t                if(this.waveView) this.waveView.input(buffers[buffers.length-1],powerLevel,sampleRate);\n\t            }",takeoffEncodeChunk:null,takeoffEncodeChunk_renderjs:null,start_renderjs:"function(){\n\t                //App中可以放一个函数，在Start成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t                //放一些仅在renderjs中才生效的事情，比如初始化，不提供也行\n\t            }",stop_renderjs:"function(arrayBuffer,duration,mime){\n\t                //App中可以放一个函数，在Stop成功时renderjs中会先调用这里的代码，this是renderjs模块的this（也可以用This变量）\n\t                //放一些仅在renderjs中才生效的事情，不提供也行\n\t            }"};b.UniWebViewActivate(this),b.Start(e,(()=>{a("log","at components/micphone/micphone.vue:134","已开始录音"),b.UniFindCanvas(this,[".recwave-WaveView"],"\n\t                this.waveView=Recorder.WaveView({compatibleCanvas:canvas1, width:300, height:100});\n\t            ",(e=>{this.waveView=Recorder.WaveView({compatibleCanvas:e,width:300,height:100})}))}),(e=>{a("error","at components/micphone/micphone.vue:145","开始录音失败："+e)}))},recStop(){b.Stop(((e,t,n)=>{"undefined"!=typeof Blob&&"object"==typeof window&&new Blob([e],{type:n}),uni.uploadFile({url:"http://127.0.0.1:8000/speechtotext",file:new File([e],"recorder.mp3"),name:"mp3",formData:{},success:e=>{a("log","at components/micphone/micphone.vue:168","上传成功："+e.data),this.StopHandler()},fail:e=>(a("error","at components/micphone/micphone.vue:171","上传录音失败："+e),{status:"error"})})}),(e=>(a("error","at components/micphone/micphone.vue:178","结束录音失败："+e),{status:"failure"})))}}},[["render",function(t,n,r,a,s,i){return e.openBlock(),e.createElementBlock("view",null,[e.createElementVNode("img",{src:"https://img-insight.oss-cn-chengdu.aliyuncs.com/micphone/mic1.png",onTouchstart:n[0]||(n[0]=(...e)=>i.recStart&&i.recStart(...e)),onTouchend:n[1]||(n[1]=(...e)=>i.recStop&&i.recStop(...e)),class:"micphone"},null,32)])}],["__scopeId","data-v-9988e39f"]]);const J=n({data:()=>({keyboardHeight:0,bottomHeight:0,scrollTop:0,userId:"",chatMsg:"",msgList:[{botContent:"按住屏幕下方按钮讲话",recordId:0,titleId:0,userContent:"",userId:0},{botContent:"",recordId:0,titleId:0,userContent:"我的前面有什么？",userId:0},{userContent:"",recordId:0,titleId:0,botContent:"您的正前方有一个指示牌，请注意安全",userId:0}]}),updated(){this.scrollToBottom()},computed:{windowHeight(){return this.rpxTopx(uni.getSystemInfoSync().windowHeight)},inputHeight(){return this.bottomHeight+this.keyboardHeight}},onLoad(){},onUnload(){uni.offKeyboardHeightChange()},methods:{focus(){this.scrollToBottom()},blur(){this.scrollToBottom()},rpxTopx(e){let t=750/wx.getSystemInfoSync().windowWidth*Number(e);return Math.floor(t)},sendHeight(){setTimeout((()=>{let e=uni.createSelectorQuery();e.select(".send-msg").boundingClientRect(),e.exec((e=>{this.bottomHeight=this.rpxTopx(e[0].height)}))}),10)},scrollToBottom(e){setTimeout((()=>{let e=uni.createSelectorQuery().in(this);e.select("#scrollview").boundingClientRect(),e.select("#msglistview").boundingClientRect(),e.exec((e=>{e[1].height>e[0].height&&(this.scrollTop=this.rpxTopx(e[1].height-e[0].height))}))}),15)},handleSend(){a("log","at pages/smart-travel/smart-travel.vue:155","Here")}}},[["render",function(t,n,r,a,i,o){const l=s(e.resolveDynamicComponent("micphone"),K);return e.openBlock(),e.createElementBlock("view",{class:"chat"},[e.createElementVNode("scroll-view",{style:e.normalizeStyle({height:o.windowHeight-o.inputHeight+"rpx"}),id:"scrollview","scroll-y":"true","scroll-top":i.scrollTop,class:"scroll-view"},[e.createElementVNode("view",{id:"msglistview",class:"chat-body"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.msgList,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n},[""!=t.userContent?(e.openBlock(),e.createElementBlock("view",{key:0,class:"item self"},[e.createElementVNode("view",{class:"content right"},e.toDisplayString(t.userContent),1)])):e.createCommentVNode("",!0),""!=t.botContent?(e.openBlock(),e.createElementBlock("view",{key:1,class:"item Ai"},[e.createElementVNode("view",{class:"content left"},e.toDisplayString(t.botContent),1)])):e.createCommentVNode("",!0)])))),128))])],12,["scroll-top"]),e.createElementVNode("view",{class:"chat-bottom"},[e.createVNode(l,{StopHandler:o.handleSend},null,8,["StopHandler"])])])}],["__scopeId","data-v-a5e68cba"]]);__definePage("pages/index/index",o),__definePage("pages/test/test",l),__definePage("pages/recTest/page_index",M),__definePage("pages/recTest/page_index2",B),__definePage("pages/recTest/main_recTest",S),__definePage("pages/recTest/page_asr",I),__definePage("pages/recTest/page_i18n",D),__definePage("pages/recTest/page_renderjsOnly",z),__definePage("pages/recTest/my_test",F),__definePage("pages/test_api/test_api",X),__definePage("pages/smart-travel/smart-travel",J);const Y={onLaunch:function(){a("log","at App.vue:4","App Launch")},onShow:function(){a("log","at App.vue:7","App Show")},onHide:function(){a("log","at App.vue:10","App Hide")}};const{app:G,Vuex:Q,Pinia:Z}={app:e.createVueApp(Y)};uni.Vuex=Q,uni.Pinia=Z,G.provide("__globalStyles",__uniConfig.styles),G._component.mpType="app",G._component.render=()=>{},G.mount("#app")}(Vue,uni.VueShared);
